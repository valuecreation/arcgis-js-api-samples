{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/layers/FeatureLayerView3D.js","../node_modules/@arcgis/core/views/layers/support/popupUtils.js","../node_modules/@arcgis/core/views/3d/layers/support/projectExtentUtils.js","../node_modules/@arcgis/core/views/3d/layers/support/featureReference.js","../node_modules/@arcgis/core/views/3d/layers/support/FeatureTile.js","../node_modules/@arcgis/core/views/3d/layers/support/FeatureTileFetcher3D.js","../node_modules/@arcgis/core/views/3d/layers/support/FeatureTileFetcher3DDebugger.js","../node_modules/@arcgis/core/layers/graphics/controllers/FeatureTileController3D.js","../node_modules/@arcgis/core/views/3d/layers/FeatureLikeLayerView3D.js","../node_modules/@arcgis/core/views/3d/support/EventedSet.js","../node_modules/@arcgis/core/views/3d/support/PBFDecoder.js","../node_modules/@arcgis/core/views/3d/layers/support/featureTileQuery3D.js","../node_modules/@arcgis/core/views/3d/layers/support/FeatureTileFetcher3DLayerViewContext.js","../node_modules/@arcgis/core/views/layers/support/FeatureEffect.js","../node_modules/@arcgis/core/views/layers/FeatureLayerView.js","../node_modules/@arcgis/core/views/3d/layers/FeatureLayerViewBase3D.js"],"names":["p","a","constructor","super","arguments","this","type","direct3DObjectFeatureLayerDisplayEnabled","i","initialize","layer","infoFor3D","addResolvingPromise","Promise","reject","r","geometryType","s","spatialReference","view","e","t","constructOnly","prototype","o","c","async","d","popupTemplate","getRequiredFields","fieldsIndex","lastEditInfoEnabled","n","objectIdField","typeIdField","globalIdField","relationships","u","includes","f","l","push","has","indexOf","forEach","keyField","defaultPopupTemplateEnabled","defaultPopupTemplate","fullExtent","equals","resolve","clone","state","isLocal","portalItem","then","destroyed","catch","highestResolutionVersion","versions","ref","length","refCount","feature","oldVersion","Object","defineProperty","value","uid","configurable","resolution","newVersion","unref","recalculateHighestResolutionVersion","_feature","isReferenced","Set","g","descriptor","fetchStatus","_features","_numVertices","_featureLimit","featuresMissing","_shuffled","_numFeatures","_emptyFeatureRatio","_estimatedSize","_estimatedUnusedSize","_estimatedUnusedSizeDirty","_availableFields","_displayingFeatures","alive","filtered","extentIncludingBorrowedFeatures","features","featureLimit","setFeatures","reduce","geometry","hasPreciseFeatureCount","id","updateMemoryEstimates","m","resetFetching","S","displayingFeatures","intersects","extent","intersectionIncludingBorrowed","h","_shuffle","sort","reduceFeatures","Math","ceil","numFeatures","max","availableFields","emptyFeatureRatio","requestController","P","getLogger","q","_useTileCount","updating","updatingTotal","updatingRemaining","expectedFeatureDiff","maximumNumberOfFeaturesExceeded","maximumNumberOfFeaturesExceededThrottle","_fullRatio","_farRatio","changes","updates","adds","Array","removes","handles","_frameTask","D","_dirty","featureTiles","Map","displayingFeatureReferences","numDisplayingFeatureReferences","suspended","pendingEdits","_get","_set","maximumFeaturesUpdated","memoryFactor","setDirty","lodFactor","supportsResolution","refetch","context","query","queryFeatureCount","notifyChange","estimatedUnusedSize","numVertices","tilingScheme","error","reclip","add","FeatureReferenceClass","capabilities","supportsMultipleResolutions","b","M","scheduler","registerTask","O","FEATURE_TILE_FETCHER","destroy","remove","cancelFetchTile","removeTile","clear","controller","abort","restart","clearTile","resetFetchTile","memoryCache","suspend","pause","resume","unpause","paused","updated","delete","applyEdits","edits","count","result","applyEditsDeleteFeatures","deletedFeatures","applyEditsAddUpdateFeatures","addedFeatures","updatedFeatures","signal","objectId","globalId","errorOncePerTick","find","attributes","R","filter","invalidateCounts","applyEditsAddUpdateTile","createQuery","resultType","cacheHint","objectIds","queryFeatures","size","slice","k","fields","queryFeaturesDehydrated","timeout","H","runTask","processQueue","constructed","getListOfTiles","markTilesNotAlive","run","addTiles","filterExtentTiles","removeTiles","done","sortTiles","displayTiles","fetchTiles","updateMaximumNumberOfFeaturesExceeded","tileDescriptors","get","addTile","madeProgress","hasProgressed","filterExtent","pop","loadPriority","updateRatio","showTile","needsFetching","cache","scheduleUpdated","needsNumFeatures","fetchTileCount","_handleRequest","fetchTile","logFetchError","some","V","z","refreshDisplayingFeatures","applyChanges","isFetching","maximumFeaturesForTile","min","maximumNumberOfFeatures","debugger","update","perTileMaximumNumberOfFeaturesExceeded","lij","w","set","referenceDisplayingFeaturesFromRelatedTiles","j","F","y","fetchCount","N","getMaxRecordCount","I","supportsMaxRecordCountFactor","v","MAX_MAX_RECORD_COUNT_FACTOR","fetchPagedTile","maxRecordCountFactor","isRefetching","exceededTransferLimit","schedule","_removeEmptyFeatures","Q","createFeatureCountQuery","setPagingParameters","num","concat","supportsCacheHint","T","setResolutionParams","useTileQuery","supportsPagination","start","getEffectiveTileResolution","viewingMode","resolutionAtLevel","supportsQuantization","quantizationParameters","E","mode","originPosition","tolerance","maxAllowableOffset","C","useTileCount","needsFeatureCount","tileMaxRecordCount","maxRecordCount","supportsResultType","L","needsRefetching","needsDisplayUpdate","hideTileFeatures","hideTile","console","removeMany","addMany","B","estimatedSize","put","from","values","process","getFeatureTileById","forEachFeatureTile","U","A","supportsQuantizationEditMode","supportsFormatPBF","map","name","readOnly","x","loadingGraphics","loadedGraphics","pendingGraphics","_enabled","tileFetcher","loadedSymbols","material","color","outline","loadingSymbols","pendingSymbols","dataExtentSymbol","enabled","synchronizeMaps","symbols","showDataExtent","graphics","dataExtentGraphic","fromExtent","symbol","test","ensureMaxLod","getExtentGeometry","center","verticalOffset","screenLength","callout","border","symbolLayers","text","halo","_","watchUpdatingTracking","serviceDataExtent","serviceDataCount","NO_SERVICE_DATA_COUNT","vertexLimitExceeded","displayFeatureLimit","fetchDataInfoPromise","fetchDataInfoAbortController","lifeCycleAbortController","layerView","memoryForUnusedFeatures","_clearOverride","_override","_isOverridden","minScale","approximateExtentSizeAtScale","width","height","MAX_SNAPSHOT_MIN_SCALE_FACTOR","totalVertices","pixelSize","levels","tileSize","scale","tiles","addPromise","updateVertexLimitExceeded","modeChanged","verifyCapabilities","fetchServiceDataInfo","initializeTileFetcher","cancelFetchServiceDataInfo","tilesHandle","resourceController","memoryController","events","on","dataFilterChanged","availableFieldsChanged","requiredFieldsChanged","watch","toTileInfo","supportsExceedsLimitQuery","addClient","warn","updateServiceDataExtent","createVertexLimitExceededQuery","outStatistics","statisticType","maxVertexCount","outStatisticFieldName","maxPointCount","createDataInfoQuery","outSpatialReference","fullExtentIsAccurate","definitionExpression","url","tryUpdateServiceDataExtent","fullExtentInLocalViewSpatialReference","supportsExtent","MAX_FEATURE_COUNT_FOR_EXTENT","queryExtent","QUERY_EXTENT_TIMEOUT","QUERY_STATISTICS_TIMEOUT","ok","averageSymbolComplexity","maximumTotalNumberOfPrimitives","primitivesPerCoordinate","primitivesPerFeature","operations","supportsExceedsLimitStatistics","vertexLimitInfo","minimumNumberOfVerticesForGeometry","maxTotalSnapshotVertices","exceedslimit","updateServiceDataCount","storedFeatures","totalFeatures","Number","dependsOn","reset","updatePolicy","suspendResumeExtentMode","slicePlaneEnabled","drapeSourceType","suspendResumeExtent","_controllerCreated","clippingExtent","supportsHeightUnitConversion","pendingController","queryEngine","isTable","owner","frustumVisibilityEnabled","scaleVisibilityEnabled","filterVisibilityEnabled","timeExtentVisibilityEnabled","elevationAlignmentEnabled","elevationFeatureExpressionEnabled","preferredUpdatePolicy","updateClippingExtent","updatingHandles","graphics3d","graphicsCore","setup","validateGeometryType","priority","FEATURE_QUERY_ENGINE","initializeController","destroyPendingController","canResume","frustumVisibility","notifyGraphicGeometryChanged","notifyGraphicVisibilityChanged","getRenderingInfo","renderer","arcade","getGraphicFromGraphicUid","graphics3DGraphics","graphics3DGraphicsByObjectID","symbolUpdateType","whenGraphicBounds","computeAttachmentOrigin","getSymbolLayerSize","executeQuery","_ensureQuery","queryObjectIds","executeQueryForIds","executeQueryForCount","executeQueryForExtent","highlight","maskOccludee","getSuspendInfo","suspendInfo","isUpdating","basemapTerrain","ready","createController","when","setControllerWhenInitialized","isResolved","beforeSetController","_getResourceInfo","displayedNumberOfFeatures","totalNumberOfFeatures","nodes","core","performanceInfo","elevationUpdating","elevationAlignment","visibilityFrustum","visibilityScale","scaleVisibility","Boolean","toArray","emit","added","removed","_schedule","_handle","invoke","buffer","byteLength","options","sourceSpatialReference","toJSON","fromJSON","generateUID","getTransferList","_decoder","applyTransform","maxStringAttributeLength","parsedUrl","_createRequestOptions","data","customParameters","token","apiKey","source","queryFeaturesJSON","_memoryCache","_capabilities","returnZ","returnM","memoryCacheEnabled","getMemCache","outFields","message","includedEffect","excludedEffect","excludedLabelsVisible","json","write","_updatingRequiredFieldsPromise","effect","timeExtent","requiredFields","_handleRequiredFieldsChange","Error","returnGeometry","intersection","_loadArcadeModules","_updateRequiredFields","featureReduction","collectRequiredFields","timeInfo","startField","endField","floorInfo","floorField","subtypeField","sublayers","all","displayField","validateFetchPopupFeatures","clientGraphics","popupEnabled","createPopupQuery","arcadeUtils","hasGeometryOperations","isEmpty","_controllerTotal","_graphicsCoreTotal","filterVisibility","filterChanged","fetcherContext","supportsZ","supportsM","fetchClientPopupFeatures","setVisibility","setObjectIdVisibility","_queryFeaturesMesh","hasZ","hasM","dataExtent","updateDisplayFeatureLimit","getUsedMemory","usedMemory","getUnloadedMemory","unprocessedMemoryEstimate","usedMemoryPerGraphic","ignoresMemoryFactor","hasMaximumNumberOfFeaturesOverride","maximumTotalNumberOfFeatures","minimumTotalNumberOfFeatures","_validateQueryFeaturesMesh","graphic","returnCentroid","partial","symbolComplexity","debug","point","polygon","polyline"],"mappings":"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","file":"static/js/53.c29f58ed.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import r from\"../../../core/Error.js\";import{property as t}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import{canProjectWithoutEngine as s}from\"../../../geometry/projection.js\";import{enableDirect3DObjectFeatureLayerDisplay as i}from\"../../../support/featureFlags.js\";import a from\"./FeatureLayerViewBase3D.js\";let p=class extends a{constructor(){super(...arguments),this.type=\"feature-3d\",this.direct3DObjectFeatureLayerDisplayEnabled=i()}initialize(){this.layer.infoFor3D&&!this.direct3DObjectFeatureLayerDisplayEnabled&&this.addResolvingPromise(Promise.reject(new r(\"featurelayerview3d:unsupported-geometry-type\",`Unsupported geometry type ${this.layer.geometryType}`))),\"mesh\"!==this.layer.geometryType||s(this.layer.spatialReference,this.view.spatialReference)||this.addResolvingPromise(Promise.reject(new r(\"layerview:spatial-reference-incompatible\",\"The spatial references of the feature layer layer is incompatible with the spatial reference of the view\")))}};e([t({constructOnly:!0})],p.prototype,\"direct3DObjectFeatureLayerDisplayEnabled\",void 0),e([t()],p.prototype,\"layer\",void 0),p=e([o(\"esri.views.3d.layers.FeatureLayerView3D\")],p);var c=p;export default c;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as l}from\"../../../layers/support/fieldUtils.js\";async function t(t,d=t.popupTemplate){if(!e(d))return[];const i=await d.getRequiredFields(t.fieldsIndex),{lastEditInfoEnabled:n}=d,{objectIdField:s,typeIdField:a,globalIdField:o,relationships:u}=t;if(i.includes(\"*\"))return[\"*\"];const f=n?await p(t):[],r=l(t.fieldsIndex,[...i,...f]);return a&&r.push(a),r&&s&&t.fieldsIndex.has(s)&&-1===r.indexOf(s)&&r.push(s),r&&o&&t.fieldsIndex.has(o)&&-1===r.indexOf(o)&&r.push(o),u&&u.forEach((e=>{const{keyField:p}=e;r&&p&&t.fieldsIndex.has(p)&&-1===r.indexOf(p)&&r.push(p)})),r}function d(p,l){return p.popupTemplate?p.popupTemplate:e(l)&&l.defaultPopupTemplateEnabled&&e(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}export{d as getFetchPopupTemplate,t as getRequiredFields};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{canProject as e,project as r}from\"../../../../geometry/support/webMercatorUtils.js\";import{projectGeometry as o}from\"../../../../portal/support/geometryServiceUtils.js\";function t(t){const l=t.view.spatialReference,s=t.layer.fullExtent,i=s&&s.spatialReference;return i?i.equals(l)?Promise.resolve(s.clone()):e(i,l)?Promise.resolve(r(s,l)):t.view.state.isLocal?o(s,l,t.layer.portalItem).then((e=>!t.destroyed&&e?e:void 0)).catch((()=>null)):Promise.resolve(null):Promise.resolve(null)}export{t as toViewIfLocal};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport\"../../../../layers/graphics/dehydratedFeatures.js\";import{equals as e}from\"../../../../layers/graphics/dehydratedFeatureComparison.js\";class s{constructor(e,s){this.highestResolutionVersion=null,this.versions=[],this.ref(e,s)}get isReferenced(){return 0!==this.versions.length}get isSingle(){return 1===this.versions.length&&1===this.versions[0].refCount}ref(s,t){const r=this.feature;i.oldVersion=r,this.feature&&Object.defineProperty(s,\"uid\",{value:this.feature.uid,configurable:!0});for(const o of this.versions)if(o.resolution===t){o.refCount++;const t=this.highestResolutionVersion===o&&!e(s,o.feature);return(t||this.highestResolutionVersion!==o)&&(o.feature=s),i.newVersion=t?s:r,i}const n={feature:s,resolution:t,refCount:1};return this.versions.push(n),!this.highestResolutionVersion||t<this.highestResolutionVersion.resolution?(i.newVersion=s,this.highestResolutionVersion=n):i.newVersion=r,i}unref(e){for(let s=0;s<this.versions.length;s++){const t=this.versions[s];if(t.resolution===e)return t.refCount--,i.oldVersion=this.feature,0===t.refCount&&(this.versions[s]=this.versions[this.versions.length-1],this.versions.length--,this.highestResolutionVersion===t&&(this.recalculateHighestResolutionVersion(),i.oldVersion=t.feature)),i.newVersion=this.feature,i}return null}get feature(){return this.highestResolutionVersion?this.highestResolutionVersion.feature:null}recalculateHighestResolutionVersion(){if(0===this.versions.length)return void(this.highestResolutionVersion=null);let e=this.versions[0];for(let s=1;s<this.versions.length;s++){const t=this.versions[s];t.resolution<e.resolution&&(e=t)}this.highestResolutionVersion=e}}class t{constructor(e){this._feature=e,this.refCount=1}get isReferenced(){return 0!==this.refCount}get isSingle(){return 1===this.refCount}ref(s){return++this.refCount,i.oldVersion=this._feature,this.feature&&Object.defineProperty(s,\"uid\",{value:this.feature.uid,configurable:!0}),e(this._feature,s)||(this._feature=s),i.newVersion=this._feature,i}unref(){return i.oldVersion=this._feature,this.refCount>0&&(this.refCount--,!this.isReferenced)?(i.newVersion=null,i):(i.newVersion=this._feature,i)}get feature(){return this._feature}}const i={oldVersion:null,newVersion:null};export{s as MultiFeatureReference,t as SingleFeatureReference};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{shuffle as t}from\"../../../../core/arrayUtils.js\";import{unwrapOr as e,isSome as s,isNone as i}from\"../../../../core/maybe.js\";import{fromExtent as r,intersects as u,set as a,POSITIVE_INFINITY as h,intersection as n,create as f}from\"../../../../geometry/support/aaBoundingRect.js\";import{numVertices as d,estimateSize as m,getObjectId as l}from\"../../../../layers/graphics/dehydratedFeatures.js\";const _=16438,c=new Set;class g{constructor(t){this.descriptor=t,this.fetchStatus=0,this._features=null,this._numVertices=0,this._featureLimit=0,this.featuresMissing=!0,this._shuffled=!1,this._numFeatures=o,this._emptyFeatureRatio=0,this._estimatedSize=-1,this._estimatedUnusedSize=0,this._estimatedUnusedSizeDirty=!1,this._availableFields=c,this._displayingFeatures=null,this.alive=!0,this.filtered=!1}get displayingFeatures(){return this._displayingFeatures}set displayingFeatures(t){this._displayingFeatures=t,this.extentIncludingBorrowedFeatures=null}get perTileMaximumNumberOfFeaturesExceeded(){return!this.filtered&&(this.featuresMissing||this.features&&this.featureLimit!==this.features.length)}get features(){return this._features}get featureLimit(){return this._featureLimit}set featureLimit(t){this._featureLimit!==t&&(this._featureLimit=t,this._estimatedUnusedSizeDirty=!0)}get availableFields(){return this._availableFields}setFeatures(t,s,i){this._availableFields=e(i,c),this._features=t,this._shuffled=!1,this._estimatedSize=-1,this._estimatedUnusedSizeDirty=!0,t&&t.length>0?(this._emptyFeatureRatio=s/(t.length+s),this._numVertices=t.reduce(((t,e)=>t+d(e.geometry)),0)):(this._emptyFeatureRatio=0,this._numVertices=0)}get emptyFeatureRatio(){return this._emptyFeatureRatio}get numFeatures(){return this.hasPreciseFeatureCount?this._numFeatures:this._features?this._features.length:0}set numFeatures(t){this._numFeatures=t}get hasPreciseFeatureCount(){return this._numFeatures>o}get needsFeatureCount(){return this._numFeatures===o}get numVertices(){return this._numVertices}get id(){return this.descriptor.id}get estimatedSize(){return this.updateMemoryEstimates(),this._estimatedSize}get estimatedUnusedSize(){return this._estimatedUnusedSize}updateMemoryEstimates(){if(this._estimatedSize<0){if(this._estimatedSize=0,this._estimatedUnusedSize=0,this._features)for(let t=0;t<this._features.length;++t){const e=m(this._features[t]);this._estimatedSize+=e,t>=this.featureLimit&&(this._estimatedUnusedSize+=e)}return!0}if(this._estimatedUnusedSizeDirty){if(this._estimatedUnusedSize=0,this._estimatedUnusedSizeDirty=!1,this._features)for(let t=this.featureLimit;t<this._features.length;++t)this._estimatedUnusedSize+=m(this._features[t]);return!0}return!1}get isFetching(){return 2===this.fetchStatus||3===this.fetchStatus}get isRefetching(){return 3===this.fetchStatus}get needsFetching(){return 0===this.fetchStatus||1===this.fetchStatus}get needsRefetching(){return 1===this.fetchStatus}get isFetched(){return 4===this.fetchStatus||5===this.fetchStatus}resetFetching(){this.fetchStatus=3===this.fetchStatus?1:0}get needsDisplayUpdate(){return!!this._features&&!S(this._features,this.displayingFeatures,this.featureLimit)}intersects(t){return!t||!this.descriptor.extent||(r(t,p),u(this.descriptor.extent,p))}intersectionIncludingBorrowed(t,e){const i=s(this.extentIncludingBorrowedFeatures)?this.extentIncludingBorrowedFeatures:this.descriptor.extent;return t||i?(t?(r(t,e),n(e,i,e)):a(e,i),e):(a(e,h),e)}_shuffle(e){this._features.sort(((t,s)=>l(t,e)-l(s,e))),t(this._features,_),this._shuffled=!0,this._estimatedUnusedSizeDirty=!0}reduceFeatures(t,e,s){if(t<=0)return!1;if(!this._features)return this.featureLimit=0,!1;let i=!1;this.featureLimit=Math.ceil(this.numFeatures*t),this.featureLimit>this._features.length&&(this.featureLimit=this._features.length,4===this.fetchStatus&&this._features.length>0&&(this.fetchStatus=1,i=!0)),!this._shuffled&&t<1&&this._shuffle(s);const r=Math.max(this.featureLimit,Math.ceil(e*this.numFeatures));return this._features.length>r&&(this._features.length=r,this.featuresMissing=!0,5===this.fetchStatus&&(this.fetchStatus=4)),i}get cache(){return{availableFields:this._availableFields,features:this.features,numFeatures:this._numFeatures,emptyFeatureRatio:this._emptyFeatureRatio,fetchStatus:this.fetchStatus,featuresMissing:this.featuresMissing}}set cache(t){this.requestController=null,this._availableFields=t.availableFields,this._features=t.features,this._numFeatures=t.numFeatures,this._emptyFeatureRatio=t.emptyFeatureRatio,this.fetchStatus=t.fetchStatus,this.featuresMissing=t.featuresMissing,this._estimatedSize=-1,this._estimatedUnusedSizeDirty=!0}}const o=-1,F=-2;function S(t,e,s){if(i(e)||i(t)||s!==e.length||s>t.length)return!1;for(let i=0;i<s;++i)if(t[i]!==e[i])return!1;return!0}const p=f();export{F as FAILED_FEATURE_COUNT,g as FeatureTile};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import s from\"../../../../core/Handles.js\";import i from\"../../../../core/Logger.js\";import{someMap as r}from\"../../../../core/MapUtils.js\";import{isSome as a,destroyMaybe as n,isNone as o,unwrap as u}from\"../../../../core/maybe.js\";import{createAbortController as l,isAbortError as h,eachAlways as c}from\"../../../../core/promiseUtils.js\";import{schedule as d}from\"../../../../core/scheduling.js\";import{on as p}from\"../../../../core/watchUtils.js\";import{property as f}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as m}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{equals as g,clone as F,expand as y,toExtent as T,create as x}from\"../../../../geometry/support/aaBoundingRect.js\";import{getObjectId as R,hasVertices as C}from\"../../../../layers/graphics/dehydratedFeatures.js\";import E from\"../../../../rest/support/QuantizationParameters.js\";import v from\"../../../../rest/support/Query.js\";import{MultiFeatureReference as b,SingleFeatureReference as M}from\"./featureReference.js\";import{FAILED_FEATURE_COUNT as _,FeatureTile as w}from\"./FeatureTile.js\";import{tilesAreRelated as j}from\"../../terrain/tileUtils.js\";import{ImmediateTask as D,TaskPriority as O}from\"../../../support/Scheduler.js\";const P=i.getLogger(\"esri.views.3d.layers.support.FeatureTileFetcher3D\");let q=class extends t{constructor(e){super(e),this._useTileCount=!1,this.updating=!1,this.updatingTotal=0,this.updatingRemaining=0,this.expectedFeatureDiff=0,this.maximumNumberOfFeaturesExceeded=!1,this.maximumNumberOfFeaturesExceededThrottle=1e3,this._fullRatio=1,this._farRatio=1,this.changes={updates:{adds:new Array,removes:new Array},adds:new Array,removes:new Array},this.handles=new s,this._frameTask=D,this._dirty=!1,this.featureTiles=new Map,this.displayingFeatureReferences=new Map,this.numDisplayingFeatureReferences=0,this.suspended=!0,this.pendingEdits=null}set maximumNumberOfFeatures(e){e=e||1/0;const t=this._get(\"maximumNumberOfFeatures\");e===t||e<1||(this._set(\"maximumNumberOfFeatures\",e),this.maximumFeaturesUpdated(t,e))}set memoryFactor(e){this.memoryFactor!==e&&(this._set(\"memoryFactor\",e),this.setDirty())}set lodFactor(e){this.lodFactor!==e&&(this._set(\"lodFactor\",e),this.supportsResolution&&this.refetch())}get useTileCount(){return this._useTileCount&&a(this.context.query.queryFeatureCount)}set useTileCount(e){this._useTileCount=e,this.notifyChange(\"useTileCount\")}get memoryForUnusedFeatures(){let e=0;return this.featureTiles.forEach((t=>e+=t.estimatedUnusedSize)),e}get totalVertices(){let e=0;return this.featureTiles.forEach((t=>e+=t.numVertices)),e}get totalFeatures(){let e=0;return this.featureTiles.forEach((t=>e+=t.numFeatures)),e}set filterExtent(e){if(e&&this.context.tilingScheme&&!e.spatialReference.equals(this.context.tilingScheme.spatialReference))return void P.error(\"#filterExtent=\",\"extent needs to be in the same spatial reference as the tiling scheme\");const t=this._get(\"filterExtent\");if(t===e||t&&e&&t.equals(e))return;const s=e?e.clone():null;this._set(\"filterExtent\",s),this.reclip(s,t)}initialize(){this.handles.add(p(this,\"tileDescriptors\",\"change\",(()=>this.setDirty()),(()=>this.setDirty()))),this.objectIdField=this.context.objectIdField,this.FeatureReferenceClass=this.context.capabilities.supportsMultipleResolutions?b:M;const e=this.context.scheduler;a(e)&&(this._frameTask=e.registerTask(O.FEATURE_TILE_FETCHER,this)),this.setDirty()}destroy(){this._frameTask.remove(),this.handles=n(this.handles),this.featureTiles.forEach((e=>{this.cancelFetchTile(e),this.removeTile(e)})),this.featureTiles.clear(),this.displayingFeatureReferences.clear(),this.pendingEdits&&(this.pendingEdits.controller.abort(),this.pendingEdits=null)}get paused(){return this.suspended||!!this.pendingEdits}restart(){this.featureTiles.forEach((e=>{this.cancelFetchTile(e),this.clearTile(e),this.resetFetchTile(e)})),a(this.context.memoryCache)&&this.context.memoryCache.clear(),this.setDirty()}refetch(){this.featureTiles.forEach((e=>{this.cancelFetchTile(e),this.resetFetchTile(e)})),a(this.context.memoryCache)&&this.context.memoryCache.clear(),this.setDirty()}suspend(){this.suspended||(this.suspended=!0,this.pause(),this.setDirty())}resume(){this.suspended&&(this.suspended=!1,this.unpause())}pause(){this.paused&&(this.featureTiles.forEach((e=>this.cancelFetchTile(e))),this.updated())}unpause(){this.paused||(this.setDirty(),this.updated())}get availableFields(){let e=null;return this.featureTiles.forEach((t=>{o(t.displayingFeatures)||0===t.displayingFeatures.length||(o(e)?e=new Set(t.availableFields):e.forEach((s=>{t.availableFields.has(s)||u(e).delete(s)})))})),a(e)?e:new Set}applyEdits(e){this.pendingEdits||(this.pendingEdits={edits:Promise.resolve(),count:0,controller:l()},this.pause());const t=this.pendingEdits;t.count++;const s=t.edits.then((()=>e.result.catch((e=>{if(h(e))throw e;return null})).then((e=>e?(this.applyEditsDeleteFeatures(e.deletedFeatures),this.applyEditsAddUpdateFeatures(e.addedFeatures,e.updatedFeatures,t.controller.signal).then((()=>e))):e)).then((e=>(0==--t.count&&(this.pendingEdits===t&&(this.pendingEdits=null),a(this.context.memoryCache)&&this.context.memoryCache.clear(),this.unpause(),this.updated()),e)))));return t.edits=s,this.updated(),s}applyEditsDeleteFeatures(e){if(0===e.length)return;const t=this.context.globalIdField,s=t&&this.availableFields.has(t),i=new Set,r=this.objectIdField;e.forEach((({objectId:e,globalId:a})=>{if((!e||e<0)&&t){s||P.errorOncePerTick(`Editing the specified service requires the layer's globalIdField, ${t} to be included the layer's outFields for updates to be reflected in the view`);const e=this.features.find((e=>e.attributes&&e.attributes[t]===a));e&&i.add(R(e,r))}else i.add(e)})),this.featureTiles.forEach((e=>{if(!e.features)return;const t=e.features.filter((e=>!i.has(R(e,this.objectIdField))));t.length!==e.features.length&&(e.setFeatures(t,0,e.availableFields),this.invalidateCounts())}))}async applyEditsAddUpdateFeatures(e,t,s){const i=[],r=new Set;if(e.forEach((e=>i.push(e.objectId))),t.forEach((e=>{i.push(e.objectId),r.add(e.objectId)})),0===i.length)return;const a=[];this.featureTiles.forEach((e=>{const t=this.applyEditsAddUpdateTile(e,i,r,s);t&&a.push(t)})),await c(a)}async applyEditsAddUpdateTile(e,t,s,i){if(!e.features)return;const r=this.createQuery(e);r.resultType=void 0,r.cacheHint=!1,r.objectIds=t;const a=await this.queryFeatures(r,i);let n=null;if(s.size>0){const t=e.features.filter((e=>!s.has(R(e,this.objectIdField))));t.length!==e.features.length&&(n=t)}if(a.features.length>0){n||(n=e.features.slice());for(const e of a.features)n.push(e)}n&&(e.hasPreciseFeatureCount&&(e.numFeatures=Math.max(e.numFeatures,n.length)),e.setFeatures(n,0,k(e.availableFields,a.fields)),this.invalidateCounts())}queryFeatures(e,t){return this.context.query.queryFeaturesDehydrated(e,{signal:t,timeout:H})}setDirty(){this._dirty=!0,this.updated()}get running(){return this.updating}runTask(e){if(this._frameTask.processQueue(e),!this._dirty||!this.constructed)return;this._dirty=!1;const t=this.getListOfTiles();if(this.markTilesNotAlive(t),!e.run((()=>this.addTiles(t,e)))||!e.run((()=>this.filterExtentTiles(t,e)))||!e.run((()=>this.removeTiles(t,e)))||e.done)return void this.setDirty();const s=this.sortTiles(t);e.run((()=>this.displayTiles(s,e)))&&e.run((()=>this.fetchTiles(s,e)))&&e.run((()=>this.updateMemoryEstimates(s,e)))||this.setDirty(),this.updated(),this.updating||this.updateMaximumNumberOfFeaturesExceeded()}markTilesNotAlive(e){for(const t of e)t.alive=!1}addTiles(e,t){return!this.suspended&&(this.tileDescriptors.forEach((s=>{const i=this.featureTiles.get(s.id);i?i.alive=!0:t.done||(e.push(this.addTile(s)),t.madeProgress())})),t.hasProgressed)}filterExtentTiles(e,t){for(const s of e){if(t.done)break;s.alive&&(s.filtered=!s.intersects(this.filterExtent),s.filtered&&(this.clearTile(s),t.madeProgress()))}return t.hasProgressed}removeTiles(e,t){for(let s=e.length-1;s>=0&&!t.done;s--){const i=e[s];i.alive||(this.removeTile(i),s!==e.length-1&&(e[s]=e[e.length-1]),e.pop(),t.madeProgress())}return t.hasProgressed}sortTiles(e){return e.sort(((e,t)=>e.descriptor.loadPriority-t.descriptor.loadPriority)),e}displayTiles(e,t){const s=this.updateRatio(e),i=e=>{const t=this._fullRatio<1?s(e)*this._farRatio:1;return e.reduceFeatures(t,this.memoryFactor,this.objectIdField)&&this.setDirty(),this.showTile(e)};for(const r of e)if(!t.run((()=>i(r)))){this.setDirty();break}return t.hasProgressed}fetchTiles(e,t){if(this.paused)return!1;let s=!1;for(const i of e){if(!i.needsFetching)continue;const e=a(this.context.memoryCache)?this.context.memoryCache.pop(i.id):null;if(a(e))i.cache=e,this.setDirty(),this.scheduleUpdated(),t.madeProgress();else{if(this.needsNumFeatures(i)){const e=l(),r=this.fetchTileCount(i,e.signal);this._handleRequest(i,r,e,(()=>i.numFeatures=_)),s=!0,t.madeProgress()}if(t.done)return!0}}if(s)return t.hasProgressed;for(const i of e)if(i.needsFetching){const e=l(),s=this.fetchTile(i,e.signal);if(this._handleRequest(i,s,e,(e=>{i.setFeatures([],0,null),this.invalidateCounts(),i.featuresMissing=!1,this.context.logFetchError(P,e)})),t.madeProgress(),t.done)return!0}return t.hasProgressed}updateMemoryEstimates(e,t){return e.some((e=>!t.run((()=>e.updateMemoryEstimates()))&&(this.setDirty(),!0))),t.hasProgressed}reclip(e,t){if(!this.constructed)return;const s=new Array;this.featureTiles.forEach((i=>{o(i.displayingFeatures)||0===i.displayingFeatures.length||(i.intersectionIncludingBorrowed(t,V),i.intersectionIncludingBorrowed(e,z),g(V,z)||s.push(i))})),this.refreshDisplayingFeatures(s),this.updated()}refreshDisplayingFeatures(e){const t=new Set,s=this.changes.updates;for(const i of e)if(!o(i.displayingFeatures))for(const e of i.displayingFeatures){const i=R(e,this.objectIdField);if(t.has(i))continue;t.add(i);const{feature:r}=this.displayingFeatureReferences.get(i);s.removes.push(r),s.adds.push(r)}this.applyChanges()}updated(){let e=0;this.paused||this.featureTiles.forEach((t=>t.isFetching?++e:0));const t=this._dirty||e>0||!!this.pendingEdits;if(this._set(\"updating\",t),t){let t=0,s=0,i=0,r=0,n=0;const o=this.displayingFeatureReferences.size/this.numDisplayingFeatureReferences;this.featureTiles.forEach((e=>{if(++s,e.isFetching&&e.hasPreciseFeatureCount){const t=this.maximumFeaturesForTile(e)*(1-e.emptyFeatureRatio),s=a(e.displayingFeatures)?e.displayingFeatures.length*o:0;n+=t-s}e.needsFetching?++r:e.numFeatures>0&&(++i,t+=e.numFeatures)})),r+=e;let u=0,l=0;t?(l=t,u=Math.min(r*t/i,t)):(l=s,u=r),n=Math.min(this.maximumNumberOfFeatures-this.features.length,n),this._set(\"updatingTotal\",l),this._set(\"updatingRemaining\",u),this._set(\"expectedFeatureDiff\",n)}else this._set(\"updatingTotal\",0),this._set(\"updatingRemaining\",0),this._set(\"expectedFeatureDiff\",0);this.debugger&&this.debugger.update()}updateMaximumNumberOfFeaturesExceeded(){const e=r(this.featureTiles,(e=>e.perTileMaximumNumberOfFeaturesExceeded));this._set(\"maximumNumberOfFeaturesExceeded\",e)}updateRatio(e){const t=S(e),s=e=>1/(1<<Math.max(0,t-e.descriptor.lij[0]));let i=0,r=0;for(const a of e){const e=a.numFeatures;i+=e,r+=e*s(a)}return this._fullRatio=Math.min(1,this.maximumNumberOfFeatures/i),this._farRatio=this.maximumNumberOfFeatures/r,this.scheduleUpdated(),s}maximumFeaturesUpdated(e,t){e!==t&&(t>e&&this.featureTiles.forEach((e=>{if(!e.featuresMissing)return;const t=this.maximumFeaturesForTile(e);e.features&&(e.features.length>=t||5===e.fetchStatus)||(this.cancelFetchTile(e),this.resetFetchTile(e))})),this.setDirty())}addTile(e){const t=new w(e);return this.featureTiles.set(t.id,t),this.resetFetchTile(t),this.referenceDisplayingFeaturesFromRelatedTiles(t),t}referenceDisplayingFeaturesFromRelatedTiles(e){const t=e.descriptor.resolution;this.featureTiles.forEach((s=>{if(!(o(s.displayingFeatures)||e===s||e.descriptor.lij&&s.descriptor.lij&&!j(e.descriptor.lij,s.descriptor.lij))){o(e.displayingFeatures)&&(e.displayingFeatures=[]),e.descriptor.extent&&s.descriptor.extent&&(o(e.extentIncludingBorrowedFeatures)&&(e.extentIncludingBorrowedFeatures=F(e.descriptor.extent)),y(e.extentIncludingBorrowedFeatures,s.descriptor.extent,e.extentIncludingBorrowedFeatures));for(const i of s.displayingFeatures){e.displayingFeatures.push(i);const s=this.displayingFeatureReferences.get(R(i,this.objectIdField));s.ref(s.feature,t),this.numDisplayingFeatureReferences++}}})),e.featureLimit=a(e.displayingFeatures)?e.displayingFeatures.length:0}removeTile(e){this.clearTile(e),this.featureTiles.delete(e.id)}resetFetchTile(e){e.filtered=!e.intersects(this.filterExtent),e.filtered?e.needsFetching&&(e.fetchStatus=4):e.fetchStatus=0}cancelFetchTile(e){const t=e.requestController;a(t)&&(e.requestController=null,e.resetFetching(),t.abort())}async fetchTileCount(e,t){return e.numFeatures=await this.fetchCount(e,t),this.updateRatio(this.getListOfTiles()),3===e.fetchStatus?1:0}async fetchTile(e,t){const s=this.maximumFeaturesForTile(e);if(s<=0)return N(e);const i=this.getMaxRecordCount(e),r=Math.ceil(s/i);if(I(e)||!this.context.capabilities.supportsMaxRecordCountFactor||e.numFeatures<=s&&r>v.MAX_MAX_RECORD_COUNT_FACTOR)return this.fetchPagedTile(e,t);const a=this.createQuery(e);if(a.maxRecordCountFactor=Math.ceil(s/i),e.isRefetching&&e.features&&e.features.length>0){const t=Math.ceil(e.features.length/(1-e.emptyFeatureRatio)/i);a.maxRecordCountFactor=Math.max(t+1,a.maxRecordCountFactor)}const{features:n,exceededTransferLimit:o,fields:u}=await this.queryFeatures(a,t),l=o?a.maxRecordCountFactor>=v.MAX_MAX_RECORD_COUNT_FACTOR?5:4:5;return await this._frameTask.schedule((()=>{e.featuresMissing=n.length<e.numFeatures||o;const t=this._removeEmptyFeatures(n);e.setFeatures(n,t,Q(u))}),t),this.invalidateCounts(),l}async fetchCount(e,t){return this.context.query.queryFeatureCount(this.createFeatureCountQuery(e),{signal:t})}async fetchPagedTile(e,t){let s,i=0,r=0,a=0,n=this.maximumFeaturesForTile(e)-a;const o=this.getMaxRecordCount(e);let l=null;for(;;){const h=this.createQuery(e),c=this.setPagingParameters(h,i,n,o),{features:d,exceededTransferLimit:p,fields:f}=await this.queryFeatures(h,t);if(await this._frameTask.schedule((()=>{c&&(i+=u(h.num)),a+=d.length,r+=this._removeEmptyFeatures(d),e.featuresMissing=i<e.numFeatures||p,s=s?s.concat(d):d,l=k(l,f),e.setFeatures(s,r,l)}),t),this.invalidateCounts(),this.setDirty(),n=this.maximumFeaturesForTile(e)-a,!c||!p||n<=0)return p?4:5}}createFeatureCountQuery(e){const t=this.createQuery(e);return this.context.capabilities.supportsCacheHint&&(t.resultType=void 0,t.cacheHint=!0),t}createQuery(e){const t=this.context.createQuery(),s=e.descriptor.extent;if(s){const e=this.context.tilingScheme.spatialReference;t.geometry=T(s,e)}return this.setResolutionParams(t,e),this.useTileQuery(e)?t.resultType=\"tile\":this.context.capabilities.supportsCacheHint&&(t.cacheHint=!0),t}setPagingParameters(e,t,s,i){return!!this.context.capabilities.supportsPagination&&(e.start=t,s>0&&this.context.capabilities.supportsMaxRecordCountFactor?(e.maxRecordCountFactor=Math.ceil(s/i),e.num=Math.min(e.maxRecordCountFactor*i,s)):e.num=Math.min(i),!0)}getEffectiveTileResolution(e){if(null==e.descriptor.resolution)return null;const t=1===this.context.viewingMode?this.context.tilingScheme.resolutionAtLevel(3):1/0;return Math.min(e.descriptor.resolution,t)/this.lodFactor}get supportsResolution(){return this.context.capabilities.supportsMultipleResolutions&&\"point\"!==this.context.geometryType}setResolutionParams(e,t){if(!this.supportsResolution)return;const s=this.getEffectiveTileResolution(t);null!=s&&(this.context.capabilities.supportsQuantization?e.quantizationParameters=new E({mode:\"view\",originPosition:\"upper-left\",tolerance:s,extent:this.context.fullExtent}):\"polyline\"===this.context.geometryType&&(e.maxAllowableOffset=s))}_removeEmptyFeatures(e){const t=e.length;for(let s=0;s<e.length;){const t=e[s];C(t.geometry)?++s:(e[s]=e[e.length-1],--e.length)}return t-e.length}needsNumFeatures(e){return this.useTileCount&&e.needsFeatureCount&&!I(e)}getMaxRecordCount(e){const{tileMaxRecordCount:t,maxRecordCount:s}=this.context;return this.useTileQuery(e)&&a(t)&&t>0&&this.context.capabilities.supportsResultType?t:a(s)&&s>0?s:L}useTileQuery(e){return(!I(e)||!this.context.capabilities.supportsCacheHint)&&this.context.capabilities.supportsResultType}_handleRequest(e,t,s,i){e.fetchStatus=e.needsRefetching?3:2,e.requestController=s;let r=!1;t.then((t=>{e.requestController=null,e.fetchStatus=t})).catch((t=>{e.requestController===s&&(e.requestController=null,e.fetchStatus=4),h(t)?r=!0:i(t)})).then((()=>{r||this.setDirty(),this.scheduleUpdated()}))}scheduleUpdated(){this.handles&&!this.handles.has(\"scheduleUpdated\")&&this.handles.add(d((()=>{this.handles.remove(\"scheduleUpdated\"),this.updated()})),\"scheduleUpdated\")}showTile(e){if(a(e.displayingFeatures)&&!e.needsDisplayUpdate)return!1;const t=e.features;if(0===e.featureLimit||!t){const t=a(e.displayingFeatures)&&e.displayingFeatures.length>0;return this.hideTileFeatures(e),e.displayingFeatures=[],t}const s=e.descriptor.resolution,i=this.changes.updates,r=this.changes.adds,n=Math.min(e.featureLimit,t.length);e.featureLimit=n;for(let a=0;a<n;++a){const e=t[a],n=R(e,this.objectIdField),o=this.displayingFeatureReferences.get(n);if(o){const t=o.ref(e,s);t.oldVersion!==t.newVersion&&(i.removes.push(t.oldVersion),i.adds.push(t.newVersion))}else this.displayingFeatureReferences.set(n,new this.FeatureReferenceClass(e,s)),r.push(e);this.numDisplayingFeatureReferences++}return this.hideTileFeatures(e),this.applyChanges(),e.displayingFeatures=t.slice(0,n),!0}hideTile(e){this.cancelFetchTile(e),this.hideTileFeatures(e)}hideTileFeatures(e){if(o(e.displayingFeatures))return;const t=this.changes.updates,s=this.changes.removes;for(const i of e.displayingFeatures){const r=R(i,this.objectIdField),a=this.displayingFeatureReferences.get(r);if(!a)continue;const n=a.unref(e.descriptor.resolution);this.numDisplayingFeatureReferences--,n?n.oldVersion!==n.newVersion&&(null==n.newVersion?(this.displayingFeatureReferences.delete(r),s.push(n.oldVersion)):(t.adds.push(n.newVersion),t.removes.push(n.oldVersion))):console.error(\"Hiding unreferenced feature\")}this.applyChanges(),e.displayingFeatures=null}applyChanges(){const e=this.changes.updates;e.removes.length>0&&(this.features.removeMany(e.removes),e.removes.length=0),e.adds.length>0&&(this.features.addMany(e.adds),e.adds.length=0);const t=this.changes.adds,s=this.changes.removes,i=Math.min(t.length,s.length);let r=0;for(;r<i;){const e=Math.min(r+B,i);this.features.addMany(t.slice(r,e)),this.features.removeMany(s.slice(r,e)),r=e}t.length>i&&this.features.addMany(0===r?t:t.slice(r)),s.length>i&&this.features.removeMany(0===r?s:s.slice(r)),t.length=0,s.length=0}clearTile(e){if(this.hideTile(e),e.features&&a(this.context.memoryCache)){const t=16+e.estimatedSize;this.context.memoryCache.put(e.id,e.cache,t)}e.setFeatures(null,0,null),this.invalidateCounts()}invalidateCounts(){this.notifyChange(\"totalVertices\"),this.notifyChange(\"totalFeatures\"),this.notifyChange(\"memoryForUnusedFeatures\")}getListOfTiles(){return Array.from(this.featureTiles.values())}get storedFeatures(){return this.getListOfTiles().reduce(((e,t)=>e+(t.features?t.features.length:0)),0)}maximumFeaturesForTile(e){const t=e.hasPreciseFeatureCount?e.numFeatures:1/0,s=e.hasPreciseFeatureCount?t:this.maximumNumberOfFeatures,i=this._fullRatio<1?this._farRatio:1;return Math.min(Math.ceil(s*i/(1-e.emptyFeatureRatio)),t)}get test(){return{process:e=>this.runTask(e),getFeatureTileById:e=>this.featureTiles.get(e),forEachFeatureTile:e=>this.featureTiles.forEach(e)}}};function I(e){return\"dummy-tile-full-extent\"===e.id}function S(e){let t=0;for(const s of e)s.features&&s.features.length>0&&s.alive&&(t=Math.max(t,s.descriptor.lij[0]));return t}function U(e){const t=e.capabilities.query;return{supportsMultipleResolutions:A(e),supportsPagination:!(!t||!t.supportsPagination),supportsResultType:!(!t||!t.supportsResultType),supportsCacheHint:!(!t||!t.supportsCacheHint),supportsQuantization:!(!t||!t.supportsQuantization),supportsQuantizationEditMode:!(!t||!t.supportsQuantizationEditMode),supportsMaxRecordCountFactor:!(!t||!t.supportsMaxRecordCountFactor),supportsFormatPBF:!(!t||!t.supportsFormatPBF)}}function A(e){switch(e.geometryType){case\"polyline\":return!0;case\"polygon\":return e.capabilities&&e.capabilities.query&&e.capabilities.query.supportsQuantization;default:return!1}}function N(e){return e.setFeatures([],0,null),e.featuresMissing=!1,4}function Q(e){return o(e)?new Set:new Set(e.map((e=>e.name)))}function k(e,t){if(o(e)||o(t))return Q(t);const s=new Set;for(const{name:i}of t)e.has(i)&&s.add(i);return s}e([f({constructOnly:!0})],q.prototype,\"features\",void 0),e([f()],q.prototype,\"tileDescriptors\",void 0),e([f({value:1/0})],q.prototype,\"maximumNumberOfFeatures\",null),e([f({value:1})],q.prototype,\"memoryFactor\",null),e([f({value:1})],q.prototype,\"lodFactor\",null),e([f()],q.prototype,\"useTileCount\",null),e([f({readOnly:!0})],q.prototype,\"updating\",void 0),e([f({readOnly:!0})],q.prototype,\"updatingTotal\",void 0),e([f({readOnly:!0})],q.prototype,\"updatingRemaining\",void 0),e([f({readOnly:!0})],q.prototype,\"expectedFeatureDiff\",void 0),e([f({readOnly:!0})],q.prototype,\"memoryForUnusedFeatures\",null),e([f({readOnly:!0})],q.prototype,\"maximumNumberOfFeaturesExceeded\",void 0),e([f({constructOnly:!0})],q.prototype,\"maximumNumberOfFeaturesExceededThrottle\",void 0),e([f({readOnly:!0})],q.prototype,\"totalVertices\",null),e([f({readOnly:!0})],q.prototype,\"totalFeatures\",null),e([f()],q.prototype,\"filterExtent\",null),e([f({constructOnly:!0})],q.prototype,\"context\",void 0),q=e([m(\"esri.views.3d.layers.support.FeatureTileFetcher3D\")],q);const L=2e3,V=x(),z=x(),H=6e5,B=200;var X=q;export default X;export{q as FeatureTileFetcher3D,U as contextCapabilitiesFromLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../../Graphic.js\";import t from\"../../../../geometry/Polygon.js\";import i from\"../../../../symbols/FillSymbol3DLayer.js\";import s from\"../../../../symbols/PointSymbol3D.js\";import a from\"../../../../symbols/PolygonSymbol3D.js\";import o from\"../../../../symbols/TextSymbol3DLayer.js\";import r from\"../../terrain/TilingScheme.js\";const h=[[0,179,255],[117,62,128],[0,104,255],[215,189,166],[32,0,193],[98,162,206],[102,112,129],[52,125,0],[142,118,246],[138,83,0],[92,122,255],[122,55,83],[0,142,255],[81,40,179],[0,200,244],[13,24,127],[0,170,147],[19,58,241],[22,44,35]];class l{constructor(e,t,s){this.loadingGraphics=new Map,this.loadedGraphics=new Map,this.pendingGraphics=new Map,this._enabled=!0,this.tileFetcher=e,this.view=s,this.tilingScheme=new r(t),this.loadedSymbols=h.map((e=>new a(new i({material:{color:[e[0],e[1],e[2],.6]},outline:{color:\"black\",size:1}})))),this.loadingSymbols=[new a(new i({material:{color:[200,200,200,.4]},outline:{color:[30,30,30],size:1}}))],this.pendingSymbols=[new a(new i({material:{color:[100,100,100,.4]},outline:{color:[30,30,30],size:1}}))],this.dataExtentSymbol=new a(new i({material:{color:[0,0,0,0]},outline:{color:\"green\",size:4}}))}destroy(){this.enabled=!1}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}update(){this._enabled?(this.synchronizeMaps(this.loadingGraphics,{filter:e=>e.isFetching,symbols:this.loadingSymbols}),this.synchronizeMaps(this.loadedGraphics,{filter:e=>!e.isFetching,symbols:this.loadedSymbols}),this.synchronizeMaps(this.pendingGraphics,{filter:e=>!e.isFetching,symbols:this.pendingSymbols}),this.showDataExtent(this.tileFetcher.filterExtent)):(this.loadingGraphics.forEach((e=>{this.view.graphics.removeMany(e)})),this.loadingGraphics.clear(),this.loadedGraphics.forEach((e=>{this.view.graphics.removeMany(e)})),this.loadedGraphics.clear(),this.pendingGraphics.forEach((e=>{this.view.graphics.removeMany(e)})),this.pendingGraphics.clear(),this.dataExtentGraphic&&(this.view.graphics.remove(this.dataExtentGraphic),this.dataExtentGraphic=null))}showDataExtent(i){if(this.dataExtentGraphic&&(this.view.graphics.remove(this.dataExtentGraphic),this.dataExtentGraphic=null),!i)return;const s=t.fromExtent(i);this.dataExtentGraphic=new e({geometry:s,symbol:this.dataExtentSymbol}),this.view.graphics.add(this.dataExtentGraphic)}synchronizeMaps(t,i){const a=[];t.forEach(((e,t)=>{const s=this.tileFetcher.test.getFeatureTileById(t);s&&i.filter(s)||(this.view.graphics.removeMany(e),a.push(t))})),a.forEach((e=>t.delete(e))),this.tileFetcher.test.forEachFeatureTile((a=>{if(i.filter(a)&&!t.has(a.id)){const[r,h,l]=a.descriptor.lij;this.tilingScheme.ensureMaxLod(r);const n=this.tilingScheme.getExtentGeometry(r,h,l),c=[new e({geometry:n,symbol:i.symbols[r%i.symbols.length]}),new e({geometry:n.center,symbol:new s({verticalOffset:{screenLength:40/.75},callout:{type:\"line\",color:\"white\",border:{color:\"black\"}},symbolLayers:[new o({text:`${r}/${h}/${l}`,halo:{color:\"white\",size:1/.75},material:{color:\"black\"},size:16})]})})];t.set(a.id,c),this.view.graphics.addMany(c)}}))}}export default l;export{l as FeatureTileFetcher3DDebugger};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Accessor.js\";import{result as i}from\"../../../core/asyncUtils.js\";import r from\"../../../core/Collection.js\";import\"../../../core/has.js\";import s from\"../../../core/Error.js\";import a from\"../../../core/Handles.js\";import{clone as o}from\"../../../core/lang.js\";import n from\"../../../core/Logger.js\";import{isSome as l,destroyMaybe as c,removeMaybe as h,isNone as u}from\"../../../core/maybe.js\";import{EsriPromiseMixin as d}from\"../../../core/Promise.js\";import{createAbortController as m,isAbortError as p,eachAlways as f}from\"../../../core/promiseUtils.js\";import{whenOnce as y,init as g}from\"../../../core/watchUtils.js\";import{property as x}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as F}from\"../../../core/accessorSupport/decorators/subclass.js\";import{isHostedAgolService as v}from\"../../support/arcgisLayerUrl.js\";import{projectGeometry as T}from\"../../../portal/support/geometryServiceUtils.js\";import E from\"../../../rest/support/StatisticDefinition.js\";import{FeatureTileFetcher3D as w}from\"../../../views/3d/layers/support/FeatureTileFetcher3D.js\";import{FeatureTileFetcher3DDebugger as C}from\"../../../views/3d/layers/support/FeatureTileFetcher3DDebugger.js\";import D from\"../../../views/3d/support/debugFlags.js\";import{WatchUpdatingTracking as b}from\"../../../views/support/WatchUpdatingTracking.js\";const S=n.getLogger(\"esri.layers.graphics.controllers.FeatureTileController3D\");let _=class extends(d(t)){constructor(e){super(e),this.type=\"feature-tile-3d\",this.watchUpdatingTracking=new b,this.serviceDataExtent=null,this.serviceDataCount=A.NO_SERVICE_DATA_COUNT,this.vertexLimitExceeded=!1,this.displayFeatureLimit=null,this.suspended=!1,this.tileFetcher=null,this.handles=new a,this.fetchDataInfoPromise=null,this.fetchDataInfoAbortController=null,this.lifeCycleAbortController=m()}set extent(e){if(e&&!e.spatialReference.equals(this.layerView.view.spatialReference))return void S.error(\"#extent=\",\"extent needs to be in the same spatial reference as the view\");const t=this._get(\"extent\");if(t===e)return;if(t&&e&&t.equals(e))return;const i=e?e.clone():null;this._set(\"extent\",i)}get updating(){return!!(l(this.tileFetcher)&&this.tileFetcher.updating||null!=this.fetchDataInfoPromise||\"tiles\"===this.mode&&this.layerView.view.featureTiles&&this.layerView.view.featureTiles.updating||this.watchUpdatingTracking&&this.watchUpdatingTracking.updating)}get updatingTotal(){return this.updating&&l(this.tileFetcher)?this.tileFetcher.updatingTotal:0}get updatingRemaining(){return this.updating&&l(this.tileFetcher)?this.tileFetcher.updatingRemaining:0}get expectedFeatureDiff(){return this.updating&&l(this.tileFetcher)?this.tileFetcher.expectedFeatureDiff:0}get memoryForUnusedFeatures(){return l(this.tileFetcher)?this.tileFetcher.memoryForUnusedFeatures:0}get maximumNumberOfFeaturesExceeded(){return!(!l(this.tileFetcher)||!this.tileFetcher.maximumNumberOfFeaturesExceeded)}get maximumNumberOfFeatures(){return l(this.displayFeatureLimit)?this.displayFeatureLimit.maximumNumberOfFeatures:0}set maximumNumberOfFeatures(e){e!==this.maximumNumberOfFeatures&&(null==e?this._clearOverride(\"maximumNumberOfFeatures\"):this._override(\"maximumNumberOfFeatures\",e))}get hasMaximumNumberOfFeaturesOverride(){return this._isOverridden(\"maximumNumberOfFeatures\")}get mode(){const e=this.layerView.layer;if(\"feature\"===e.type&&l(e.infoFor3D))return\"snapshot\";if(this.serviceDataCount===A.NO_SERVICE_DATA_COUNT||this.vertexLimitExceeded)return\"tiles\";const t=this.layerView.view,i=t&&t.featureTiles,r=i&&i.tilingScheme;if(e&&e.minScale&&this.serviceDataExtent&&r){const t=this.approximateExtentSizeAtScale(e.minScale,r);if((this.serviceDataExtent.width/t+this.serviceDataExtent.height/t)/2>A.MAX_SNAPSHOT_MIN_SCALE_FACTOR)return\"tiles\"}return!this.maximumNumberOfFeatures||this.serviceDataCount<=this.maximumNumberOfFeatures?\"snapshot\":\"tiles\"}get maxTotalSnapshotVertices(){const e=this._get(\"maxTotalSnapshotVertices\")||0,t=\"snapshot\"===this.mode&&l(this.tileFetcher)&&this.tileFetcher.totalVertices||0;return Math.max(e,t)}approximateExtentSizeAtScale(e,t){const i=this.layerView.view,r=Math.ceil((i.width/t.pixelSize+i.height/t.pixelSize)/2),s=t.levels[0];return r*((s.tileSize[0]/(s.scale/e)+s.tileSize[1]/(s.scale/e))/2)}get tileDescriptors(){return\"snapshot\"===this.mode?new r([{id:\"dummy-tile-full-extent\",lij:[0,0,0]}]):this.layerView.view.featureTiles?this.layerView.view.featureTiles.tiles:new r}get test(){return{fetchDataInfoPromise:this.fetchDataInfoPromise,tileFetcher:this.tileFetcher}}initialize(){this.watchUpdatingTracking.add(this,\"vertexLimitInfo\",(()=>this.watchUpdatingTracking.addPromise(this.updateVertexLimitExceeded(null,this.lifeCycleAbortController.signal)))),this.watchUpdatingTracking.add(this,\"mode\",(()=>this.modeChanged()),2),this.addResolvingPromise(Promise.resolve().then((()=>this.verifyCapabilities())).then((()=>this.watchUpdatingTracking.addPromise(this.fetchServiceDataInfo()))).then((()=>this.initializeTileFetcher())))}verifyCapabilities(){const e=this.layerView.layer;if(!e.get(\"capabilities.operations.supportsQuery\"))throw new s(\"graphicscontroller:query-capability-required\",\"Service requires query capabilities to be used as a feature layer\",{layer:e})}destroy(){this.cancelFetchServiceDataInfo(),this.tileFetcher=c(this.tileFetcher),this.handles=c(this.handles),this.tilesHandle=h(this.tilesHandle),this.lifeCycleAbortController&&(this.lifeCycleAbortController.abort(),this.lifeCycleAbortController=null),this.watchUpdatingTracking.destroy(),this._set(\"watchUpdatingTracking\",null)}suspend(){this.suspended||(this.suspended=!0,l(this.tileFetcher)&&this.tileFetcher.suspend())}resume(){this.suspended&&(this.suspended=!1,l(this.tileFetcher)&&this.tileFetcher.resume())}restart(){const e=()=>{l(this.tileFetcher)&&this.tileFetcher.restart()};this.watchUpdatingTracking.addPromise(this.fetchServiceDataInfo().then(e,e))}refetch(){const e=()=>{l(this.tileFetcher)&&this.tileFetcher.refetch()};this.watchUpdatingTracking.addPromise(this.fetchServiceDataInfo().then(e,e))}initializeTileFetcher(){const e=this.layerView.view;if(!e)return;const t=y(e.featureTiles,\"tilingScheme\",this.lifeCycleAbortController.signal);this.watchUpdatingTracking.addPromise(t),t.then((()=>{const{layerView:t,tileDescriptors:i}=this,r=t.layer,s=new w({context:this.context,filterExtent:this.extent,tileDescriptors:i,features:this.graphics});this.tileFetcher=s,this.suspended?this.tileFetcher.suspend():this.tileFetcher.resume();const a=this.layerView.view.resourceController;a&&(this.handles.add(a.memoryController.events.on(\"quality-changed\",(e=>{s.memoryFactor=e}))),this.tileFetcher.memoryFactor=a.memoryController.memoryFactor);const o=\"polygon\"===this.context.geometryType?\"polygonLodFactor\":\"polyline\"===this.context.geometryType?\"polylineLodFactor\":null;o&&this.handles.add(g(this.layerView.view,\"qualitySettings.graphics3D.\"+o,(e=>{s.lodFactor=e||1})));const n=e=>{s.maximumNumberOfFeatures=e,s.useTileCount=this.serviceDataCount>e},l=e=>s.useTileCount=e>this.maximumNumberOfFeatures;this.watchUpdatingTracking.add(r,\"createQueryVersion\",(()=>this.dataFilterChanged())),this.watchUpdatingTracking.add(t,\"availableFields\",((e,t)=>this.availableFieldsChanged(t,e))),this.watchUpdatingTracking.add(t,\"requiredFields\",((e,t)=>this.requiredFieldsChanged(t,e))),this.handles.add([r.on(\"apply-edits\",(e=>this.applyEdits(e))),this.watch(\"extent\",(e=>s.filterExtent=e),!0),this.watch(\"tileDescriptors\",(e=>s.tileDescriptors=e),!0),g(this,\"maximumNumberOfFeatures\",n,!0),g(this,\"serviceDataCount\",l,!0),g(D,\"FEATURE_TILE_FETCH_SHOW_TILES\",(t=>{t&&s&&!s.debugger?(s.debugger=new C(s,e.featureTiles.tilingScheme.toTileInfo(),e),s.debugger.update()):!t&&this.tileFetcher&&s.debugger&&(s.debugger.destroy(),s.debugger=null)}))]),this.supportsExceedsLimitQuery||this.watchUpdatingTracking.add(this,\"maxTotalSnapshotVertices\",(()=>this.watchUpdatingTracking.addPromise(this.updateVertexLimitExceeded(null,this.lifeCycleAbortController.signal))))})).catch((()=>{}))}modeChanged(){switch(this.mode){case\"tiles\":this.tilesHandle||(this.tilesHandle=this.layerView.view.featureTiles.addClient());break;default:S.warn(\"Unhandled feature layer mode \"+this.mode);case\"snapshot\":l(this.tilesHandle)&&(this.tilesHandle.remove(),this.tilesHandle=null)}}dataFilterChanged(){this._set(\"maxTotalSnapshotVertices\",0),this.notifyChange(\"maxTotalSnapshotVertices\"),this.refetch()}applyEdits(e){u(this.tileFetcher)||this.tileFetcher.applyEdits(e).then((e=>{e&&(e.deletedFeatures.length||e.updatedFeatures.length||e.addedFeatures.length)&&this.watchUpdatingTracking.addPromise(this.updateServiceDataExtent(this.lifeCycleAbortController.signal))})).catch((e=>{if(!p(e))throw e}))}availableFieldsChanged(e,t){l(this.tileFetcher)&&N(this.tileFetcher.availableFields,t)&&this.refetch()}requiredFieldsChanged(e,t){l(this.tileFetcher)&&N(this.tileFetcher.availableFields,t)&&this.restart()}createVertexLimitExceededQuery(e){const t=this.layerView.layer,i=t.createQuery();return i.outStatistics=[new E({statisticType:\"exceedslimit\",maxVertexCount:e,outStatisticFieldName:\"exceedslimit\",maxPointCount:1e8,maxRecordCount:1e8})],t.capabilities.query.supportsCacheHint&&(i.cacheHint=!0),i}createDataInfoQuery(){const e=this.layerView.layer,t=e.createQuery();return t.outSpatialReference=this.layerView.view.spatialReference,e.capabilities.query.supportsCacheHint&&(t.cacheHint=!0),t}fullExtentIsAccurate(){const e=this.layerView.layer;if(e.definitionExpression)return!1;switch(e.type){case\"feature\":return v(e.url);case\"csv\":case\"geojson\":case\"ogc-feature\":case\"wfs\":return!0;default:return}}async updateServiceDataExtent(e){try{await this.tryUpdateServiceDataExtent(e)}catch(t){p(t)||this._set(\"serviceDataExtent\",o(this.layerView.fullExtentInLocalViewSpatialReference))}}async tryUpdateServiceDataExtent(e){const t=this.layerView,i=t.layer,r=i.capabilities.query.supportsExtent,s=o(t.fullExtentInLocalViewSpatialReference),a=i.fullExtent,n=this.fullExtentIsAccurate(),l=this.serviceDataCount;if(r&&l<=A.MAX_FEATURE_COUNT_FOR_EXTENT&&(!s||!n)&&\"queryExtent\"in i){const t=this.createDataInfoQuery(),r=await i.queryExtent(t,{timeout:A.QUERY_EXTENT_TIMEOUT,signal:e});this._set(\"serviceDataExtent\",r.extent)}else if(s)this._set(\"serviceDataExtent\",s);else if(a){const r=\"portalItem\"in i?i.portalItem:null,s=await T(a,t.view.spatialReference,r,e);this._set(\"serviceDataExtent\",s)}else this._set(\"serviceDataExtent\",null)}async updateServiceDataCount(e){const t=this.layerView.layer;if(!(\"queryFeatureCount\"in t))return void this._set(\"serviceDataCount\",A.NO_SERVICE_DATA_COUNT);const r=await i(t.queryFeatureCount(this.createDataInfoQuery(),{timeout:A.QUERY_STATISTICS_TIMEOUT,signal:e}));if(!0===r.ok)this._set(\"serviceDataCount\",r.value);else{if(p(r.error))throw r.error;this._set(\"serviceDataCount\",A.NO_SERVICE_DATA_COUNT)}}get vertexLimitInfo(){if(u(this.displayFeatureLimit)||u(this.displayFeatureLimit.averageSymbolComplexity))return null;const{averageSymbolComplexity:e,maximumTotalNumberOfPrimitives:t}=this.displayFeatureLimit,{primitivesPerCoordinate:i,primitivesPerFeature:r}=e,s=this._get(\"vertexLimitInfo\");return u(s)||s.maximumTotalNumberOfPrimitives!==t||s.primitivesPerCoordinate!==i||s.primitivesPerFeature!==r?{primitivesPerCoordinate:i,primitivesPerFeature:r,maximumTotalNumberOfPrimitives:t}:s}get supportsExceedsLimitQuery(){const e=this.layerView.layer;return e.capabilities&&e.capabilities.operations&&e.capabilities.operations.supportsExceedsLimitStatistics}get minimumNumberOfVerticesForGeometry(){switch(this.layerView.layer.geometryType){case\"point\":case\"multipoint\":return 1;case\"polygon\":return 4;case\"polyline\":return 2;case\"multipatch\":case\"mesh\":return 3;default:return 0}}async updateVertexLimitExceeded(e,t){const r=this.vertexLimitInfo;if(u(r))return void this._set(\"vertexLimitExceeded\",!1);const s=r.primitivesPerFeature<=0,a=this.minimumNumberOfVerticesForGeometry>1;if(!s&&!a)return void this._set(\"vertexLimitExceeded\",!1);const{primitivesPerFeature:o,primitivesPerCoordinate:n,maximumTotalNumberOfPrimitives:c}=r;let h;0!==o&&l(e)&&await e;const d=this.serviceDataCount,m=d!==A.NO_SERVICE_DATA_COUNT;if(h=m?Math.ceil((c-d*o)/(n||1)):Math.ceil(c/(n||1)),a&&(h=Math.min(h,U)),m&&this.minimumNumberOfVerticesForGeometry*d>h)return void this._set(\"vertexLimitExceeded\",!0);if(!this.supportsExceedsLimitQuery)return void this._set(\"vertexLimitExceeded\",this.maxTotalSnapshotVertices>h);const f=await i(this.layerView.layer.queryFeatures(this.createVertexLimitExceededQuery(h),{timeout:A.QUERY_STATISTICS_TIMEOUT,signal:t}));if(!1===f.ok){if(p(f.error))throw f.error;return void this._set(\"vertexLimitExceeded\",!1)}const y=f.value.features[0];y&&y.attributes?this._set(\"vertexLimitExceeded\",!!y.attributes.exceedslimit):this._set(\"vertexLimitExceeded\",!1)}async fetchServiceDataInfo(){this.cancelFetchServiceDataInfo();let e=m();const t=e.signal,i=this.updateServiceDataCount(t),r=f([i,this.updateVertexLimitExceeded(i,t)]),s=r.then((()=>this.updateServiceDataExtent(t))).catch((e=>{p(e)||S.error(\"#fetchServiceDataInfo()\",e)})).then((()=>{s===this.fetchDataInfoPromise&&(this.fetchDataInfoPromise=null,this.fetchDataInfoAbortController=null),e=null}));return e&&(this.fetchDataInfoPromise=s),this.fetchDataInfoAbortController=e,r.then((()=>{}),(()=>{}))}cancelFetchServiceDataInfo(){const e=this.fetchDataInfoAbortController;e&&(this.fetchDataInfoAbortController=null,this.fetchDataInfoPromise=null,e.abort())}get debug(){return{storedFeatures:l(this.tileFetcher)?this.tileFetcher.storedFeatures:0,totalFeatures:l(this.tileFetcher)?this.tileFetcher.totalFeatures:0,totalVertices:l(this.tileFetcher)?this.tileFetcher.totalVertices:0}}};e([x({readOnly:!0})],_.prototype,\"type\",void 0),e([x({constructOnly:!0})],_.prototype,\"graphics\",void 0),e([x({constructOnly:!0})],_.prototype,\"layerView\",void 0),e([x({constructOnly:!0})],_.prototype,\"context\",void 0),e([x()],_.prototype,\"extent\",null),e([x()],_.prototype,\"updating\",null),e([x({readOnly:!0})],_.prototype,\"watchUpdatingTracking\",void 0),e([x()],_.prototype,\"updatingTotal\",null),e([x()],_.prototype,\"updatingRemaining\",null),e([x()],_.prototype,\"expectedFeatureDiff\",null),e([x()],_.prototype,\"memoryForUnusedFeatures\",null),e([x()],_.prototype,\"maximumNumberOfFeaturesExceeded\",null),e([x({readOnly:!0})],_.prototype,\"serviceDataExtent\",void 0),e([x({readOnly:!0})],_.prototype,\"serviceDataCount\",void 0),e([x({readOnly:!0})],_.prototype,\"vertexLimitExceeded\",void 0),e([x()],_.prototype,\"displayFeatureLimit\",void 0),e([x({type:Number})],_.prototype,\"maximumNumberOfFeatures\",null),e([x({readOnly:!0})],_.prototype,\"mode\",null),e([x({readOnly:!0})],_.prototype,\"maxTotalSnapshotVertices\",null),e([x({readOnly:!0,dependsOn:[\"mode\"]})],_.prototype,\"tileDescriptors\",null),e([x()],_.prototype,\"tileFetcher\",void 0),e([x()],_.prototype,\"fetchDataInfoPromise\",void 0),e([x({readOnly:!0})],_.prototype,\"vertexLimitInfo\",null),_=e([F(\"esri.layers.graphics.controllers.FeatureTileController3D\")],_);const O=1e4,I=12e3,V=1e4,U=5e6;function N(e,t){if(!t)return!1;for(const i of t)if(!e.has(i))return!0;return!1}var A;!function(e){function t(){e.MAX_FEATURE_COUNT_FOR_EXTENT=O,e.QUERY_STATISTICS_TIMEOUT=I,e.QUERY_EXTENT_TIMEOUT=V}e.NO_SERVICE_DATA_COUNT=1/0,e.MAX_SNAPSHOT_MIN_SCALE_FACTOR=5,e.reset=t}(A||(A={})),A.reset();export{_ as FeatureTileController3D,A as FeatureTileController3DConstants};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{destroyMaybe as r,isSome as i,get as s,isNone as n}from\"../../../core/maybe.js\";import{whenTrueOnce as o}from\"../../../core/watchUtils.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as l}from\"../../../core/accessorSupport/decorators/subclass.js\";import{hydrateGraphic as h}from\"../../../layers/graphics/hydratedFeatures.js\";import{FeatureTileController3D as p}from\"../../../layers/graphics/controllers/FeatureTileController3D.js\";import{getRenderingInfo as d,getRenderingInfoAsync as u}from\"../../../renderers/support/renderingInfoUtils.js\";import c from\"../../../rest/support/Query.js\";import g from\"./graphics/Graphics3DFeatureLikeLayerView.js\";import y from\"./graphics/QueryEngine.js\";import{toViewIfLocal as m}from\"./support/projectExtentUtils.js\";import{TaskPriority as f}from\"../../support/Scheduler.js\";const E=E=>{let b=class extends E{constructor(){super(...arguments),this.controller=null,this.updatePolicy=1,this.suspendResumeExtentMode=\"computed\",this.slicePlaneEnabled=!1,this.drapeSourceType=1,this.fullExtentInLocalViewSpatialReference=null,this.suspendResumeExtent=null,this._controllerCreated=!1,this.clippingExtent=null,this.supportsHeightUnitConversion=!0,this.pendingController=null,this.queryEngine=null}initialize(){const e=this.layer;\"isTable\"in e&&e.isTable?this.addResolvingPromise(Promise.reject(new t(\"featurelayerview:table-not-supported\",\"table feature layer can't be displayed\",{layer:e}))):(this._set(\"graphics3d\",new g({owner:this,layer:e,frustumVisibilityEnabled:!0,scaleVisibilityEnabled:!0,filterVisibilityEnabled:!0,timeExtentVisibilityEnabled:!0,elevationAlignmentEnabled:!0,elevationFeatureExpressionEnabled:!0,preferredUpdatePolicy:this.updatePolicy,suspendResumeExtentMode:this.suspendResumeExtentMode,updateClippingExtent:e=>this.updateClippingExtent(e)})),this.updatingHandles.add(this,\"updatePolicy\",(e=>this.graphics3d.graphicsCore.preferredUpdatePolicy=e)),this.updatingHandles.add(this,\"suspendResumeExtentMode\",(e=>{this.graphics3d.suspendResumeExtentMode=e})),this.addResolvingPromise(this.graphics3d.setup().then((()=>this.validateGeometryType())).then((()=>this.queryEngine=new y({layerView:this,priority:f.FEATURE_QUERY_ENGINE}))).then((()=>m(this))).then((e=>this.fullExtentInLocalViewSpatialReference=e)).then((()=>this.initializeController()))),this.notifyChange(\"updating\"))}destroy(){this.destroyPendingController(),this.controller=r(this.controller),this._set(\"graphics3d\",r(this.graphics3d)),this.queryEngine=r(this.queryEngine),this.loadedGraphics=null}destroyPendingController(){this.pendingController&&(this.pendingController.destroy(),this.pendingController=null)}get legendEnabled(){var e,t;return this.canResume()&&!(null!=(e=this.graphics3d)&&null!=(t=e.frustumVisibility)&&t.suspended)}notifyGraphicGeometryChanged(e){this.graphics3d.graphicsCore.notifyGraphicGeometryChanged(e)}notifyGraphicVisibilityChanged(e){this.graphics3d.graphicsCore.notifyGraphicVisibilityChanged(e)}getRenderingInfo(e,t,r){const s=d(e,{renderer:t,arcade:r});if(i(s)&&s.color){const e=s.color;e[0]=e[0]/255,e[1]=e[1]/255,e[2]=e[2]/255}return s}async getRenderingInfoAsync(e,t,r,i){return u(e,{renderer:t,arcade:r,...i})}getGraphicFromGraphicUid(e){var t;let r=null;return null==(t=this.loadedGraphics)||t.forEach((t=>{t.uid===e&&(r=h(t,this.layer))})),r}get graphics3DGraphics(){return this.graphics3d?this.graphics3d.graphicsCore.graphics3DGraphics:null}get graphics3DGraphicsByObjectID(){return this.graphics3d?this.graphics3d.graphicsCore.graphics3DGraphicsByObjectID:null}get symbolUpdateType(){return this.graphics3d?this.graphics3d.graphicsCore.symbolUpdateType:null}whenGraphicBounds(e,t){return this.graphics3d?this.graphics3d.graphicsCore.whenGraphicBounds(e,t):null}computeAttachmentOrigin(e,t){return this.graphics3d?this.graphics3d.graphicsCore.computeAttachmentOrigin(e,t):null}getSymbolLayerSize(e,t){return this.graphics3d?this.graphics3d.graphicsCore.getSymbolLayerSize(e,t):null}queryFeatures(e,t){return this.queryEngine.executeQuery(this._ensureQuery(e),s(t,\"signal\"))}queryObjectIds(e,t){return this.queryEngine.executeQueryForIds(this._ensureQuery(e),s(t,\"signal\"))}queryFeatureCount(e,t){return this.queryEngine.executeQueryForCount(this._ensureQuery(e),s(t,\"signal\"))}queryExtent(e,t){return this.queryEngine.executeQueryForExtent(this._ensureQuery(e),s(t,\"signal\"))}_ensureQuery(e){return n(e)?this.createQuery():c.from(e)}highlight(e){return this.graphics3d.highlight(e,this.layer.objectIdField)}maskOccludee(e){return this.graphics3d.maskOccludee(e)}canResume(){return super.canResume()&&(!this.graphics3d||!this.graphics3d.suspended)}getSuspendInfo(){const e=super.getSuspendInfo();return this.graphics3d?{...e,...this.graphics3d.suspendInfo}:e}isUpdating(){var e,t;return!(!this.graphics3d||this.graphics3d.destroyed)&&!(this._controllerCreated&&(null==(e=this.controller)||!e.updating)&&null!=(t=this.view.basemapTerrain)&&t.ready&&!this.graphics3d.updating)}async initializeController(){const e=this.createController();this.pendingController=e,await e.when(),this.setControllerWhenInitialized(e)}async setControllerWhenInitialized(e){try{await this.when()}catch(t){}this._controllerCreated=!0,this.notifyChange(\"updating\"),this.isResolved()&&!this.destroyed?(await o(this.view,\"basemapTerrain.ready\"),this.beforeSetController(e),this.pendingController=null,this.controller=e,this.loadedGraphics=e.graphics,this.notifyChange(\"updating\")):this.destroyPendingController()}updateClippingExtent(e){if(this.clippingExtent=e,!this.controller)return!1;switch(this.controller.type){case\"stream\":return!1;case\"feature-tile-3d\":return this.controller.extent=e,!0}}validateGeometryType(){switch(this.layer.geometryType){case\"multipatch\":case\"multipoint\":return Promise.reject(new t(\"featurelayerview3d:unsupported-geometry-type\",\"Unsupported geometry type ${geometryType}\",{geometryType:this.layer.geometryType}))}}_getResourceInfo(){const e=this.controller&&this.controller instanceof p?this.controller:null;return{displayedNumberOfFeatures:this.loadedGraphics.length,maximumNumberOfFeatures:e?e.maximumNumberOfFeatures:-1,totalNumberOfFeatures:e?e.serviceDataCount:-1,nodes:0,core:this.graphics3d.graphicsCore.performanceInfo,elevationUpdating:this.graphics3d.elevationAlignment.updating,visibilityFrustum:!this.graphics3d.frustumVisibility.suspended,visibilityScale:!this.graphics3d.scaleVisibility.suspended}}get performanceInfo(){return this._getResourceInfo()}};return e([a()],b.prototype,\"loadedGraphics\",void 0),e([a()],b.prototype,\"suspended\",void 0),e([a({readOnly:!0})],b.prototype,\"legendEnabled\",null),e([a()],b.prototype,\"updating\",void 0),e([a()],b.prototype,\"controller\",void 0),e([a()],b.prototype,\"graphics3d\",void 0),e([a({readOnly:!0})],b.prototype,\"updatePolicy\",void 0),e([a({readOnly:!0})],b.prototype,\"suspendResumeExtentMode\",void 0),e([a({type:Boolean})],b.prototype,\"slicePlaneEnabled\",void 0),e([a({readOnly:!0})],b.prototype,\"suspendInfo\",void 0),b=e([l(\"esri.views.3d.layers.FeatureLikeLayerView3D\")],b),b};export{E as FeatureLikeLayerView3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Evented.js\";import{someSet as t}from\"../../../core/SetUtils.js\";class s extends e{constructor(){super(...arguments),this._set=new Set}clear(){if(this._set.size>0){const e=this.toArray();this._set.clear(),this.emit(\"after-changes\",{type:2}),this.emit(\"change\",{added:[],removed:e})}}get length(){return this._set.size}addMany(e){if(0!==e.length){for(const t of e)this._set.add(t);this.emit(\"after-changes\",{type:1}),this.emit(\"change\",{added:e,removed:[]})}}remove(e){this._set.delete(e)&&(this.emit(\"after-changes\",{type:2}),this.emit(\"change\",{added:[],removed:[e]}))}removeMany(e){const t=[];for(const s of e)this._set.delete(s)&&t.push(s);t.length>0&&(this.emit(\"after-changes\",{type:2}),this.emit(\"change\",{added:[],removed:t}))}toArray(){return[...this._set]}find(e){let s;return t(this._set,(t=>!!e(t)&&(s=t,!0))),s}forEach(e){this._set.forEach((t=>e(t)))}}export{s as EventedSet};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../Graphic.js\";import{isSome as r}from\"../../../core/maybe.js\";import{WorkerHandle as o}from\"../../../core/workers/WorkerHandle.js\";import t from\"../../../geometry/SpatialReference.js\";import s from\"../../../layers/support/Field.js\";class i{constructor(e){this._schedule=e,this._handle=new n(e)}destroy(){this._handle.destroy()}invoke(o,i){return o.buffer&&0!==o.buffer.byteLength?(o.options.sourceSpatialReference&&o.options.sourceSpatialReference instanceof t&&(o.options={...o.options,sourceSpatialReference:o.options.sourceSpatialReference.toJSON()}),this._handle.invoke(o,i).then((o=>this._schedule((()=>{if(o.spatialReference=t.fromJSON(o.spatialReference),o.fields)for(let e=0;e<o.fields.length;e++)o.fields[e]=s.fromJSON(o.fields[e]);const i=o.spatialReference;for(const t of o.features)t.uid=e.generateUID(),r(t.geometry)&&(t.geometry.spatialReference=i);return o}))))):Promise.resolve(null)}}class n extends o{constructor(e){super(\"PBFDecoderWorker\",\"_parseFeatureQuery\",e)}getTransferList(e){return[e.buffer]}}export{i as PBFDecoder};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import r from\"../../../../core/Accessor.js\";import{isSome as t,isNone as s,destroyMaybe as o}from\"../../../../core/maybe.js\";import{throwIfAborted as u,createAbortError as a}from\"../../../../core/promiseUtils.js\";import{property as y}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as i}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{fromFeatureSetJSON as p}from\"../../../../layers/graphics/dehydratedFeatures.js\";import{runQuery as l,executeQuery as n}from\"../../../../rest/query/operations/query.js\";import{PBFDecoder as c}from\"../../support/PBFDecoder.js\";let d=class extends r{constructor(e){super(e)}get queryFeaturesDehydrated(){const e=this.layer.capabilities,r=e&&e.query;if(r&&r.supportsFormatPBF){var o,y;s(this._decoder)&&(this._decoder=new c(this.schedule));const e={sourceSpatialReference:null!=(o=null==(y=this.layer.spatialReference)?void 0:y.toJSON())?o:null,applyTransform:!0,maxStringAttributeLength:1024};return(r,s)=>l(this.layer.parsedUrl,r,\"pbf\",this._createRequestOptions(s)).then((r=>(u(s),t(this._decoder)?this._decoder.invoke({buffer:r.data,options:e},s.signal):Promise.reject(a()))))}return(e,r)=>n(this.layer.parsedUrl,e,this.layer.spatialReference,this._createRequestOptions(r)).then((e=>p(e.data)))}queryFeatureCount(e,r){return this.layer.queryFeatureCount(e,r)}destroy(){this._decoder=o(this._decoder)}_createRequestOptions(e){return{...e,query:{...this.layer.customParameters,token:this.layer.apiKey,...null==e?void 0:e.query}}}};e([y({constructOnly:!0})],d.prototype,\"layer\",void 0),e([y({constructOnly:!0})],d.prototype,\"schedule\",void 0),e([y({readOnly:!0})],d.prototype,\"queryFeaturesDehydrated\",null),d=e([i(\"esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceQuery3D\")],d);let h=class extends r{constructor(e){super(e)}queryFeaturesDehydrated(e,r){return this.layer.queryFeatures(e,r)}queryFeatureCount(e,r){return this.layer.queryFeatureCount(e,r)}};e([y({constructOnly:!0})],h.prototype,\"layer\",void 0),e([y({readOnly:!0})],h.prototype,\"queryFeaturesDehydrated\",null),h=e([i(\"esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceMeshQuery3D\")],h);let m=class extends r{constructor(e){super(e)}queryFeaturesDehydrated(e,r){return this.layer.queryFeatures(e,r)}};e([y({constructOnly:!0})],m.prototype,\"layer\",void 0),m=e([i(\"esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceQuery3D\")],m);let f=class extends r{constructor(e){super(e)}queryFeaturesDehydrated(e,r){return this.source.queryFeaturesJSON(e,r).then(p,(t=>{if(t&&\"query-features-json:unsupported\"===t.name)return this.layer.queryFeatures(e,r);throw t}))}queryFeatureCount(e,r){return this.layer.queryFeatureCount(e,r)}};function q(e,r){return\"feature\"===e.type&&\"feature-layer\"===e.source.type?t(e.infoFor3D)?new h({layer:e}):new d({layer:e,schedule:r}):\"feature\"===e.type&&\"memory\"===e.source.type||\"csv\"===e.type||\"geojson\"===e.type||\"wfs\"===e.type?new f({layer:e,source:e.source}):\"ogc-feature\"===e.type?new m({layer:e}):null}e([y({constructOnly:!0})],f.prototype,\"layer\",void 0),e([y({constructOnly:!0})],f.prototype,\"source\",void 0),f=e([i(\"esri.views.3d.layers.support.featureTileQuery3D.FeatureTileClientQuery3D\")],f);export{q as createFeatureTileQuery3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{destroyMaybe as e,isSome as r}from\"../../../../core/maybe.js\";import{contextCapabilitiesFromLayer as t}from\"./FeatureTileFetcher3D.js\";import{createFeatureTileQuery3D as i}from\"./featureTileQuery3D.js\";class l{constructor(e){this._memoryCache=null,this._capabilities=null;const r=e.layerView.layer;this.layerView=e.layerView,this.objectIdField=r.objectIdField,this.globalIdField=\"globalIdField\"in r?r.globalIdField:null,this.returnZ=e.returnZ,this.returnM=e.returnM;const t=this.layerView.view.resourceController;this.query=i(r,(e=>t.schedule(e))),t&&this.memoryCacheEnabled&&(this._memoryCache=t.memoryController.getMemCache(r.uid))}get memoryCacheEnabled(){switch(this.layerView.layer.source.type){case\"feature-layer\":case\"ogc-feature\":return!0;case\"csv\":case\"geojson\":case\"memory\":case\"wfs\":return!1}}destroy(){this._memoryCache=e(this._memoryCache),this.query.destroy()}createQuery(){const e=this.layerView.layer.createQuery();return e.outFields=this.layerView.availableFields,e.returnZ=this.returnZ,e.returnM=this.returnM,e.outSpatialReference=this.tilingScheme.spatialReference,e}get memoryCache(){return this._memoryCache}get viewingMode(){return this.layerView.view.state.viewingMode}get tilingScheme(){return this.layerView.view.featureTiles.tilingScheme}get scheduler(){const e=this.layerView.view.resourceController;return e?e.scheduler:null}get geometryType(){return this.layerView.layer.geometryType}get fullExtent(){return this.layerView.layer.fullExtent}get tileMaxRecordCount(){return this.layerView.layer.capabilities.query.tileMaxRecordCount}get maxRecordCount(){return this.layerView.layer.capabilities.query.maxRecordCount}get capabilities(){return r(this._capabilities)||(this._capabilities=t(this.layerView.layer)),this._capabilities}logFetchError(e,r){e.error(\"#fetchTile()\",this.layerView.layer,r&&r.message?r.message:r)}}export{l as FeatureTileFetcher3DLayerViewContext};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{JSONSupport as t}from\"../../../core/JSONSupport.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import s from\"./FeatureFilter.js\";var i;let c=i=class extends t{constructor(){super(...arguments),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}clone(){return new i({filter:this.filter&&this.filter.clone(),includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};e([r({type:s,json:{write:!0}})],c.prototype,\"filter\",void 0),e([r({json:{write:!0}})],c.prototype,\"includedEffect\",void 0),e([r({json:{write:!0}})],c.prototype,\"excludedEffect\",void 0),e([r({type:Boolean,json:{write:!0}})],c.prototype,\"excludedLabelsVisible\",void 0),c=i=e([o(\"esri.views.layers.support.FeatureEffect\")],c);var l=c;export default l;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../core/Error.js\";import r from\"../../core/Logger.js\";import{isSome as i,isNone as s}from\"../../core/maybe.js\";import{eachAlways as o}from\"../../core/promiseUtils.js\";import{init as n,on as l}from\"../../core/watchUtils.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as u}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as p}from\"../../layers/support/commonProperties.js\";import{fixFields as d,unpackFieldNames as m,collectLabelingFields as c,collectElevationFields as f,collectFilterFields as y,collectFeatureReductionFields as h,collectFields as F,collectField as w,featureHasFields as g}from\"../../layers/support/fieldUtils.js\";import x from\"../../rest/support/Query.js\";import{loadArcade as b}from\"../../support/arcadeOnDemand.js\";import E from\"./support/FeatureEffect.js\";import v from\"./support/FeatureFilter.js\";import{getFetchPopupTemplate as q,getRequiredFields as j}from\"./support/popupUtils.js\";const I=r.getLogger(\"esri.views.layers.FeatureLayerView\"),R=r=>{let R=class extends r{constructor(...e){super(...e),this._updatingRequiredFieldsPromise=null,this.effect=null,this.filter=null,this.timeExtent=null,this.layer=null,this.requiredFields=[],this.view=null}initialize(){n(this,[\"layer.renderer\",\"layer.labelingInfo\",\"layer.elevationInfo.featureExpressionInfo\",\"layer.displayField\",\"filter\",\"effect\",\"layer.timeInfo\",\"layer.floorInfo\",\"timeExtent\"],(()=>this._handleRequiredFieldsChange()),!0),l(this,\"view.floors\",\"change\",(()=>this._handleRequiredFieldsChange())),l(this,\"layer.sublayer\",\"change\",(()=>this._handleRequiredFieldsChange()))}get availableFields(){const{layer:e,layer:{fieldsIndex:t},requiredFields:r}=this;return\"outFields\"in e&&e.outFields?d(t,[...m(t,e.outFields),...r]):d(t,r)}get maximumNumberOfFeatures(){return 0}set maximumNumberOfFeatures(e){I.error(\"#maximumNumberOfFeatures=\",\"Setting maximum number of features is not supported\")}get maximumNumberOfFeaturesExceeded(){return!1}highlight(e){throw new Error(\"missing implementation\")}createQuery(){const e={outFields:[\"*\"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},t=i(this.filter)?this.filter.createQuery(e):new x(e);return i(this.timeExtent)&&(t.timeExtent=i(t.timeExtent)?t.timeExtent.intersection(this.timeExtent):this.timeExtent.clone()),t}queryFeatures(e,t){throw new Error(\"missing implementation\")}queryObjectIds(e,t){throw new Error(\"missing implementation\")}queryFeatureCount(e,t){throw new Error(\"missing implementation\")}queryExtent(e,t){throw new Error(\"missing implementation\")}_loadArcadeModules(e){if(e.get(\"expressionInfos.length\"))return b()}_handleRequiredFieldsChange(){const e=this._updateRequiredFields();this._set(\"_updatingRequiredFieldsPromise\",e),e.then((()=>{this._updatingRequiredFieldsPromise===e&&this._set(\"_updatingRequiredFieldsPromise\",null)}))}async _updateRequiredFields(){if(!this.layer||!this.view)return;const e=\"3d\"===this.view.type,{layer:t,layer:{fieldsIndex:r,objectIdField:s}}=this,n=\"renderer\"in t&&t.renderer,l=t.featureReduction,a=new Set,u=await o([n?n.collectRequiredFields(a,r):null,c(a,t),e?f(a,t):null,i(this.filter)?y(a,t,this.filter):null,this.effect?y(a,t,this.effect.filter):null,l?h(a,t,l):null]);if(t.timeInfo&&this.timeExtent&&F(a,t.fieldsIndex,[t.timeInfo.startField,t.timeInfo.endField]),\"feature\"===t.type&&t.floorInfo&&F(a,t.fieldsIndex,[t.floorInfo.floorField]),\"subtype-group\"===t.type){w(a,r,t.subtypeField);const e=t.sublayers.map((e=>{var t;return Promise.all([null==(t=e.renderer)?void 0:t.collectRequiredFields(a,r),c(a,e)])}));await o(e)}for(const i of u)i.error&&I.error(i.error);w(a,r,s),e&&\"displayField\"in t&&t.displayField&&w(a,r,t.displayField);const p=Array.from(a).sort();this._set(\"requiredFields\",p)}validateFetchPopupFeatures(e){if(s(e))return null;for(const r of e.clientGraphics){const i=r.layer;if(\"popupEnabled\"in i&&!i.popupEnabled)return new t(\"featurelayerview:fetchPopupFeatures\",\"Popups are disabled\",{layer:i});if(\"popupTemplate\"in i){if(!q(i,e))return new t(\"featurelayerview:fetchPopupFeatures\",\"Layer does not define a popup template\",{layer:i})}}}async fetchClientPopupFeatures(e){const t=i(e)?e.clientGraphics:null;if(!t||0===t.length)return Promise.resolve([]);const r=[],s=[],o=await this.createPopupQuery(e);for(const n of t){const{layer:t}=n;if(!(\"popupEnabled\"in t))continue;const l=m(this.layer.fieldsIndex,o.outFields),a=q(t,e);if(!i(a))continue;const u=await this._loadArcadeModules(a);u&&u.arcadeUtils.hasGeometryOperations(a)||!g(l,n)?s.push(n):r.push(n)}return\"stream\"===this.layer.type||0===s.length?Promise.resolve(r):(o.objectIds=s.map((e=>e.attributes[this.layer.objectIdField])),this.layer.queryFeatures(o).then((e=>r.concat(e.features))).catch((()=>s)))}async createPopupQuery(e){const t=this.layer.createQuery(),r=new Set;let s=!1;const o=i(e)&&e.clientGraphics?e.clientGraphics.map((e=>e.layer)):[this.layer];for(const n of o){if(!(\"popupEnabled\"in n))continue;const t=q(n,e);if(!i(t))continue;const o=await this._loadArcadeModules(t),l=o&&o.arcadeUtils.hasGeometryOperations(t);s=!(\"point\"!==this.layer.geometryType&&!l);const a=await j(this.layer,t);for(const e of a)r.add(e)}return t.returnGeometry=s,t.returnZ=s,t.returnM=s,t.outFields=Array.from(r),t.outSpatialReference=this.view.spatialReference,t}canResume(){return!!super.canResume()&&(!i(this.timeExtent)||!this.timeExtent.isEmpty)}};return e([a()],R.prototype,\"_updatingRequiredFieldsPromise\",void 0),e([a({readOnly:!0})],R.prototype,\"availableFields\",null),e([a({type:E})],R.prototype,\"effect\",void 0),e([a({type:v})],R.prototype,\"filter\",void 0),e([a(p)],R.prototype,\"timeExtent\",void 0),e([a()],R.prototype,\"layer\",void 0),e([a({type:Number})],R.prototype,\"maximumNumberOfFeatures\",null),e([a({readOnly:!0,type:Boolean})],R.prototype,\"maximumNumberOfFeaturesExceeded\",null),e([a({readOnly:!0})],R.prototype,\"requiredFields\",void 0),e([a()],R.prototype,\"suspended\",void 0),e([a()],R.prototype,\"view\",void 0),R=e([u(\"esri.views.layers.FeatureLayerView\")],R),R};export default R;export{R as FeatureLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{isSome as r}from\"../../../core/maybe.js\";import{init as s,whenFalse as i}from\"../../../core/watchUtils.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{hydrateGeometry as l}from\"../../../layers/graphics/hydratedFeatures.js\";import{FeatureTileController3D as u}from\"../../../layers/graphics/controllers/FeatureTileController3D.js\";import{FeatureLikeLayerView3D as n}from\"./FeatureLikeLayerView3D.js\";import{LayerView3D as c}from\"./LayerView3D.js\";import{FeatureTileFetcher3DLayerViewContext as p}from\"./support/FeatureTileFetcher3DLayerViewContext.js\";import{EventedSet as h}from\"../support/EventedSet.js\";import{updatingProgress as m}from\"../support/updatingProperties.js\";import{FeatureLayerView as d}from\"../../layers/FeatureLayerView.js\";import y from\"../../layers/LayerView.js\";import{RefreshableLayerView as g}from\"../../layers/RefreshableLayerView.js\";let f=class extends(g(n(d(c(y))))){constructor(e){super(e),this._controllerTotal=0,this._graphicsCoreTotal=0,this.suspendResumeExtentMode=\"data\"}initialize(){this.updatingHandles.add(this,\"view.floors\",(()=>this.graphics3d.filterVisibility.filterChanged()))}destroy(){this.fetcherContext&&(this.fetcherContext.destroy(),this.fetcherContext=null)}get maximumNumberOfFeatures(){var e,t;return null!=(e=null==(t=this.controller)?void 0:t.maximumNumberOfFeatures)?e:this._get(\"maximumNumberOfFeatures\")}set maximumNumberOfFeatures(e){this._set(\"maximumNumberOfFeatures\",e),this.controller&&(this.controller.maximumNumberOfFeatures=e)}get maximumNumberOfFeaturesExceeded(){return!!this.controller&&!(this.suspended||!this.controller.maximumNumberOfFeaturesExceeded)}get updatingProgressValue(){var e,t,r;let s=0;if(null!=(e=this.controller)&&e.updating){const e=this.controller.updatingRemaining,t=Math.max(this.controller.updatingTotal,this._controllerTotal);t>0&&(s=(t-e)/t,this._controllerTotal=t)}let i=0;if(null!=(t=this.graphics3d)&&null!=(r=t.graphicsCore)&&r.updating){const e=this.graphics3d.graphicsCore.updatingRemaining,t=Math.max(e,this._graphicsCoreTotal);t>0&&(i=(t-e)/t,this._graphicsCoreTotal=t)}return.5*(s+i)}get updatePolicy(){if(!this.controller)return 0;switch(this.controller.mode){case\"snapshot\":{const e=F[this.layer.geometryType];return null==e||this.controller.serviceDataCount>e?0:1}case\"tiles\":return 0}}get hasZ(){const e=this.layer,t=e.capabilities&&e.capabilities.data;return!(!t||!t.supportsZ)&&(\"returnZ\"in e&&null!=e.returnZ?e.returnZ:t.supportsZ)}get hasM(){const e=this.layer,t=e.capabilities&&e.capabilities.data;return!(!t||!t.supportsM)&&(\"returnM\"in e&&null!=e.returnM&&e.returnM)}async fetchPopupFeatures(e,t){const r=this.validateFetchPopupFeatures(t);return r?Promise.reject(r):this.fetchClientPopupFeatures(t)}setVisibility(e,t){this.graphics3d&&this.graphics3d.graphicsCore.setObjectIdVisibility(e,t)}createQuery(){return super.createQuery()}queryFeatures(e,t){const r=()=>super.queryFeatures(e,t);return\"mesh\"===this.layer.geometryType?this._queryFeaturesMesh(this._ensureQuery(e),r):r()}beforeSetController(e){e.maximumNumberOfFeatures=this.maximumNumberOfFeatures}createController(){this.fetcherContext=new p({layerView:this,returnZ:this.hasZ,returnM:this.hasM});const e=new u({layerView:this,context:this.fetcherContext,graphics:new h,extent:this.clippingExtent});return this.updatingHandles.add(e,\"serviceDataExtent\",(e=>{this.graphics3d&&(this.graphics3d.dataExtent=e)}),2),this.handles.add(s(this,\"suspended\",(t=>{t?e.suspend():e.resume()}),!0)),this.updatingHandles.add(this.graphics3d.graphicsCore,\"displayFeatureLimit\",(()=>this.updateDisplayFeatureLimit(e)),2),this.handles.add([this.view.resourceController.memoryController.events.on(\"quality-changed\",(()=>this.updateDisplayFeatureLimit())),i(this,\"updating\",(()=>{this._controllerTotal=0,this._graphicsCoreTotal=0,this.notifyChange(\"updatingProgressValue\")}))]),e}async doRefresh(){!this.suspended&&this.controller&&this.controller.refetch()}getUsedMemory(){const e=this.graphics3d&&this.graphics3d.graphicsCore;return(e?e.usedMemory:0)+(this.controller?this.controller.memoryForUnusedFeatures:0)}getUnloadedMemory(){const e=this.graphics3d&&this.graphics3d.graphicsCore;return(e?e.unprocessedMemoryEstimate:0)+(this.controller?this.controller.expectedFeatureDiff*e.usedMemoryPerGraphic:0)}ignoresMemoryFactor(){return this.controller&&this.controller.hasMaximumNumberOfFeaturesOverride}updateDisplayFeatureLimit(e=this.controller){if(!e||!this.graphics3d||!this.graphics3d.graphicsCore)return;const t=this.graphics3d.graphicsCore.displayFeatureLimit,r=this.view.resourceController.memoryController.memoryFactor;if(1===r)e.displayFeatureLimit=t;else{const s=Math.ceil(t.maximumNumberOfFeatures*r),i=Math.ceil(t.maximumTotalNumberOfFeatures*r),o=Math.ceil(t.minimumTotalNumberOfFeatures*r);e.displayFeatureLimit={...t,maximumNumberOfFeatures:s,maximumTotalNumberOfFeatures:i,minimumTotalNumberOfFeatures:o}}}async _queryFeaturesMesh(e,t){await this._validateQueryFeaturesMesh(e);const r=await t();if(e&&e.outStatistics)return r;const s=this.layer.objectIdField,i=this.graphics3d.graphicsCore.graphics3DGraphicsByObjectID,o=[];for(const a of r.features)if(a.geometry){const e=i.get(a.attributes[s]);e&&(a.geometry=l(e.graphic.geometry),o.push(a))}else o.push(a);return r.features=o,r}async _validateQueryFeaturesMesh(e){if(!e)return;const s=e=>{throw new t(\"feature-layer-view:unsupported-query\",`Queries on Mesh feature collection layers do not support '${e}'`)},i=[\"quantizationParameters\",\"geometryPrecision\",\"maxAllowableOffset\"];for(const t of i)null!=e[t]&&s(t);\"returnM\"in e&&e.returnM&&s(\"returnM\"),\"returnCentroid\"in e&&e.returnCentroid&&s(\"returnCentroid\"),r(e.outSpatialReference)&&!e.outSpatialReference.equals(this.view.spatialReference)&&s(\"outSpatialReference\")}get performanceInfo(){const e=this.controller&&this.controller.displayFeatureLimit,t=r(e)&&e.averageSymbolComplexity,s=r(t)?`f:${t.primitivesPerFeature},v:${t.primitivesPerCoordinate}`:\"n/a\",i={...this._getResourceInfo(),storedFeatures:0,totalVertices:0,partial:this.maximumNumberOfFeaturesExceeded,mode:this.controller?this.controller.mode:\"n/a\",symbolComplexity:s,nodes:this.controller?this.controller.tileDescriptors.length:0};if(this.controller&&i.displayedNumberOfFeatures){const e=this.controller.debug;i.storedFeatures=e.storedFeatures,i.totalVertices=e.totalVertices}return i}get test(){return{updatePolicy:this.updatePolicy,controller:this.controller}}};e([o()],f.prototype,\"layer\",void 0),e([o()],f.prototype,\"controller\",void 0),e([o()],f.prototype,\"maximumNumberOfFeatures\",null),e([o()],f.prototype,\"maximumNumberOfFeaturesExceeded\",null),e([o(m)],f.prototype,\"updatingProgress\",void 0),e([o({readOnly:!0,dependsOn:[\"controller.updatingRemaining\",\"controller.updatingTotal\",\"graphics3d.graphicsCore.updatingRemaining\"]})],f.prototype,\"updatingProgressValue\",null),e([o({readOnly:!0})],f.prototype,\"updatePolicy\",null),e([o({readOnly:!0})],f.prototype,\"hasZ\",null),e([o({readOnly:!0})],f.prototype,\"hasM\",null),e([o()],f.prototype,\"suspendResumeExtentMode\",void 0),f=e([a(\"esri.views.3d.layers.FeatureLayerViewBase3D\")],f);const F={point:5e3,polygon:500,polyline:1e3};var x=f;export default x;\n"],"sourceRoot":""}