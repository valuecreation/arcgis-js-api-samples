{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightAnalysis.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightResult.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightController.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightConfiguration.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightLayerViewData.js","../node_modules/@arcgis/core/views/3d/layers/analysis/LineOfSight/LineOfSightView.js","../node_modules/@arcgis/core/views/3d/layers/LineOfSightLayerView3D.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/Object3DVisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/LineVisualElement.js"],"names":["i","s","constructor","t","super","this","inputPoints","isValid","observer","r","target","observerAdjusted","targetAdjusted","computationResult","start","end","intersection","isTargetVisible","result","updateComputationResults","notifyChange","updateInputPoints","o","prototype","e","V","_tasks","w","_handles","_analysisHandles","initialize","view","resourceController","scheduler","registerTask","S","LINE_OF_SIGHT_TOOL","add","d","layer","_onObserverChange","_connectAnalyses","_connectTargets","_intersector","I","state","viewingMode","options","hud","store","destroy","_analyses","removeAll","updating","priority","layerViewData","analyses","observerEngineLocation","camera","computeScreenPixelSizeAt","_observerEngineLocation","getLineOfSightComputationDependencies","computeAnalysis","analysis","n","a","l","y","_canComputeAnalysis","_computeAnalysisIntersection","_interpolateAnalysisIntersection","_adjustStartEndPositions","_screenPixelSize","R","_","c","m","v","Math","min","f","p","interpolationInfo","sceneIntersectionHelper","renderCoordsHelper","h","u","g","C","H","intersectToolIntersectorRay","results","getIntersectionPoint","originalIntersection","originalObserver","originalTarget","fromRenderCoords","spatialReference","A","P","E","intersectedGraphic","L","intersectedLocation","visible","b","frustum","intersectsPoint","targets","T","toRenderCoords","LINE_OF_SIGHT_TOOL_INTERACTIVE","_onObserverChangeForAnalysis","_onObserverEngineForAnalysis","_onTargetLocationChange","_connectAnalysisToTarget","_connectAnalysisToObserver","_connectAnalysisToObserverEngine","_connectAnalysisForCompute","async","schedule","_connectAnalysis","has","_disconnectAnalysis","remove","_onAnalysesCollectionChange","added","forEach","removed","_onTargetsChange","items","length","_addTarget","on","_onTargetCollectionChange","_removeTarget","some","j","find","constructOnly","O","innerWidth","outerWidth","visibleInnerColor","visibleOuterColor","occludedInnerColor","occludedOuterColor","undefinedInnerColor","undefinedOuterColor","type","Number","arguments","configuration","_handle","createLineOfSightVisualization","_configuration","attached","width","visibleLineVisualElement","color","toUnitRGBA","innerColor","occludedLineVisualElement","undefinedLineVisualElement","destroyLineOfSightVisualization","updateLineOfSightVisualization","geometry","transform","getLineOfSightVisualizationDependencies","moved","_layerViewData","_analysisController","_analysisView","map","getResultForTarget","isUpdating","readOnly","_resources","_transform","object","transformation","recreate","createResources","recreateGeometry","_stage","removeMany","geometries","removeAllGeometries","createGeometries","setVisible","addMany","destroyResources","isPickable","updatePolicy","castShadow","createExternalResources","forEachExternalMaterial","dispose","destroyExternalResources","updateVisibility","_attached","_resourcesCreated","_visible","watch","_createResources","_destroyResources","applyProps","console","error","_renderOccluded","_width","_color","_innerWidth","_innerColor","_stipplePattern","_stippleOffColor","_stippleIntegerRepeats","_writeDepthEnabled","_falloff","_polygonOffset","setGeometryFromExtent","push","setGeometryFromFrustum","lines","origin","endpoint","setGeometryFromBoundedPlane","basis1","basis2","setGeometryFromSegment","endRenderSpace","points","createRenderGeometry","setGeometryFromSegments","_updateMaterial","_geometry","_material","materialParameters","_createLineGeometries","addGeometry","stippleOffColor","stipplePattern","isClosed","falloff","stippleIntegerRepeats","polygonOffset","renderOccluded","writeDepth","setParameterValues","Float64Array","attributeData","position","removeDuplicateStartEnd"],"mappings":"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","file":"static/js/79.e7444b09.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../../chunks/tslib.es6.js\";import s from\"../../../../../core/Accessor.js\";import{property as o}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as e}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{c as r}from\"../../../../../chunks/vec3f64.js\";let i=class extends s{constructor(t){super(t),this.inputPoints={isValid:!1,observer:r(),target:r(),observerAdjusted:r(),targetAdjusted:r()},this.computationResult={start:r(),end:r(),intersection:r(),isValid:!1,isTargetVisible:!1},this.result=null}updateComputationResults(){this.notifyChange(\"computationResult\")}updateInputPoints(){this.notifyChange(\"inputPoints\")}};t([o()],i.prototype,\"target\",void 0),t([o()],i.prototype,\"inputPoints\",void 0),t([o()],i.prototype,\"computationResult\",void 0),t([o()],i.prototype,\"result\",void 0),i=t([e(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightAnalysis\")],i);export{i as LineOfSightAnalysis};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../../../chunks/tslib.es6.js\";import r from\"../../../../../core/Accessor.js\";import{property as e}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as s}from\"../../../../../core/accessorSupport/decorators/subclass.js\";let t=class extends r{constructor(o){super(o)}};o([e()],t.prototype,\"target\",void 0),o([e()],t.prototype,\"intersectedGraphic\",void 0),o([e()],t.prototype,\"intersectedLocation\",void 0),o([e()],t.prototype,\"visible\",void 0),t=o([s(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightResult\")],t);export{t as LineOfSightResult};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../geometry.js\";import t from\"../../../../../core/Accessor.js\";import s from\"../../../../../core/Handles.js\";import{handlesGroup as n,makeHandle as r}from\"../../../../../core/handleUtils.js\";import{isNone as i,isSome as o,abortMaybe as a,removeMaybe as l,none as c}from\"../../../../../core/maybe.js\";import{createTask as p,ignoreAbortErrors as h}from\"../../../../../core/promiseUtils.js\";import{property as u}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as g}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{reactionInit as d}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{g as y,f as _,n as m,a as v,b as f,j as A,w as b}from\"../../../../../chunks/vec3.js\";import{c as T}from\"../../../../../chunks/vec3f64.js\";import{fromPoints as C,create as O}from\"../../../../../geometry/support/ray.js\";import{LineOfSightAnalysis as j}from\"./LineOfSightAnalysis.js\";import{LineOfSightResult as E}from\"./LineOfSightResult.js\";import{Intersector as I}from\"../../../webgl-engine/lib/Intersector.js\";import{toGraphic as L}from\"../../../webgl-engine/lib/intersectorUtilsConversions.js\";import{ImmediateTask as w,TaskPriority as S}from\"../../../../support/Scheduler.js\";import P from\"../../../../../geometry/Point.js\";let V=class extends t{constructor(e){super(e),this._tasks=w,this._handles=new s,this._analysisHandles=new s}initialize(){var e;const t=null==(e=this.view.resourceController)?void 0:e.scheduler;t&&(this._tasks=t.registerTask(S.LINE_OF_SIGHT_TOOL));this._handles.add([d((()=>this.layer.observer),(e=>this._onObserverChange(e))),this._connectAnalyses(),this._connectTargets()]),this._intersector=new I(this.view.state.viewingMode),this._intersector.options.hud=!1,this._intersector.options.store=0}destroy(){this._handles.destroy(),this._analysisHandles.destroy(),this._analyses.removeAll()}get updating(){return this._tasks.updating}get priority(){return this._tasks.priority}set priority(e){this._tasks.priority=e}get _analyses(){return this.layerViewData.analyses}get _observerEngineLocation(){return this.layerViewData.observerEngineLocation}set _observerEngineLocation(e){this.layerViewData.observerEngineLocation=e}get _screenPixelSize(){return this.view.state.camera.computeScreenPixelSizeAt(this._observerEngineLocation)}getLineOfSightComputationDependencies(e){const{inputPoints:t}=e;return{inputPoints:t}}computeAnalysis(e,t=!1){const{analysis:s}=e,{inputPoints:n,computationResult:r}=s,{observerAdjusted:i,targetAdjusted:o}=n,{start:a,end:l}=r;y(a,i),y(l,o);t||this._canComputeAnalysis(s)?this._computeAnalysisIntersection(e):this._interpolateAnalysisIntersection(e),s.updateComputationResults()}_adjustStartEndPositions(e){const t=this._screenPixelSize,s=this.view,{inputPoints:n}=e,{observer:r,target:i,observerAdjusted:o,targetAdjusted:a}=n,l=R;_(l,i,r);const c=t;m(l,l),v(l,l,Math.min(c,1)),f(o,r,l),_(l,r,i);const p=s.state.camera.computeScreenPixelSizeAt(i);m(l,l),v(l,l,Math.min(p,1)),f(a,i,l)}_computeAnalysisIntersection({analysis:e,interpolationInfo:t}){const{view:s}=this,{sceneIntersectionHelper:n,renderCoordsHelper:r}=s;if(i(n))return;const o=this._intersector,{computationResult:a,inputPoints:l}=e,{observer:c,target:p}=l,{start:h,end:u}=a,g=C(h,u,H);n.intersectToolIntersectorRay(g,o);const d=a.intersection,_=R,m=!!o.results.min&&o.results.min.getIntersectionPoint(d);let v=!0;if(m){y(t.originalIntersection,d),y(t.originalObserver,h),y(t.originalTarget,u),r.fromRenderCoords(d,_,s.spatialReference);const e=1-A(u,p)/A(h,p);v=A(c,d)>=e*A(c,p)}const f=new P(_,s.spatialReference);e.result=new E({target:e.target,intersectedGraphic:v?null:L(o.results.min,s),intersectedLocation:v?null:f,visible:!!m&&v}),a.isValid=l.isValid=!0,a.isTargetVisible=v}_interpolateAnalysisIntersection({analysis:e,interpolationInfo:t}){const{computationResult:s,inputPoints:n}=e,{start:r,end:i,intersection:o}=s,{originalIntersection:a,originalObserver:l,originalTarget:c}=t;if(y(o,a),n.isValid){const e=R,t=A(l,a)/A(l,c);b(e,r,l),v(e,e,1-t),f(o,o,e),b(e,i,c),v(e,e,t),f(o,o,e),s.isValid=!0}else e.result=null,s.isValid=!1,s.isTargetVisible=!1}_canComputeAnalysis(e){const t=this.layer.observer,s=this.view.frustum;if(i(t)||i(e.target)||i(s))return!1;const{observerAdjusted:n,targetAdjusted:r}=e.inputPoints,o=s.intersectsPoint(n),a=s.intersectsPoint(r);return o&&a}_onObserverChange(e){if(i(e))return void this.layer.targets.removeAll();const t=T();this.view.renderCoordsHelper.toRenderCoords(e,t),this._observerEngineLocation=t,this.priority=S.LINE_OF_SIGHT_TOOL_INTERACTIVE}_onObserverChangeForAnalysis(e){e.inputPoints.isValid=!1}_onObserverEngineForAnalysis(e,t){const{inputPoints:s}=e;y(s.observer,t),this._adjustStartEndPositions(e),e.updateInputPoints(),this.priority=S.LINE_OF_SIGHT_TOOL_INTERACTIVE}_onTargetLocationChange(e,t){const{inputPoints:s}=e;s.isValid=!1,this.view.renderCoordsHelper.toRenderCoords(t,s.target),this._adjustStartEndPositions(e),e.updateInputPoints(),this.priority=S.LINE_OF_SIGHT_TOOL_INTERACTIVE}_connectAnalysisToTarget(e){return d((()=>({analysis:e,target:e.target})),(({analysis:e,target:t})=>{o(t)&&this._onTargetLocationChange(e,t)}))}_connectAnalysisToObserver(e){return d((()=>({analysis:e,observer:this.layer.observer})),(({analysis:e})=>{this._onObserverChangeForAnalysis(e)}))}_connectAnalysisToObserverEngine(e){return d((()=>({analysis:e,observer:this._observerEngineLocation})),(({analysis:e,observer:t})=>{this._onObserverEngineForAnalysis(e,t)}))}_connectAnalysisForCompute(e){let t=c;const s={analysis:e,interpolationInfo:{originalIntersection:T(),originalObserver:T(),originalTarget:T()}};return n([d((()=>this.getLineOfSightComputationDependencies(e)),(()=>{t=a(t),t=p((async e=>{await h(this._tasks.schedule((()=>this.computeAnalysis(s)),e))}))})),r((()=>t=a(t)))])}_connectAnalysis(e){const t=this._analysisHandles;t.has(e)||t.add([this._connectAnalysisToTarget(e),this._connectAnalysisToObserver(e),this._connectAnalysisToObserverEngine(e),this._connectAnalysisForCompute(e)])}_disconnectAnalysis(e){this._analysisHandles.remove(e)}_onAnalysesCollectionChange(e){e.added.forEach((e=>this._connectAnalysis(e))),e.removed.forEach((e=>this._disconnectAnalysis(e)))}_onTargetsChange(e){return this._analyses.removeAll(),e.items.length>0&&e.forEach((e=>this._addTarget(e))),e.on(\"change\",(e=>this._onTargetCollectionChange(e)))}_onTargetCollectionChange(e){e.added.forEach((e=>this._addTarget(e))),e.removed.forEach((e=>this._removeTarget(e)))}_addTarget(e){const t=this._analyses;t.some((t=>t.target===e))||t.add(new j({target:e}))}_removeTarget(e){const t=this._analyses,s=t.find((t=>t.target===e));t.remove(s)}_connectAnalyses(){let e=null;return n([d((()=>this._analyses),(t=>{e=l(e),e=t.on(\"change\",(e=>this._onAnalysesCollectionChange(e))),t.forEach((e=>this._connectAnalysis(e)))})),r((()=>e=l(e)))])}_connectTargets(){let e=null;return n([d((()=>this.layer.targets),(t=>{e=l(e),e=this._onTargetsChange(t)})),r((()=>e=l(e)))])}};e([u({constructOnly:!0})],V.prototype,\"layer\",void 0),e([u({constructOnly:!0})],V.prototype,\"layerViewData\",void 0),e([u({constructOnly:!0})],V.prototype,\"view\",void 0),e([u()],V.prototype,\"updating\",null),e([u()],V.prototype,\"priority\",null),e([u()],V.prototype,\"_analyses\",null),e([u()],V.prototype,\"_observerEngineLocation\",null),e([u()],V.prototype,\"_screenPixelSize\",null),e([u()],V.prototype,\"_tasks\",void 0),V=e([g(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightController\")],V);const R=T(),H=O();export{V as LineOfSightController};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../../../chunks/tslib.es6.js\";import e from\"../../../../../Color.js\";import r from\"../../../../../core/Accessor.js\";import{property as t}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as i}from\"../../../../../core/accessorSupport/decorators/subclass.js\";let s=class extends r{constructor(o){super(o),this.innerWidth=2,this.outerWidth=8,this.visibleInnerColor=new e([3,252,111,1]),this.visibleOuterColor=new e([3,252,111,.15]),this.occludedInnerColor=new e([252,3,69,1]),this.occludedOuterColor=new e([252,3,69,.1]),this.undefinedInnerColor=new e([255,255,255,1]),this.undefinedOuterColor=new e([127,127,127,.2])}};o([t({type:Number})],s.prototype,\"innerWidth\",void 0),o([t({type:Number})],s.prototype,\"outerWidth\",void 0),o([t({type:e})],s.prototype,\"visibleInnerColor\",void 0),o([t({type:e})],s.prototype,\"visibleOuterColor\",void 0),o([t({type:e})],s.prototype,\"occludedInnerColor\",void 0),o([t({type:e})],s.prototype,\"occludedOuterColor\",void 0),o([t({type:e})],s.prototype,\"undefinedInnerColor\",void 0),o([t({type:e})],s.prototype,\"undefinedOuterColor\",void 0),s=o([i(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightConfiguration\")],s);export{s as LineOfSightConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../../../chunks/tslib.es6.js\";import r from\"../../../../../core/Accessor.js\";import s from\"../../../../../core/Collection.js\";import{property as e}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as t}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{c as i}from\"../../../../../chunks/vec3f64.js\";import{LineOfSightConfiguration as c}from\"./LineOfSightConfiguration.js\";let p=class extends r{constructor(){super(...arguments),this.analyses=new s,this.configuration=new c,this.observerEngineLocation=i()}};o([e()],p.prototype,\"analyses\",void 0),o([e({type:c})],p.prototype,\"configuration\",void 0),o([e()],p.prototype,\"observerEngineLocation\",void 0),p=o([t(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightLayerViewData\")],p);export{p as LineOfSightLayerViewData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import i from\"../../../../../Color.js\";import t from\"../../../../../core/Accessor.js\";import o from\"../../../../../core/Handles.js\";import{makeHandle as n,handlesGroup as s}from\"../../../../../core/handleUtils.js\";import{removeMaybe as r,destroyMaybe as l}from\"../../../../../core/maybe.js\";import{property as a}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as c}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{reactionInit as u}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{c as d}from\"../../../../../chunks/mat4f64.js\";import{f as m}from\"../../../../../chunks/vec3.js\";import{d as h,c as p}from\"../../../../../chunks/vec3f64.js\";import{LineVisualElement as f}from\"../../../interactive/visualElements/LineVisualElement.js\";let y=class extends t{constructor(e){super(e),this._handle=null,this._analysisHandles=new o}initialize(){this._handle=this._connectAnalyses()}destroy(){this._handle=r(this._handle),this._analysisHandles=l(this._analysisHandles)}get _analyses(){return this.layerViewData.analyses}get _configuration(){return this.layerViewData.configuration}createLineOfSightVisualization(){const e=this._configuration,t={view:this.view,attached:!0,width:e.outerWidth,innerWidth:e.innerWidth};return{visibleLineVisualElement:new f({...t,color:i.toUnitRGBA(e.visibleOuterColor),innerColor:i.toUnitRGBA(e.visibleInnerColor)}),occludedLineVisualElement:new f({...t,color:i.toUnitRGBA(e.occludedOuterColor),innerColor:i.toUnitRGBA(e.occludedInnerColor)}),undefinedLineVisualElement:new f({...t,color:i.toUnitRGBA(e.undefinedOuterColor),innerColor:i.toUnitRGBA(e.undefinedInnerColor)})}}destroyLineOfSightVisualization(e){e.visibleLineVisualElement=l(e.visibleLineVisualElement),e.occludedLineVisualElement=l(e.occludedLineVisualElement),e.undefinedLineVisualElement=l(e.undefinedLineVisualElement)}updateLineOfSightVisualization(e,t){const o=this._configuration,{computationResult:n,inputPoints:s}=e,{start:r,end:l,intersection:a,isValid:c,isTargetVisible:u}=n,{observer:d}=s,p=v;p[12]=d[0],p[13]=d[1],p[14]=d[2];const f=m(g,r,d),y=m(V,l,d),L=m(_,a,d),{visibleLineVisualElement:C,occludedLineVisualElement:O,undefinedLineVisualElement:A}=t;C.geometry=null,O.geometry=null,A.geometry=null,c?u?(C.geometry=[[h(f),h(y)]],C.transform=p,C.color=i.toUnitRGBA(o.visibleOuterColor)):(C.geometry=[[h(f),h(L)]],C.transform=p,C.color=i.toUnitRGBA(o.occludedOuterColor),O.geometry=[[h(L),h(y)]],O.transform=p):(A.geometry=[[h(f),h(y)]],A.transform=p)}getLineOfSightVisualizationDependencies(e){const{computationResult:i}=e,{occludedOuterColor:t,visibleOuterColor:o}=this._configuration;return{computationResult:i,occludedOuterColor:t,visibleOuterColor:o}}_connectAnalysis(e){const i=this._analysisHandles;if(i.has(e))return;const t=this.createLineOfSightVisualization();i.add([u((()=>this.getLineOfSightVisualizationDependencies(e)),(()=>this.updateLineOfSightVisualization(e,t))),n((()=>this.destroyLineOfSightVisualization(t)))])}_disconnectAnalysis(e){this._analysisHandles.remove(e)}_connectAnalyses(){let e=null;return s([u((()=>this._analyses),(i=>{e=r(e),e=i.on(\"change\",(e=>this._onAnalysesCollectionChange(e))),this._onAnalysesCollectionChange({target:i,added:i.items,removed:[],moved:[]})})),n((()=>e=r(e)))])}_onAnalysesCollectionChange(e){e.added.forEach((e=>this._connectAnalysis(e))),e.removed.forEach((e=>this._disconnectAnalysis(e)))}};e([a({constructOnly:!0})],y.prototype,\"layer\",void 0),e([a({constructOnly:!0})],y.prototype,\"view\",void 0),e([a({constructOnly:!0})],y.prototype,\"layerViewData\",void 0),e([a()],y.prototype,\"_analyses\",null),e([a()],y.prototype,\"_configuration\",null),y=e([c(\"esri.views.3d.layers.analysis.LineOfSight.LineOfSightView\")],y);const g=p(),V=p(),_=p(),v=d();export{y as LineOfSightView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../chunks/tslib.es6.js\";import{destroyMaybe as e,applySome as t,unwrapOr as i,mapOr as s}from\"../../../core/maybe.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView3D as l}from\"./LayerView3D.js\";import{LineOfSightController as n}from\"./analysis/LineOfSight/LineOfSightController.js\";import{LineOfSightLayerViewData as y}from\"./analysis/LineOfSight/LineOfSightLayerViewData.js\";import{LineOfSightView as p}from\"./analysis/LineOfSight/LineOfSightView.js\";import h from\"../../layers/LayerView.js\";let m=class extends(l(h)){constructor(){super(...arguments),this.type=\"line-of-sight-3d\",this._layerViewData=new y}initialize(){const r=this.view,e=this.layer,t=this._layerViewData;this._analysisController=new n({layer:e,layerViewData:t,view:r}),this._analysisView=new p({layer:e,layerViewData:t,view:r})}destroy(){this._analysisController=e(this._analysisController),this._analysisView=e(this._analysisView)}get results(){return this._layerViewData.analyses.map((r=>r.result))}get priority(){return this._analysisController.priority}set priority(r){this._analysisController.priority=r}getResultForTarget(r){const e=this._layerViewData.analyses.find((e=>e.target===r)),s=t(e,(r=>r.result));return i(s,null)}isUpdating(){return s(this._analysisController,!1,(r=>r.updating))}};r([o({readOnly:!0})],m.prototype,\"type\",void 0),r([o()],m.prototype,\"layer\",void 0),r([o({readOnly:!0})],m.prototype,\"results\",null),r([o()],m.prototype,\"priority\",null),r([o()],m.prototype,\"_layerViewData\",void 0),r([o()],m.prototype,\"_analysisController\",void 0),r([o()],m.prototype,\"_analysisView\",void 0),m=r([a(\"esri.views.3d.layers.LineOfSightLayerView3D\")],m);var w=m;export default w;export{m as LineOfSightLayerView3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as s}from\"../../../../core/maybe.js\";import{d as r}from\"../../../../chunks/mat4.js\";import{c as t}from\"../../../../chunks/mat4f64.js\";import{VisualElement as o}from\"./VisualElement.js\";import{Object3D as i}from\"../../webgl-engine/lib/Object3D.js\";import{WebGLLayer as a}from\"../../webgl-engine/lib/WebGLLayer.js\";class c extends o{constructor(e){super(e.view),this._resources=null,this._transform=t()}get object(){return e(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(s){r(this._transform,s),e(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(s(this._resources))return;const e=this._resources.object,r=this.view._stage;r.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),r.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new a({isPickable:!1,updatePolicy:1});e.add(s);const r=new i({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((s=>e.add(s))),e.add(r),s.add(r),this.visible||r.setVisible(!1),this._resources={layer:s,object:r}}destroyResources(){const e=this.view._stage;!s(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((s=>{e.remove(s),s.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){s(this._resources)||this._resources.object.setVisible(e)}}export{c as Object3DVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nclass t{constructor(t){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this.view.watch(\"ready\",(t=>{this._resourcesCreated&&(t?this._createResources():this._destroyResources())}))}applyProps(t){let e=!1;for(const s in t)s in this?\"attached\"===s?e=t[s]:this[s]=t[s]:console.error(\"Cannot set unknown property\",s);this.attached=e}destroy(){this.attached=!1}get attached(){return this._attached}set attached(t){t!==this._attached&&this.view._stage&&(this._attached=t,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.attached&&this.updateVisibility(t))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}export{t as VisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../../core/maybe.js\";import{i as r,t as s}from\"../../../../chunks/mat4.js\";import{c as i}from\"../../../../chunks/mat4f64.js\";import{s as o}from\"../../../../chunks/vec3.js\";import{Z as n,c as l}from\"../../../../chunks/vec3f64.js\";import{g as h,c as a}from\"../../../../chunks/vec4.js\";import{f as p,c as d,a as f}from\"../../../../chunks/vec4f32.js\";import{Object3DVisualElement as _}from\"./Object3DVisualElement.js\";import{createGeometry as c}from\"../../layers/graphics/lineUtils.js\";import{RibbonLineMaterial as u}from\"../../webgl-engine/materials/RibbonLineMaterial.js\";class m extends _{constructor(e){super(e),this._renderOccluded=4,this._width=1,this._color=p(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stippleIntegerRepeats=!1,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this.applyProps(e)}setGeometryFromExtent(e){const t=this.view.spatialReference,r=l(),s=l(),i=100,n=[];o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),this.geometry=[n]}setGeometryFromFrustum(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],r=e.origin,s=e.basis1,i=e.basis2,o=.5,n=l(),h=l(),a=l(),p=l();n[0]=r[0]-s[0]*o-i[0]*o,n[1]=r[1]-s[1]*o-i[1]*o,n[2]=r[2]-s[2]*o-i[2]*o,h[0]=r[0]-s[0]*o+i[0]*o,h[1]=r[1]-s[1]*o+i[1]*o,h[2]=r[2]-s[2]*o+i[2]*o,a[0]=r[0]+s[0]*o+i[0]*o,a[1]=r[1]+s[1]*o+i[1]*o,a[2]=r[2]+s[2]*o+i[2]*o,p[0]=r[0]+s[0]*o-i[0]*o,p[1]=r[1]+s[1]*o-i[1]*o,p[2]=r[2]+s[2]*o-i[2]*o,t.push([n[0],n[1],n[2]]),t.push([h[0],h[1],h[2]]),t.push([a[0],a[1],a[2]]),t.push([p[0],p[1],p[2]]),t.push([n[0],n[1],n[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;r(g),s(g,g,t),this.transform=g;const{points:i}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[i]}setGeometryFromSegments(e,t=n){r(g),s(g,g,t),this.transform=g,this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){h(e,this._color)||(a(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(r){e(r)?!t(this._innerColor)&&h(r,this._innerColor)||(this._innerColor=a(d(),r),this._updateMaterial()):e(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(t){const r=e(t)!==e(this._stipplePattern);this._stipplePattern=t,r?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(r){(t(r)||t(this._stippleOffColor)||!h(r,this._stippleOffColor))&&(this._stippleOffColor=e(r)?f(r):null,this._updateMaterial())}get stippleIntegerRepeats(){return this._stippleIntegerRepeats}set stippleIntegerRepeats(e){this._stippleIntegerRepeats!==e&&(this._stippleIntegerRepeats=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}createExternalResources(){this._material=new u(this.materialParameters)}destroyExternalResources(){this._material=null}createGeometries(e){const t=this._createLineGeometries();if(0!==t.length)for(let r=0;r<t.length;++r){const s=c(t[r]);e.addGeometry(s,this._material)}}forEachExternalMaterial(e){e(this._material)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,stippleIntegerRepeats:this._stippleIntegerRepeats,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateMaterial(){this.attached&&this._material.setParameterValues(this.materialParameters)}_createLineGeometries(){const e=this.geometry;if(t(e)||0===e.length)return[];const r=[];return e.forEach((e=>{const t=e.length,s=new Float64Array(3*t);e.forEach(((e,t)=>{s[3*t+0]=e[0],s[3*t+1]=e[1],s[3*t+2]=e[2]}));const i={attributeData:{position:s},removeDuplicateStartEnd:0};r.push(i)})),r}}const g=i();export{m as LineVisualElement};\n"],"sourceRoot":""}