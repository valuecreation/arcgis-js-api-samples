{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/layers/analysis/DirectLineMeasurement/DirectLineMeasurementController.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/MeasurementArrowTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/MeasurementArrowMaterial.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/MeasurementArrowVisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/RightAngleQuadVisualElement.js","../node_modules/@arcgis/core/views/3d/layers/analysis/DirectLineMeasurement/DirectLineMeasurementView.js","../node_modules/@arcgis/core/views/3d/layers/DirectLineMeasurementLayerView3D.js","../node_modules/@arcgis/core/chunks/MeasurementArrow.glsl.js"],"names":["A","t","constructor","e","super","this","_unitNormalizer","k","_handles","s","_tempStartPosition","u","_tempEndPosition","_tempCornerPosition","initialize","add","l","view","_initialize","destroy","a","spatialReference","v","D","z","_sphericalPCPF","i","g","d","result","_computedResult","viewData","startPoint","endPoint","layer","n","_euclideanDistances","_exactGeodesicDistanceAndAngle","horizontal","value","directDistance","direct","horizontalDistance","verticalDistance","vertical","geodesicDistance","distance","geodesicAngle","angle","clone","r","o","j","m","h","p","Math","abs","normalizeDistance","f","_","y","c","addPath","isGeographic","P","b","isWebMercator","_fallbackGeodesicAngle","_fallbackGeodesicDistance","w","metersPerDegree","R","G","sin","cos","M","prototype","initializeProgram","shader","get","build","rctx","bindPass","program","camera","projectionMatrix","setUniform1f","width","outlineSize","setUniform4fv","outlineColor","stripeLength","stripeEvenColor","stripeOddColor","bindDraw","rebindTextures","initializePipeline","polygonOffset","configuration","polygonOffsetEnabled","factor","units","depthTest","func","depthWrite","colorWrite","arguments","techniqueConfig","getTechniqueConfig","params","dispose","getPassParameters","intersect","createBufferWriter","getGLMaterial","output","updateParameters","_technique","_techniqueRep","releaseAndAcquire","_material","beginSlot","bind","vec3f","vec2f","f32","q","x","C","vertexBufferLayout","allocate","createBuffer","elementCount","indices","length","write","vertexAttributes","data","console","warn","transformation","invTranspTransformation","position","L","normal","uv0","setVec","set","T","auxpos1","_parameters","_origin","_originTransform","_arrowCenter","_renderOccluded","_geometry","_stripeLength","_stripesEnabled","applyProps","_arrowMaterial","setParameterValues","renderOccluded","geometryChanged","attached","arrowStripeEvenColor","arrowStripeOddColor","createExternalResources","arrowOutlineColor","state","watch","viewChanged","destroyExternalResources","forEachExternalMaterial","createGeometries","startRenderSpace","endRenderSpace","_createArrowGeometry","addGeometry","renderCoordsHelper","push","type","eval","worldUpAtPosition","arrowSubdivisions","createPolylineGeometry","recreateGeometry","ready","computeScreenPixelSizeAt","arrowWidth","arrowOutlineWidth","arrowStripeLength","_quadMaterial","_outlineMaterial","_maxSize","_position","_up","_right","_color","_outlineColor","_outlineSize","_size","_outlineRenderOccluded","_updateQuadMaterial","_updateOutlineMaterial","_updateTransform","previous","center","next","min","quadMaterialParameters","O","outlineMaterialParameters","removeAll","_createQuadGeometry","_createOutlineGeometry","_quadGeometryData","object","size","exclusive","Uint16Array","color","transparent","writeDepth","U","_params","Q","_segmentVisualElement","_triangleVisualElement","_rightAngleQuad","_projectedGeodesicLine","_geodesicStartHint","_geodesicEndHint","_segmentLabel","_verticalLabel","_horizontalLabel","_startPosition","E","_endPosition","_cornerPosition","_startPositionAtSeaLevel","_endPositionAtSeaLevel","_state","_segmentLabelDisplayedMeasurement","_triangleOrientationOverride","messages","viewMode","visualizedMeasurement","actualVisualizedMeasurement","visualElementOrientation","triangleCollapseRatioThreshold","layerView","geodesicDistanceThreshold","visible","suspended","_getActualVisualElementsOrientation","labels","Error","geometry","triangleLineWidth","triangleColor","W","stippleIntegerRepeats","geodesicProjectionLineWidth","geodesicProjectionLineColor","stipplePattern","guideStippleLengthPixels","guideLineWidth","fontSize","direcLabelFontSize","verticalLabelFontSize","horizontalLabelFontSize","S","_updateGeometryAndViewMode","_updateVisualElementVisibility","_updateLabelText","_updateLabelVisibility","_updateSegmentStripeLength","async","_updateMessageBundle","whenReady","equals","toRenderCoords","_updateActualVisualizedMeasurement","_computeViewMode","getAltitude","_updateSegment","_updateSegmentAndTriangle","_updateSegmentAndProjection","anchor","segment","sampleLocation","V","B","I","projectToRenderScreen","J","K","H","N","F","setAltitude","setGeometryFromSegment","text","_getLabelsText","euclideanDistance","notifyChange","unit","_measurementArrowStripeLength","stripesEnabled","_geodesicDistanceExceeded","_requiresGeodesicGuideAt","aboveGround","toUnit","then","readOnly","laserLineGlowColor","laserLineGlowWidth","laserLineGlowFalloff","laserLineInnerColor","laserLineInnerWidth","laserLineGlobalAlpha","laserLineEnabled","handleColor","handleOpacity","handleRadius","triangleCornerSize","triangleSubdivisions","guideLineColor","labelDistance","_userUnit","_defaultUnit","_analysisView","allowVisualElementsOrientationChange","testData","_analysisController","whenMessages","vertex","uniforms","attributes","varyings","code","fragment","sqrt","float","Object","freeze","__proto__"],"mappings":"wUAIwgD,IAAIA,EAAE,cAAcC,IAAEC,YAAYC,GAAGC,MAAMD,GAAGE,KAAKC,gBAAgB,IAAIC,IAAEF,KAAKG,SAAS,IAAIC,IAAEJ,KAAKK,mBAAmBC,cAAIN,KAAKO,iBAAiBD,cAAIN,KAAKQ,oBAAoBF,cAAIG,aAAaT,KAAKG,SAASO,IAAIC,YAAEX,KAAKY,KAAK,SAAS,IAAIZ,KAAKa,gBAAe,IAAKC,UAAUd,KAAKG,SAASY,YAAEf,KAAKG,UAAUU,cAAc,MAAMf,EAAEE,KAAKY,KAAKI,iBAAiBpB,EAAEqB,YAAEnB,GAAGM,EAAER,IAAIsB,IAAEC,IAAEvB,EAAEI,KAAKoB,eAAehB,EAAE,MAAMiB,EAAEC,YAAExB,EAAEM,GAAGJ,KAAKC,gBAAgBe,iBAAiBK,EAAEjB,EAAEN,EAAEE,KAAKG,SAASO,IAAIa,aAAG,MAAMC,OAAOxB,KAAKyB,gBAAgBC,SAAS1B,KAAK0B,aAAa,EAAEF,OAAO1B,EAAE4B,SAAS9B,MAAMA,EAAE4B,OAAO1B,MAAyB,sBAAG,MAAM6B,WAAW7B,EAAE8B,SAAShC,GAAGI,KAAK6B,MAAM,GAAGC,YAAEhC,IAAIgC,YAAElC,GAAG,OAAO,KAAK,MAAMQ,EAAEJ,KAAK+B,oBAAoBjC,EAAEF,GAAGyB,EAAErB,KAAKgC,+BAA+BlC,EAAEF,EAAEQ,EAAE6B,WAAWC,OAAO,MAAM,CAACC,eAAe/B,EAAEgC,OAAOC,mBAAmBjC,EAAE6B,WAAWK,iBAAiBlC,EAAEmC,SAASC,iBAAiBnB,EAAEoB,SAASC,cAAcrB,EAAEsB,OAAOZ,oBAAoBjC,EAAEF,GAAG,MAAMQ,EAAEN,EAAE8C,QAAQxC,EAAEe,EAAEvB,EAAEuB,EAAE,MAAME,EAAErB,KAAKK,mBAAmBwC,EAAE7C,KAAKO,iBAAiBuC,EAAE9C,KAAKQ,oBAAoBO,EAAEf,KAAKY,KAAKI,iBAAiBc,EAAE9B,KAAKoB,eAAeT,EAAEW,YAAEP,EAAEe,GAAGA,EAAEf,EAAEgC,YAAEjD,EAAEuB,EAAEV,GAAGoC,YAAEnD,EAAEiD,EAAElC,GAAGoC,YAAE3C,EAAE0C,EAAEnC,GAAG,MAAMqC,EAAEC,YAAE5B,EAAEwB,GAAGK,EAAED,YAAEH,EAAED,GAAGtB,EAAE4B,KAAKC,IAAIxD,EAAEuB,EAAErB,EAAEqB,GAAGb,EAAER,GAAGE,KAAKC,gBAAgBoD,kBAAkBvD,GAAGwD,EAAEhD,EAAE0C,GAAGO,EAAEjD,EAAE4C,GAAGM,EAAElD,EAAEiB,GAAG,MAAM,CAACa,OAAO,IAAIqB,IAAEH,EAAE,UAAUrB,WAAW,IAAIwB,IAAEF,EAAE,UAAUhB,SAAS,IAAIkB,IAAED,EAAE,WAAWxB,+BAA+BlC,EAAEF,EAAEQ,GAAG,MAAMiB,EAAEvB,EAAEkB,iBAAiB6B,EAAE,IAAIU,IAAE,CAACvC,iBAAiBK,IAAIwB,EAAEa,QAAQ,CAAC5D,EAAEF,IAAI,MAAMkD,EAAEzB,EAAEsC,cAAcC,YAAEvC,GAAGwC,YAAE,CAAChB,GAAG,UAAU,GAAGxB,EAAEyC,cAAcR,yBAAET,EAAE,eAAU,GAAQJ,SAAS1B,EAAE4B,MAAMb,GAAGgB,EAAE,CAACL,SAASK,EAAEH,MAAM3C,KAAK+D,uBAAuBjB,EAAEzB,IAAIrB,KAAKgE,0BAA0BlE,EAAEF,EAAEQ,GAAG,MAAM,CAACqC,SAAS,IAAIgB,IAAE1C,EAAE,UAAU4B,MAAM,IAAIc,IAAE3B,EAAE,YAAYiC,uBAAuBjE,EAAEF,GAAG,OAAOE,EAAEmE,YAAErE,GAAGsE,gBAAgBF,0BAA0BlE,EAAEF,EAAEQ,GAAG,GAAGoD,YAAE1D,EAAEqE,GAAG,CAACX,YAAE5D,EAAEwE,GAAG,MAAMtE,EAAEgD,YAAEqB,EAAE,IAAI/D,EAAE0C,YAAEqB,EAAE,IAAIpD,EAAE+B,YAAEsB,EAAE,IAAItC,EAAEgB,YAAEsB,EAAE,IAAIX,EAAEN,KAAKC,IAAIrC,EAAEjB,GAAGa,EAAEkC,YAAEM,KAAKkB,IAAIjE,GAAG+C,KAAKkB,IAAIvC,GAAGqB,KAAKmB,IAAIlE,GAAG+C,KAAKmB,IAAIxC,GAAGqB,KAAKmB,IAAIb,IAAIT,EAAE3B,YAAEV,GAAGuC,EAAE,CAACT,SAAS,GAAG,OAAO8B,YAAErB,EAAE,CAACiB,EAAE,GAAGA,EAAE,IAAI,CAACC,EAAE,GAAGA,EAAE,KAAK,CAAC3B,SAASS,EAAET,SAASE,MAAMK,GAAG,MAAMjC,EAAEjB,EAAEkB,iBAAiBc,EAAE1B,EAAE,MAAM,CAACqC,SAASX,EAAEa,MAAM3C,KAAK+D,uBAAuBjC,EAAEf,MAAMjB,YAAE,CAACkD,eAAKrD,EAAE6E,UAAU,YAAO,GAAQ1E,YAAE,CAACkD,eAAKrD,EAAE6E,UAAU,aAAQ,GAAQ1E,YAAE,CAACkD,eAAKrD,EAAE6E,UAAU,gBAAW,GAAQ1E,YAAE,CAACkD,eAAKrD,EAAE6E,UAAU,kBAAkB,MAAM7E,EAAEG,YAAE,CAACoD,YAAE,wFAAwFvD,GAAG,MAAMwE,EAAE7D,cAAI8D,EAAE9D,c,oMCAtnG,MAAMiB,UAAUF,IAAExB,YAAYgD,EAAE/C,EAAEgD,GAAG/C,MAAM8C,EAAE/C,EAAEgD,GAAG2B,kBAAkB5B,GAAG,MAAM/C,EAAEyB,EAAEmD,OAAOC,MAAMC,QAAQ,OAAO,IAAI5B,IAAEH,EAAEgC,KAAK/E,EAAEiB,KAAG+D,SAASjC,EAAEC,GAAGhD,YAAEE,KAAK+E,QAAQjC,EAAEkC,OAAOC,kBAAkBjF,KAAK+E,QAAQG,aAAa,QAAQrC,EAAEsC,OAAOnF,KAAK+E,QAAQG,aAAa,cAAcrC,EAAEuC,aAAapF,KAAK+E,QAAQM,cAAc,eAAexC,EAAEyC,cAActF,KAAK+E,QAAQG,aAAa,eAAerC,EAAE0C,cAAcvF,KAAK+E,QAAQM,cAAc,kBAAkBxC,EAAE2C,iBAAiBxF,KAAK+E,QAAQM,cAAc,iBAAiBxC,EAAE4C,gBAAgBC,SAAS7C,GAAGC,YAAE9C,KAAK+E,QAAQlC,GAAG7C,KAAK+E,QAAQY,iBAAiBC,qBAAqB,OAAOjF,YAAE,CAACkF,cAAc7F,KAAK8F,cAAcC,sBAAsB,CAACC,OAAO,EAAEC,OAAO,GAAGC,UAAU,CAACC,KAAK,KAAKC,WAAW9C,IAAE+C,WAAWpD,MAAqB,oBAAG,OAAO,GAAG1B,EAAEmD,OAAO,IAAI9E,IAAEsD,KAAG,IAAI,mCAAuC,MAAM5C,UAAUF,IAAEP,cAAcE,SAASuG,WAAWtG,KAAK+F,sBAAqB,GAAIlD,YAAE,CAACf,eAAKxB,EAAEkE,UAAU,4BAAuB,GCA/tC,MAAMvB,UAAU3C,IAAET,YAAYC,GAAGC,MAAMD,EAAEyB,GAAGvB,KAAKuG,gBAAgB,IAAI5F,EAAE6F,qBAAqB,OAAOxG,KAAKuG,gBAAgBR,qBAAqB/F,KAAKyG,OAAOZ,cAAc7F,KAAKuG,gBAAgBG,WAAWC,oBAAoB,OAAO3G,KAAKyG,OAAOG,aAAaC,qBAAqB,OAAO,IAAI5C,GAAE6C,cAAchH,GAAG,OAAO,IAAIA,EAAEiH,OAAO,IAAI/D,EAAElD,QAAG,GAAQ,MAAMkD,UAAUS,IAAE5D,YAAYC,GAAGC,MAAMD,GAAGE,KAAKgH,mBAAmBA,mBAAmBhH,KAAKiH,WAAWjH,KAAKkH,cAAcC,kBAAkBjE,EAAElD,KAAKoH,UAAUZ,qBAAqBxG,KAAKiH,YAAYI,UAAUvH,GAAG,OAAO,IAAIA,EAAEwH,KAAKxH,GAAGE,KAAKiH,WAAWnC,SAAS9E,KAAKoH,UAAUT,oBAAoB7G,IAAI,MAAMyB,EAAE,CAAC4D,MAAM,GAAGC,YAAY,GAAGE,aAAa,CAAC,EAAE,GAAG,EAAE,GAAGC,aAAa,EAAEC,gBAAgB,CAAC,EAAE,EAAE,EAAE,GAAGC,eAAe,CAAC,EAAE,GAAG,EAAE,GAAGI,eAAc,KAAMvC,KAAGhC,EAAEP,cAAIwG,MAAM,YAAYA,MAAM,UAAUC,MAAM,OAAOC,IAAI,WAAWxG,GAAEa,cAAI4F,GAAE5F,cAAI+B,GAAE/B,cAAI6F,GAAE7F,cAAI8F,GAAE9F,cAAI,MAAMmC,GAAEpE,cAAcG,KAAK6H,mBAAmBvG,EAAEwG,SAAShI,GAAG,OAAOE,KAAK6H,mBAAmBE,aAAajI,GAAGkI,aAAalI,GAAG,OAAO,GAAGA,EAAEmI,QAAQtD,IAAI,YAAYuD,OAAO,EAAE,GAAGC,MAAMrG,EAAEf,EAAE0C,EAAEnD,GAAG,MAAMgD,EAAEvC,EAAEqH,iBAAiBzD,IAAI,YAAY0D,KAAK1H,EAAEI,EAAEqH,iBAAiBzD,IAAI,UAAU0D,KAAKnF,EAAEI,EAAE4E,OAAO,EAAEjF,EAAElC,GAAGA,EAAEkH,SAASlH,EAAEkH,QAAQtD,IAAI,YAAY1B,GAAGA,EAAEiF,SAAS,GAAGhF,EAAE,IAAIoF,QAAQC,KAAK,qDAAqD,MAAMvF,EAAE/B,GAAEM,EAAEmG,GAAEpG,EAAEuC,GAAEI,EAAE0D,GAAE/D,EAAEgE,GAAE7E,EAAEjB,EAAE0G,eAAehF,EAAE1B,EAAE2G,wBAAwB9I,EAAE8D,EAAEiF,SAASC,EAAElF,EAAEmF,OAAOrE,EAAEd,EAAEoF,IAAI,IAAItF,EAAE,EAAE,IAAI,IAAItC,EAAE,EAAEA,EAAEiC,IAAIjC,EAAE,CAAC,MAAMa,EAAE,EAAEb,EAAE,GAAGnB,YAAEkD,EAAEM,EAAExB,GAAGwB,EAAExB,EAAE,GAAGwB,EAAExB,EAAE,IAAIb,EAAEiC,EAAE,EAAE,CAAC,MAAM7B,EAAE,GAAGJ,EAAE,GAAGnB,YAAEyB,EAAE+B,EAAEjC,GAAGiC,EAAEjC,EAAE,GAAGiC,EAAEjC,EAAE,IAAIvB,YAAE8D,EAAEjD,EAAEU,GAAGV,EAAEU,EAAE,GAAGV,EAAEU,EAAE,IAAIzB,YAAEgE,EAAEA,GAAGxD,YAAEkB,EAAEC,EAAEyB,GAAGpD,YAAE0B,EAAEA,GAAGuB,YAAEoB,EAAEL,EAAEtC,GAAG1B,YAAEqE,EAAEA,GAAG,MAAMlD,EAAEM,YAAE2B,EAAEzB,GAAGwB,GAAGS,IAAIV,YAAEE,EAAEA,EAAED,GAAGD,YAAEvB,EAAEA,EAAEwB,GAAGD,YAAEmB,EAAEA,EAAET,IAAI,MAAMC,EAAEnD,EAAE,EAAEW,EAAEgC,EAAEQ,EAAE,EAAE9D,EAAEmJ,OAAOrF,EAAET,GAAGrD,EAAEmJ,OAAO7F,EAAED,GAAG2F,EAAEG,OAAOrF,EAAEQ,GAAG0E,EAAEG,OAAO7F,EAAEgB,GAAGM,EAAEwE,IAAItF,EAAE,EAAEF,GAAGgB,EAAEwE,IAAItF,EAAE,GAAG,GAAGc,EAAEwE,IAAI9F,EAAE,EAAEM,GAAGgB,EAAEwE,IAAI9F,EAAE,EAAE,GAAGhC,EAAEiC,EAAE,IAAIK,GAAGxC,GAAG,MAAMiI,EAAEvF,EAAEwF,QAAQ,IAAI,IAAInJ,EAAE,EAAEA,EAAE,EAAEoD,IAAIpD,EAAEkJ,EAAED,IAAIzI,EAAER,EAAEyD,ICAprD,MAAMhC,WAAUO,IAAEjC,YAAYC,GAAGC,MAAMD,GAAGE,KAAKkJ,YAAYzF,GAAEzD,KAAKG,SAAS,KAAKH,KAAKmJ,QAAQpI,cAAIf,KAAKoJ,iBAAiBhJ,cAAIJ,KAAKqJ,aAAatI,cAAIf,KAAKsJ,gBAAgB,EAAEtJ,KAAKuJ,UAAU,KAAKvJ,KAAKwJ,cAAc,EAAExJ,KAAKyJ,iBAAgB,EAAGzJ,KAAK0J,WAAW5J,GAAqB,qBAAG,OAAOE,KAAKsJ,gBAAkC,mBAACxJ,GAAGA,IAAIE,KAAKsJ,kBAAkBtJ,KAAKsJ,gBAAgBxJ,EAAEE,KAAK2J,gBAAgB3J,KAAK2J,eAAeC,mBAAmB,CAACC,eAAe/J,KAAiB,eAAG,OAAOE,KAAKuJ,UAAsB,aAACzJ,GAAGE,KAAKuJ,UAAUzJ,EAAEE,KAAK8J,kBAAkC,mBAAG,OAAO9J,KAAKwJ,cAA8B,iBAAC1J,GAAGE,KAAKwJ,cAAc1J,EAAEE,KAAK+J,UAAU/J,KAAK2J,eAAeC,mBAAmB,CAACrE,aAAavF,KAAKwJ,gBAAkC,qBAAG,OAAOxJ,KAAKyJ,gBAAkC,mBAAC3J,GAAG,GAAGE,KAAKyJ,gBAAgB3J,EAAEE,KAAK+J,SAAS,CAAC,MAAMjK,EAAEE,KAAKyJ,gBAAgBzJ,KAAKkJ,YAAYc,qBAAqBhK,KAAKkJ,YAAYe,oBAAoBjK,KAAK2J,eAAeC,mBAAmB,CAACpE,gBAAgB1F,KAAKoK,0BAA0B,MAAMrH,EAAE7C,KAAKyJ,gBAAgBzJ,KAAKkJ,YAAYc,qBAAqBhK,KAAKkJ,YAAYe,oBAAoBjK,KAAK2J,eAAe,IAAIhJ,EAAE,CAAC2E,aAAatF,KAAKkJ,YAAYiB,kBAAkB3E,gBAAgB3C,EAAE4C,eAAezF,KAAKkJ,YAAYe,oBAAoBJ,eAAe7J,KAAK6J,eAAehE,eAAc,IAAK7F,KAAKG,SAAS,IAAIL,IAAEE,KAAKG,SAASO,IAAIV,KAAKY,KAAKwJ,MAAMC,MAAM,UAAU,KAAKrK,KAAKsK,kBAAkBC,2BAA2BvK,KAAK2J,eAAe,KAAK3J,KAAKG,SAASW,UAAUd,KAAKG,SAAS,KAAKqK,wBAAwB1K,GAAGA,EAAEE,KAAK2J,gBAAgBc,iBAAiB3K,GAAG,GAAG+C,YAAE7C,KAAKuJ,YAAY1G,YAAE7C,KAAKuJ,UAAUmB,mBAAmB7H,YAAE7C,KAAKuJ,UAAUoB,gBAAgB,OAAO,MAAM/K,EAAEI,KAAK4K,qBAAqB5K,KAAKuJ,UAAUmB,iBAAiB1K,KAAKuJ,UAAUoB,eAAe3K,KAAKmJ,QAAQnJ,KAAKuJ,WAAWzJ,EAAE+K,YAAYjL,EAAEI,KAAK2J,eAAe3J,KAAKoJ,kBAAkBpJ,KAAKsK,cAAcM,qBAAqB9K,EAAE+C,EAAEjD,EAAEQ,GAAG,MAAMW,EAAEf,KAAKY,KAAKkK,mBAAmBhJ,EAAE,GAAGnB,EAAE,GAAGY,EAAE,CAACzB,EAAE+C,KAAK,MAAMzC,EAAE0C,IAAE6B,MAAMtD,YAAEjB,EAAEN,EAAEF,GAAGkC,EAAEiJ,KAAK3K,GAAGO,EAAEoK,KAAKlI,IAAI,GAAG,cAAczC,EAAE4K,KAAK,CAAC5K,EAAE6K,KAAK,GAAGjL,KAAKqJ,cAAc,MAAMzJ,EAAEkD,IAAE6B,MAAM5D,EAAEmK,kBAAkBlL,KAAKqJ,aAAazJ,GAAG2B,EAAEzB,EAAEF,GAAG2B,EAAEsB,EAAEjD,OAAO,CAACQ,EAAE6K,KAAK,GAAGjL,KAAKqJ,cAAc,MAAMvJ,EAAEE,KAAKkJ,YAAYiC,kBAAkB,GAAG,EAAE,IAAI,IAAItI,EAAE,EAAEA,EAAE/C,IAAI+C,EAAE,CAAC,MAAMjD,EAAEiD,GAAG/C,EAAE,GAAGuB,EAAEyB,IAAE6B,MAAM7C,EAAEgB,IAAE6B,MAAMvE,EAAE6K,KAAKrL,EAAEyB,GAAGN,EAAEmK,kBAAkB7J,EAAES,GAAGP,EAAEF,EAAES,IAAI,OAAOmB,IAAEmI,uBAAuBtJ,EAAEnB,GAAGmJ,kBAAkB9J,KAAKqL,mBAAmBf,cAAc,GAAGtK,KAAKY,KAAK0K,OAAOtL,KAAK+J,UAAUnK,YAAEI,KAAKuJ,WAAW,CAAC,MAAMzJ,EAAEE,KAAKY,KAAKwJ,MAAMpF,OAAOuG,yBAAyBvL,KAAKqJ,cAAcrJ,KAAK2J,eAAeC,mBAAmB,CAACzE,MAAMnF,KAAKkJ,YAAYsC,WAAW1L,MAAM,MAAM2D,GAAE,CAAC+H,WAAW,GAAGrB,kBAAkB,CAAC,EAAE,GAAG,EAAE,GAAGsB,kBAAkB,GAAGzB,qBAAqB,CAAC,EAAE,EAAE,EAAE,GAAGC,oBAAoB,CAAC,EAAE,GAAG,EAAE,GAAGyB,kBAAkB,GAAGP,kBAAkB,K,oDCA39E,MAAM3H,WAAUN,IAAErD,YAAYD,GAAGG,MAAMH,GAAGI,KAAKG,SAAS,IAAIL,IAAEE,KAAK2L,cAAc,KAAK3L,KAAK4L,iBAAiB,KAAK5L,KAAK6L,SAAS,EAAE7L,KAAK8L,UAAUvK,cAAIvB,KAAK+L,IAAIxK,cAAIvB,KAAKgM,OAAOzK,cAAIvB,KAAKsJ,gBAAgB,EAAEtJ,KAAKiM,OAAO1I,YAAE,EAAE,EAAE,EAAE,GAAGvD,KAAKkM,cAAc3I,YAAE,EAAE,EAAE,EAAE,GAAGvD,KAAKmM,aAAa,EAAEnM,KAAKoM,MAAM,GAAGpM,KAAKqM,uBAAuB,GAAGrM,KAAK0J,WAAW9J,GAAqB,qBAAG,OAAOI,KAAKsJ,gBAAkC,mBAACxJ,GAAGA,IAAIE,KAAKsJ,kBAAkBtJ,KAAKsJ,gBAAgBxJ,EAAEE,KAAKsM,uBAAgC,YAAG,OAAOtM,KAAKiM,OAAgB,UAACnM,GAAG2D,aAAEzD,KAAKiM,OAAOnM,GAAGE,KAAKsM,sBAAsC,mBAAG,OAAOtM,KAAKkM,cAA8B,iBAACpM,GAAG2D,aAAEzD,KAAKkM,cAAcpM,GAAGE,KAAKuM,yBAAwC,kBAAG,OAAOvM,KAAKmM,aAA4B,gBAACrM,GAAG,MAAMF,EAAE,IAAII,KAAKmM,eAAe,IAAIrM,GAAGE,KAAKmM,aAAarM,EAAEF,EAAEI,KAAKqL,mBAAmBrL,KAAKuM,yBAAiC,WAAG,OAAOvM,KAAKoM,MAAc,SAACtM,GAAGA,IAAIE,KAAKoM,QAAQpM,KAAKoM,MAAMtM,EAAEE,KAAKwM,oBAA6C,4BAAG,OAAOxM,KAAKqM,uBAAgD,0BAACvM,GAAGE,KAAKqM,uBAAuBvM,EAAEE,KAAKuM,yBAAqC,cAAEE,SAAS3M,EAAE4M,OAAO9M,EAAE+M,KAAKtL,IAAIrB,KAAK6L,SAAS1I,KAAKyJ,IAAI9J,YAAElD,EAAEE,GAAGgD,YAAElD,EAAEyB,IAAI,EAAEV,YAAEX,KAAK+L,IAAIjK,YAAE9B,KAAK+L,IAAIjM,EAAEF,IAAIe,YAAEX,KAAKgM,OAAOlK,YAAE9B,KAAKgM,OAAO3K,EAAEzB,IAAIU,YAAEN,KAAK8L,UAAUlM,GAAGI,KAAKqL,mBAAmBnB,0BAA0BlK,KAAK2L,cAAc,IAAIrK,KAAEtB,KAAK6M,wBAAwB7M,KAAK4L,iBAAiB,IAAIkB,KAAE9M,KAAK+M,2BAA2B/M,KAAKG,SAASO,IAAIV,KAAKY,KAAKwJ,MAAMC,MAAM,UAAU,IAAIrK,KAAKwM,sBAAsBjC,2BAA2BvK,KAAK2L,cAAc,KAAK3L,KAAK4L,iBAAiB,KAAK5L,KAAKG,SAAS6M,YAAYxC,wBAAwB1K,GAAGA,EAAEE,KAAK2L,eAAe7L,EAAEE,KAAK4L,kBAAkBnB,iBAAiB3K,GAAGE,KAAKiN,oBAAoBnN,GAAGE,KAAKkN,uBAAuBpN,GAAGE,KAAKwM,iBAAiB1M,GAAGmN,oBAAoBnN,GAAG,MAAMF,EAAEI,KAAKmN,kBAAkBnN,KAAK+L,IAAI/L,KAAKgM,QAAQlM,EAAE+K,YAAYjL,EAAEI,KAAK2L,eAAeuB,uBAAuBpN,GAAG,GAAG,IAAIE,KAAKmM,aAAa,OAAO,MAAMvM,EAAEqD,YAAED,IAAE2B,MAAM3E,KAAK+L,IAAI/L,KAAKgM,QAAQ3K,EAAEiC,IAAE8H,uBAAuB,CAACpL,KAAK+L,IAAInM,EAAEI,KAAKgM,SAASlM,EAAE+K,YAAYxJ,EAAErB,KAAK4L,kBAAkBY,iBAAiB1M,EAAEE,KAAKoN,QAAQ,MAAMrM,EAAEf,KAAKY,KAAKwJ,MAAMpF,OAAOlC,EAAE9C,KAAKoM,MAAMrL,EAAEwK,yBAAyBvL,KAAK8L,WAAWnL,EAAEwC,KAAKyJ,IAAI5M,KAAK6L,SAAS/I,GAAGzB,aAAEF,IAAG0B,aAAE1B,GAAEA,GAAEnB,KAAK8L,WAAW1L,aAAEe,GAAEA,GAAE,CAACR,EAAEA,EAAEA,IAAIf,YAAEE,KAAKA,EAAE0I,eAAerH,IAAGgM,kBAAkBrN,EAAEF,GAAG,MAAMyB,EAAE4B,YAAED,IAAE2B,MAAM7E,EAAEF,GAAG,OAAO,IAAI2E,KAAE,CAAC,CAAC,WAAW,CAAC8I,KAAK,EAAEhF,KAAK,CAAC,EAAE,EAAE,KAAKzI,KAAKE,KAAKuB,GAAGiM,WAAU,KAAM,CAAC,CAAC,WAAW,IAAIC,YAAY,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,OAAiC,6BAAG,MAAM,CAACC,MAAMxN,KAAKiM,OAAOwB,aAAY,EAAGC,YAAW,EAAG7H,eAAc,EAAGgE,eAAe7J,KAAKsJ,iBAAiBgD,sBAAsBtM,KAAK2L,eAAe3L,KAAK2L,cAAc/B,mBAAmB5J,KAAK6M,wBAAqD,gCAAG,MAAM,CAACW,MAAMxN,KAAKkM,cAAc/G,MAAMnF,KAAKmM,aAAatC,eAAe7J,KAAKqM,wBAAwBE,yBAAyBvM,KAAK4L,kBAAkB5L,KAAK4L,iBAAiBhC,mBAAmB5J,KAAK+M,4BAA4B,MAAM5L,GAAEJ,c,sDCAp8C,IAAI4M,GAAE,cAAc/N,IAAEC,YAAYC,GAAGC,MAAMD,GAAGE,KAAK4N,QAAQ,IAAIC,IAAG7N,KAAKG,SAAS,IAAIkB,IAAErB,KAAK8N,sBAAsB,KAAK9N,KAAK+N,uBAAuB,KAAK/N,KAAKgO,gBAAgB,KAAKhO,KAAKiO,uBAAuB,KAAKjO,KAAKkO,mBAAmB,KAAKlO,KAAKmO,iBAAiB,KAAKnO,KAAKoO,cAAc,KAAKpO,KAAKqO,eAAe,KAAKrO,KAAKsO,iBAAiB,KAAKtO,KAAKuO,eAAeC,cAAIxO,KAAKyO,aAAaD,cAAIxO,KAAK0O,gBAAgBF,cAAIxO,KAAK2O,yBAAyBH,cAAIxO,KAAK4O,uBAAuBJ,cAAIxO,KAAK6O,OAAO,EAAE7O,KAAK8O,kCAAkC,EAAE9O,KAAK+O,6BAA6B,KAAK/O,KAAKgP,SAAS,KAAKhP,KAAKiP,SAAS,EAAEjP,KAAKkP,sBAAsB,EAAElP,KAAKmP,4BAA4B,EAAEnP,KAAKoP,yBAAyB,EAAEpP,KAAKqP,+BAA+B,IAAiC,gCAAG,IAAIvP,EAAE,MAAMF,EAAEI,KAAKsP,UAAU9N,OAAO,OAAOT,YAAEnB,KAAK,OAAOE,EAAEF,EAAEyC,yBAAoB,EAAOvC,EAAEoC,OAAOlC,KAAK6B,MAAM0N,0BAAmC,YAAG,OAAO,IAAIvP,KAAK6O,OAAkB,cAAG,OAAO7O,KAAKsP,UAAUE,UAAUxP,KAAKsP,UAAUG,UAAkD,2CAAG,OAAO3M,YAAE9C,KAAK+O,8BAAsE,yCAACjP,GAAGgD,YAAE9C,KAAK+O,gCAAgCjP,IAAIgD,YAAE9C,KAAK+O,8BAA8B/O,KAAK+O,6BAA6B/O,KAAK0P,sCAAsC1P,KAAK+O,6BAA6B,MAAgB,aAAG,OAAO,IAAI/O,KAAKmP,4BAA4B,CAAC/M,OAAOpC,KAAKsO,iBAAiBrM,WAAWjC,KAAKoO,cAAc7L,SAASvC,KAAKqO,gBAAgB,CAACjM,OAAOpC,KAAKoO,cAAcnM,WAAWjC,KAAKsO,iBAAiB/L,SAASvC,KAAKqO,gBAA4B,eAAG,MAAM,CAACsB,OAAO3P,KAAK2P,OAAOpK,aAAavF,KAAK8N,sBAAsBvI,cAAc9E,aAAaT,KAAKG,SAASO,IAAIiI,YAAE3I,KAAKY,KAAK,SAAS,IAAIZ,KAAKa,gBAAe,IAAKA,cAAc,OAAOb,KAAK6O,QAAQ,KAAK,EAAE,MAAM,IAAIe,MAAM,iBAAiB,KAAK,EAAE,OAAO,MAAM9P,EAAEE,KAAK4N,QAAQhO,EAAE,CAACmK,UAAS,EAAGnJ,KAAKZ,KAAKY,MAAMZ,KAAK8N,sBAAsB,IAAIhB,GAAE,IAAIlN,EAAEiQ,SAAS,KAAKhG,eAAe,IAAI7J,KAAK+N,uBAAuB,IAAIxJ,IAAE,IAAI3E,EAAEuF,MAAMrF,EAAEgQ,kBAAkBtC,MAAM1N,EAAEiQ,cAAclG,eAAe,IAAI7J,KAAKgO,gBAAgB,IAAIpG,GAAE,IAAIhI,EAAE4N,MAAMwC,GAAEnG,eAAe,IAAI,MAAMxI,EAAE,IAAIzB,EAAEiG,eAAc,EAAGoK,uBAAsB,EAAGpG,eAAe,GAAG7J,KAAKiO,uBAAuB,IAAI1J,IAAE,IAAIlD,EAAE8D,MAAMrF,EAAEoQ,4BAA4B1C,MAAM1N,EAAEqQ,4BAA4BC,eAAelQ,aAAEJ,EAAEuQ,4BAA4BrQ,KAAKkO,mBAAmB,IAAI3J,IAAE,IAAIlD,EAAE8D,MAAMrF,EAAEwQ,eAAe9C,MAAM1N,EAAEqQ,4BAA4BC,eAAelQ,aAAEJ,EAAEuQ,4BAA4BrQ,KAAKmO,iBAAiB,IAAI5J,IAAE,IAAIlD,EAAE8D,MAAMrF,EAAEwQ,eAAe9C,MAAM1N,EAAEqQ,4BAA4BC,eAAelQ,aAAEJ,EAAEuQ,4BAA4BrQ,KAAKoO,cAAc,IAAIlN,IAAE,IAAItB,EAAE2Q,SAASzQ,EAAE0Q,qBAAqBxQ,KAAKqO,eAAe,IAAInN,IAAE,IAAItB,EAAE2Q,SAASzQ,EAAE2Q,wBAAwBzQ,KAAKsO,iBAAiB,IAAIpN,IAAE,IAAItB,EAAE2Q,SAASzQ,EAAE4Q,0BAA0B1Q,KAAKG,SAASO,IAAI,CAACiQ,aAAG,IAAI3Q,KAAK4Q,+BAA+BD,aAAG,IAAI3Q,KAAK6Q,mCAAmCF,aAAG,IAAI3Q,KAAK8Q,qBAAqBH,aAAG,IAAI3Q,KAAK+Q,2BAA2BJ,aAAG,IAAI3Q,KAAKgR,+BAA+B7M,cAAG8M,SAASjR,KAAKkR,2BAA2BlR,KAAK6O,OAAO,EAAE7O,KAAKkR,uBAAuBpQ,UAAU,IAAId,KAAK6O,SAAS7O,KAAKG,SAASQ,YAAEX,KAAKG,UAAUH,KAAK8N,sBAAsBnN,YAAEX,KAAK8N,uBAAuB9N,KAAK+N,uBAAuBpN,YAAEX,KAAK+N,wBAAwB/N,KAAKgO,gBAAgBrN,YAAEX,KAAKgO,iBAAiBhO,KAAKiO,uBAAuBtN,YAAEX,KAAKiO,wBAAwBjO,KAAKkO,mBAAmBvN,YAAEX,KAAKkO,oBAAoBlO,KAAKmO,iBAAiBxN,YAAEX,KAAKmO,kBAAkBnO,KAAKoO,cAAczN,YAAEX,KAAKoO,eAAepO,KAAKqO,eAAe1N,YAAEX,KAAKqO,gBAAgBrO,KAAKsO,iBAAiB3N,YAAEX,KAAKsO,kBAAkBtO,KAAK+I,IAAI,OAAO,MAAM/I,KAAK6O,OAAO,GAAkB,wBAASlG,YAAE3I,KAAK,SAA2B,2BAASA,KAAKmR,kBAAkBxI,YAAE3I,KAAK,YAAY6Q,iCAAiC,GAAG7Q,KAAK8N,sBAAsB0B,SAAQ,EAAGxP,KAAK+N,uBAAuByB,SAAQ,EAAGxP,KAAKgO,gBAAgBwB,SAAQ,EAAGxP,KAAKiO,uBAAuBuB,SAAQ,EAAGxP,KAAKkO,mBAAmBsB,SAAQ,EAAGxP,KAAKmO,iBAAiBqB,SAAQ,EAAGxP,KAAKwP,QAAQ,OAAOxP,KAAKiP,UAAU,KAAK,EAAE,MAAM,KAAK,EAAEjP,KAAK8N,sBAAsB0B,SAAQ,EAAG,MAAM,KAAK,EAAExP,KAAK8N,sBAAsB0B,SAAQ,EAAGxP,KAAK+N,uBAAuByB,SAAQ,EAAGxP,KAAKgO,gBAAgBwB,SAAQ,EAAG,MAAM,KAAK,EAAExP,KAAK8N,sBAAsB0B,SAAQ,EAAGxP,KAAKiO,uBAAuBuB,SAAQ,EAAGxP,KAAKkO,mBAAmBsB,SAAQ,EAAGxP,KAAKmO,iBAAiBqB,SAAQ,GAAIoB,6BAA6B,MAAM9Q,EAAEE,KAAKY,KAAKkK,oBAAoBnJ,WAAW/B,EAAEgC,SAASP,GAAGrB,KAAK6B,MAAM,GAAGiB,YAAElD,IAAIkD,YAAEzB,IAAIzB,EAAEwR,OAAO/P,GAAG,CAACrB,KAAKiP,SAAS,EAAE,MAAMnP,EAAEE,KAAKkP,sBAAsBtP,EAAE,IAAIE,EAAE,YAAYE,KAAKmP,4BAA4BvP,EAAE,EAAEE,GAAGA,EAAEuR,eAAezR,EAAEI,KAAKuO,gBAAgBzO,EAAEuR,eAAehQ,EAAErB,KAAKyO,cAAc,MAAMrO,EAAEJ,KAAK0P,sCAAsC5N,EAAE9B,KAAKsR,qCAAqCtR,KAAKiP,SAASjP,KAAKuR,iBAAiBzP,GAAG,IAAIe,EAAE7C,KAAKuO,eAAexN,EAAEf,KAAKyO,aAAa,MAAM9N,EAAE,IAAIP,EAAE,GAAG,EAAE6C,EAAEtC,GAAGb,EAAE0R,YAAYzQ,GAAGjB,EAAE0R,YAAY3O,IAAII,EAAE,IAAIJ,EAAE7C,KAAKyO,aAAa1N,EAAEf,KAAKuO,gBAAgB,MAAM9K,EAAE,IAAI3B,EAAE,IAAI6F,KAAE3H,KAAKuO,eAAevO,KAAKyO,aAAa3O,EAAEkB,kBAAkB,IAAIoD,KAAEpE,KAAKuO,eAAevO,KAAKyO,cAAc,OAAOzO,KAAK8N,sBAAsB+B,SAASpM,EAAEzD,KAAKgR,6BAA6BhR,KAAK8O,kCAAkChN,EAAE9B,KAAKiP,UAAU,KAAK,EAAEjP,KAAKyR,eAAehO,EAAErD,GAAG,MAAM,KAAK,EAAEJ,KAAK0R,0BAA0BjO,EAAErD,EAAEyC,EAAE9B,EAAEJ,EAAEsC,GAAG,MAAM,KAAK,EAAEjD,KAAK2R,4BAA4BvR,IAAIqR,eAAe3R,EAAEF,GAAGI,KAAKoO,cAAcwD,OAAO,IAAIhS,EAAE,MAAM,SAASI,KAAKoO,cAAcyB,SAAS,CAAC7E,KAAK,UAAU6G,QAAQ/R,EAAEgS,eAAe,UAAUJ,0BAA0B5R,EAAEF,EAAEyB,EAAEjB,EAAE0B,EAAEe,GAAG,MAAM9B,EAAEf,KAAKY,KAAKkC,EAAE/B,EAAE+J,mBAAmBnK,EAAEI,EAAEqJ,MAAMpF,OAAO/B,EAAEjD,KAAK0O,gBAAgB5L,EAAEoI,kBAAkB7J,EAAE4B,GAAG9B,YAAE8B,EAAEA,EAAEnB,EAAEqB,KAAKC,IAAIP,IAAIkP,YAAE9O,EAAEA,EAAE5B,GAAGrB,KAAK+N,uBAAuB8B,SAAS,CAAC,CAAC,CAACxO,EAAE,GAAGA,EAAE,GAAGA,EAAE,IAAI,CAAC4B,EAAE,GAAGA,EAAE,GAAGA,EAAE,IAAI,CAAC7C,EAAE,GAAGA,EAAE,GAAGA,EAAE,MAAMJ,KAAKgO,gBAAgB6B,SAAS,CAACpD,SAASpL,EAAEqL,OAAOzJ,EAAE0J,KAAKvM,GAAG,MAAMqD,EAAE,IAAIW,KAAE/C,EAAE4B,GAAG1B,EAAE,IAAI6C,KAAEnB,EAAE7C,GAAGE,EAA87I,SAAWR,EAAEF,EAAEyB,EAAEjB,EAAEyC,GAAG,MAAM9B,EAAEiR,GAAElP,EAAEmP,GAAEpP,EAAEqP,sBAAsB7Q,EAAEN,GAAG8B,EAAEqP,sBAAsBtS,EAAEkD,GAAG,MAAMnC,EAAE,CAACkR,QAAQ,SAAS5P,WAAW,MAAMM,SAASxB,EAAE,GAAG+B,EAAE,GAAG,OAAO,SAAS,CAAC,MAAM1C,EAAE+R,GAAEpR,EAAEqR,GAAE,GAAGC,aAAEvS,EAAEuB,EAAEjB,EAAEyC,GAAGwP,aAAEvS,EAAEF,EAAEmB,EAAE8B,GAAGS,YAAElD,EAAEW,IAAI2G,GAAE,CAAC,MAAM5H,EAAEgC,YAAE1B,EAAE,MAAM0B,YAAEf,EAAE,IAAIJ,EAAEkR,QAAQ/R,EAAEH,YAAEgB,EAAE4B,UAAU5B,EAAE4B,aAAa,CAAC,MAAMzC,EAAEwS,GAAED,aAAEhR,EAAEzB,EAAEE,EAAE+C,GAAGS,YAAExD,EAAEiB,IAAI2G,KAAI/G,EAAEkR,QAAQ/P,YAAEhC,EAAE,MAAMgC,YAAEf,EAAE,IAAIpB,YAAEgB,EAAEsB,YAAYtB,EAAEsB,aAAa,GAAG,IAAI7B,EAAE,CAAC,MAAMN,EAAEA,GAAG,QAAQA,EAAE,SAAS,MAAMa,EAAEkR,QAAQ/R,EAAEa,EAAEkR,SAASlR,EAAEsB,WAAWnC,EAAEa,EAAEsB,YAAYtB,EAAE4B,SAASzC,EAAEa,EAAE4B,UAAU,OAAO5B,EAA77J4R,CAAElR,EAAEjB,EAAE6C,EAAErD,EAAEe,GAAGX,KAAKoO,cAAcwD,OAAOtR,EAAEuR,QAAQ7R,KAAKoO,cAAcyB,SAAS,CAAC7E,KAAK,UAAU6G,QAAQ/R,EAAEgS,eAAe,UAAU9R,KAAKqO,eAAewB,SAAS,CAAC7E,KAAK,UAAU6G,QAAQpO,EAAEqO,eAAe,UAAU9R,KAAKqO,eAAeuD,OAAOtR,EAAEiC,SAASvC,KAAKsO,iBAAiBuB,SAAS,CAAC7E,KAAK,UAAU6G,QAAQtQ,EAAEuQ,eAAe,UAAU9R,KAAKsO,iBAAiBsD,OAAOtR,EAAE2B,WAAW0P,4BAA4B7R,GAAG,MAAMF,EAAEI,KAAKY,KAAKkK,mBAAmBlL,EAAE4S,YAAYxS,KAAK2O,yBAAyB,EAAE3O,KAAKuO,gBAAgB3O,EAAE4S,YAAYxS,KAAK4O,uBAAuB,EAAE5O,KAAKyO,cAAc,MAAMpN,EAAE,IAAIsG,KAAE3H,KAAK2O,yBAAyB3O,KAAK4O,uBAAuBhP,EAAEoB,kBAAkBhB,KAAKiO,uBAAuBwE,uBAAuBpR,GAAGrB,KAAKkO,mBAAmBuE,uBAAuB,IAAIrO,KAAEpE,KAAK2O,yBAAyB3O,KAAKuO,iBAAiBvO,KAAKmO,iBAAiBsE,uBAAuB,IAAIrO,KAAEpE,KAAK4O,uBAAuB5O,KAAKyO,eAAezO,KAAKoO,cAAcyB,SAAS,CAAC7E,KAAK,UAAU6G,QAAQxQ,EAAEyQ,eAAe,UAAU9R,KAAKoO,cAAcwD,OAAO,IAAI9R,EAAE,MAAM,SAASgR,mBAAmB,GAAG,IAAI9Q,KAAK6O,OAAO,OAAO,MAAM/O,EAAEE,KAAKoO,cAAcxO,EAAEI,KAAKsO,iBAAiBjN,EAAErB,KAAKqO,eAAejO,EAAEJ,KAAKgP,SAASlN,EAAE9B,KAAKsP,UAAU9N,OAAO,GAAGsB,YAAEhB,IAAIgB,YAAE1C,GAAG,OAAON,EAAE4S,KAAK,KAAK9S,EAAE8S,KAAK,UAAUrR,EAAEqR,KAAK,MAAM,MAAM7P,EAAE7C,KAAK2S,eAAevS,EAAE0B,GAAGf,EAAE,IAAIf,KAAK8O,kCAAkChP,EAAE4S,KAAK3R,EAAE8B,EAAE+P,kBAAkB/P,EAAEL,iBAAiB5C,EAAE8S,KAAK7P,EAAER,mBAAmBhB,EAAEqR,KAAK7P,EAAEP,iBAAiBtC,KAAK6S,aAAa,UAAU9B,yBAAyB,GAAG,IAAI/Q,KAAK6O,OAAO,OAAO,MAAM/O,EAAEE,KAAKoO,cAAcxO,EAAEI,KAAKsO,iBAAiBjN,EAAErB,KAAKqO,eAAe,GAAGvO,EAAE0P,SAAQ,EAAG5P,EAAE4P,SAAQ,EAAGnO,EAAEmO,SAAQ,EAAGxP,KAAKwP,QAAQ,OAAOxP,KAAKiP,UAAU,KAAK,EAAEnP,EAAE0P,SAAQ,EAAG,MAAM,KAAK,EAAE1P,EAAE0P,SAAQ,EAAG5P,EAAE4P,SAAQ,EAAGnO,EAAEmO,SAAQ,EAAG,MAAM,KAAK,EAAE1P,EAAE0P,SAAQ,GAAImD,eAAe7S,GAAGqC,eAAevC,EAAEyC,mBAAmBhB,EAAEiB,iBAAiBlC,EAAEoC,iBAAiBV,EAAEY,cAAcG,IAAI,MAAM9B,EAAEf,KAAKsP,UAAUwD,KAAKhQ,EAAEhD,IAAC,CAAI8S,kBAAkB,GAAGpQ,iBAAiB,GAAGH,mBAAmB,GAAGC,iBAAiB,MAAMxC,IAAI,OAAOiB,GAAG,IAAI,SAAS,OAAO+B,EAAE,CAAC8P,kBAAkBhT,GAAGoD,YAAElD,EAAEF,GAAG4C,iBAAiBV,GAAGkB,YAAElD,EAAEgC,GAAGO,mBAAmBhB,GAAG2B,YAAElD,EAAEuB,GAAGiB,iBAAiBlC,GAAGkB,YAAExB,EAAEM,KAAK,IAAI,WAAW,OAAO0C,EAAE,CAAC8P,kBAAkBhT,GAAG2B,YAAEzB,EAAEF,GAAG4C,iBAAiBV,GAAGP,YAAEzB,EAAEgC,GAAGO,mBAAmBhB,GAAGE,YAAEzB,EAAEuB,GAAGiB,iBAAiBlC,GAAGE,YAAER,EAAEM,KAAK,IAAI,UAAU,CAAC,MAAMR,EAAEiD,GAAGI,YAAEnD,EAAE+C,EAAE,WAAW,OAAOC,EAAE,CAAC8P,kBAAkBhT,EAAE4C,iBAAiB5C,EAAEyC,mBAAmBzC,IAAI,IAAI,0BAA0B,OAAOkD,EAAE,CAACT,mBAAmBQ,GAAGY,YAAEZ,KAAK,QAAQ,OAAOC,EAAE,CAAC8P,kBAAkBhT,GAAGqD,YAAEnD,EAAEF,EAAEmB,GAAGyB,iBAAiBV,GAAGmB,YAAEnD,EAAEgC,EAAEf,GAAGsB,mBAAmBhB,GAAG4B,YAAEnD,EAAEuB,EAAEN,GAAGuB,iBAAiBlC,GAAG6C,YAAEnD,EAAEM,EAAEW,MAAMiQ,6BAA6B,MAAMlR,EAAEE,KAAK+S,8BAA8BnT,EAAEI,KAAK8N,sBAAsB/M,YAAEjB,IAAIF,EAAE2F,aAAazF,EAAEF,EAAEoT,gBAAe,GAAIpT,EAAEoT,gBAAe,EAAGzB,iBAAiBzR,GAAG,GAAG,IAAIA,EAAE,CAAC,IAAIE,KAAKiT,0BAA0B,OAAO,EAAE,GAAGjT,KAAKkT,yBAAyBlT,KAAKuO,iBAAiBvO,KAAKkT,yBAAyBlT,KAAKyO,cAAc,OAAO,EAAE,MAAM7O,EAAEI,KAAKsP,UAAU9N,OAAO,GAAGsB,YAAElD,GAAG,OAAO,EAAE,MAAM0C,iBAAiBjB,EAAEgB,mBAAmBjC,GAAGR,EAAEkC,EAAET,EAAEa,MAAMW,EAAEzC,EAAE8B,MAAM,OAAOiB,KAAKyJ,IAAI9K,EAAEe,EAAEA,EAAEf,GAAG9B,KAAKqP,+BAA+B,EAAE,EAAEK,sCAAsC,GAAG3O,YAAEf,KAAK+O,8BAA8B,OAAO/O,KAAK+O,6BAA6B,MAAMjP,EAAEE,KAAKoP,yBAAyB,OAAO,IAAItP,EAAEE,KAAKY,KAAKwJ,MAAMpF,OAAOmO,YAAY,EAAE,EAAErT,EAAEwR,qCAAqC,GAAG,IAAItR,KAAKkP,sBAAsB,CAAClP,KAAKmP,4BAA4B,EAAE,MAAMrP,EAAEE,KAAKsP,UAAUwD,KAAK,YAAYhT,GAAG,4BAA4BA,IAAIE,KAAKmP,4BAA4B,GAAGnP,KAAKiT,4BAA4BjT,KAAKmP,4BAA4B,QAAQnP,KAAKmP,4BAA4BnP,KAAKkP,sBAAsB,OAAOlP,KAAKmP,4BAA4B+D,yBAAyBpT,GAAG,MAAMF,EAAEI,KAAKY,KAAK,IAAIhB,EAAEwK,MAAM,OAAM,EAAG,MAAM/I,EAAEzB,EAAEwK,MAAMpF,OAAO5E,EAAER,EAAEkL,mBAAmBhJ,EAAET,EAAEkK,yBAAyBzL,GAAG,OAAOM,EAAEoR,YAAY1R,GAAGgC,GAAG,GAAoC,oCAAG,MAAMhC,EAAEE,KAAKY,MAAMY,OAAO5B,EAAEkT,KAAKzR,GAAGrB,KAAKsP,UAAU,IAAIxN,EAAE,KAAK,GAAGf,YAAEnB,GAAG,CAAC,MAAME,EAAEF,EAAEuC,eAAe,OAAOd,GAAG,IAAI,SAASS,EAAEhC,GAAGA,EAAEsT,OAAO,UAAU,MAAM,IAAI,WAAWtR,EAAEhC,GAAGA,EAAEsT,OAAOnS,YAAEnB,EAAEoC,MAAMpC,EAAEgT,OAAO,MAAM,IAAI,UAAU,IAAI,0BAA0B,CAAC,MAAMhT,EAAEF,EAAE8C,cAAcZ,EAAEhC,GAAGA,EAAEsT,OAAO,WAAW,MAAM,QAAQtR,EAAEhC,GAAGA,EAAEsT,OAAO/R,IAAI,GAAGS,EAAE,CAAC,IAAIlC,EAAE,EAAE,OAAOA,EAAEQ,YAAE0B,EAAEI,MAAM,IAAItC,GAAG,YAAYkC,EAAEgR,KAAKlP,YAAE9D,EAAEkB,kBAAkBkD,gBAAgBL,YAAE,EAAE/B,EAAEgR,KAAK,UAAUlT,EAAE,OAAO,KAAKsR,uBAAuBlI,aAAE,uBAAuBqK,MAAMvT,IAAIE,KAAKgP,SAASlP,EAAEE,KAAKY,MAAMZ,KAAK8Q,wBAA2hBhR,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,cAAS,GAAQ1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,yCAAoC,GAAQ1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,oCAA+B,GAAQ1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,4BAA4B,MAAM1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,gBAAW,GAAQ1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,YAAO,GAAQ1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,aAAQ,GAAQ1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,iBAAY,GAAQ1E,YAAE,CAACmE,YAAE,CAACqP,UAAS,KAAM3F,GAAEnJ,UAAU,QAAQ,MAAM1E,YAAE,CAACmE,YAAE,CAACqP,UAAS,KAAM3F,GAAEnJ,UAAU,UAAU,MAAM1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,gBAAW,GAAQ1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,6BAAwB,GAAQ1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,mCAA8B,GAAQ1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,gCAA2B,GAAQ1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,sCAAiC,GAAQ1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,uCAAuC,MAAM1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,SAAS,MAAM1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,WAAW,MAAM1E,YAAE,CAACmE,eAAK0J,GAAEnJ,UAAU,gCAAgC,MAAMmJ,GAAE7N,YAAE,CAAC0D,YAAE,yEAAyEmK,IAAG,MAAMqC,GAAEjN,YAAE,EAAE,GAAG,EAAE,KAAK8K,GAAE,CAAC0F,mBAAmB,CAAC,EAAE,GAAG,GAAGC,mBAAmB,EAAEC,qBAAqB,EAAEC,oBAAoB,CAAC,EAAE,EAAE,GAAGC,oBAAoB,IAAIC,qBAAqB,IAAIC,kBAAiB,EAAGC,YAAY,CAAC,EAAE,GAAG,GAAGC,cAAc,GAAGC,aAAa,EAAEjE,cAAcC,GAAEF,kBAAkB,EAAEmE,mBAAmB,GAAGC,qBAAqB,IAAI1I,WAAW,GAAGrB,kBAAkB,CAAC,EAAE,GAAG,EAAE,GAAGsB,kBAAkB,GAAGzB,qBAAqB,CAAC,EAAE,EAAE,EAAE,GAAGC,oBAAoB,CAAC,EAAE,GAAG,EAAE,GAAGyB,kBAAkB,GAAGP,kBAAkB,IAAI+E,4BAA4B,EAAEC,4BAA4BH,GAAEM,eAAe,EAAE6D,eAAenE,GAAEK,yBAAyB,EAAE+D,cAAc,GAAG5D,mBAAmB,GAAGE,wBAAwB,GAAGD,sBAAsB,IAAI/I,GAAEvE,KAAKmB,IAAIzB,YAAE,KAAKmP,GAAE9O,cAAI+O,GAAE/O,cAAIiP,GAAE5O,cAAI6O,GAAE7O,cAAI+O,GAAE/O,c,cCAxgc,IAAIL,GAAE,cAAcvC,YAAEL,OAAIT,YAAYC,GAAGC,MAAMD,GAAGE,KAAKqU,UAAU,KAAKrU,KAAKgL,KAAK,6BAA6BhL,KAAKwB,OAAO,KAAa,SAAC1B,GAAGE,KAAKqU,UAAUvU,EAAU,WAAG,OAAOF,YAAEI,KAAKqU,UAAUrU,KAAKsU,cAA0B,eAAG,OAAOtU,KAAKuU,cAActF,SAAkC,4BAAG,OAAOjP,KAAKuU,cAAcrF,sBAA+C,0BAACpP,GAAGE,KAAKuU,cAAcrF,sBAAsBpP,EAAiC,kCAAG,OAAOE,KAAKuU,cAAcpF,4BAAwD,+BAAG,OAAOnP,KAAKuU,cAAcnF,yBAAqD,6BAACtP,GAAGE,KAAKuU,cAAcnF,yBAAyBtP,EAA0C,2CAAG,OAAOE,KAAKuU,cAAcC,qCAA6E,yCAAC1U,GAAGE,KAAKuU,cAAcC,qCAAqC1U,EAAoC,qCAAG,OAAOE,KAAKuU,cAAclF,+BAAiE,mCAACvP,GAAGE,KAAKuU,cAAclF,+BAA+BvP,EAAqB,sBAAG,OAAOE,KAAKuU,cAAc5E,OAAOvN,OAAOsQ,KAA4B,0BAAG,OAAO1S,KAAKuU,cAAc5E,OAAO1N,WAAWyQ,KAA0B,wBAAG,OAAO1S,KAAKuU,cAAc5E,OAAOpN,SAASmQ,KAAiB,eAAG,OAAO1S,KAAKuU,cAAcE,SAAShU,aAAa,MAAMX,EAAEE,KAAKY,KAAKhB,EAAEI,KAAK6B,MAAM7B,KAAKuU,cAAc,IAAIzR,GAAE,CAAClC,KAAKd,EAAE+B,MAAMjC,EAAE0P,UAAUtP,OAAOA,KAAK0U,oBAAoB,IAAI5S,EAAE,CAAClB,KAAKd,EAAE+B,MAAMjC,EAAE8B,SAAS1B,OAAOc,UAAUO,YAAErB,KAAK0U,qBAAqBrT,YAAErB,KAAKuU,eAAepD,YAAY,OAAOnR,KAAKuU,cAAcpD,YAAYwD,eAAe,OAAO3U,KAAKuU,cAAcI,iBAAiB7U,YAAE,CAACM,YAAEyC,MAAIK,GAAEsB,UAAU,oBAAe,GAAQ1E,YAAE,CAACM,eAAK8C,GAAEsB,UAAU,iBAAY,GAAQ1E,YAAE,CAACM,eAAK8C,GAAEsB,UAAU,qBAAgB,GAAQ1E,YAAE,CAACM,eAAK8C,GAAEsB,UAAU,2BAAsB,GAAQ1E,YAAE,CAACM,eAAK8C,GAAEsB,UAAU,YAAO,GAAQ1E,YAAE,CAACM,eAAK8C,GAAEsB,UAAU,OAAO,MAAM1E,YAAE,CAACM,eAAK8C,GAAEsB,UAAU,aAAQ,GAAQ1E,YAAE,CAACM,eAAK8C,GAAEsB,UAAU,cAAS,GAAQ1E,YAAE,CAACM,YAAE,CAACkT,UAAS,KAAMpQ,GAAEsB,UAAU,WAAW,MAAM1E,YAAE,CAACM,eAAK8C,GAAEsB,UAAU,wBAAwB,MAAM1E,YAAE,CAACM,YAAE,CAACkT,UAAS,KAAMpQ,GAAEsB,UAAU,8BAA8B,MAAM1E,YAAE,CAACM,eAAK8C,GAAEsB,UAAU,2BAA2B,MAAM1E,YAAE,CAACM,eAAK8C,GAAEsB,UAAU,uCAAuC,MAAM1E,YAAE,CAACM,eAAK8C,GAAEsB,UAAU,iCAAiC,MAAM1E,YAAE,CAACM,YAAE,CAACkT,UAAS,KAAMpQ,GAAEsB,UAAU,kBAAkB,MAAM1E,YAAE,CAACM,YAAE,CAACkT,UAAS,KAAMpQ,GAAEsB,UAAU,sBAAsB,MAAM1E,YAAE,CAACM,YAAE,CAACkT,UAAS,KAAMpQ,GAAEsB,UAAU,oBAAoB,MAAM1E,YAAE,CAACM,eAAK8C,GAAEsB,UAAU,WAAW,MAAMtB,GAAEpD,YAAE,CAACiB,YAAE,0DAA0DmC,IAAG,IAAIM,GAAEN,GAAiBM,c,iCCJp0G,uFAI8K,SAASV,IAAI,MAAMA,EAAE,IAAIlD,IAAEkD,EAAE8R,OAAOC,SAASnU,IAAI,OAAO,QAAQA,IAAI,OAAO,QAAQA,IAAI,QAAQ,SAASoC,EAAEgS,WAAWpU,IAAI,WAAW,QAAQoC,EAAEgS,WAAWpU,IAAI,SAAS,QAAQoC,EAAEgS,WAAWpU,IAAI,MAAM,QAAQoC,EAAEgS,WAAWpU,IAAI,UAAU,SAASoC,EAAEiS,SAASrU,IAAI,MAAM,QAAQoC,EAAEiS,SAASrU,IAAI,UAAU,SAASoC,EAAEiS,SAASrU,IAAI,UAAU,SAASoC,EAAE8R,OAAOI,KAAKtU,IAAIZ,GAAE;;;;;;;IAOhhBgD,EAAEmS,SAASJ,SAASnU,IAAI,cAAc,SAASA,IAAI,eAAe,QAAQA,IAAI,eAAe,SAASA,IAAI,kBAAkB,QAAQA,IAAI,iBAAiB,QAAQ,MAAMmC,EAAE,EAAEM,KAAK+R,KAAK,GAAG,OAAOpS,EAAEmS,SAASD,KAAKtU,IAAIZ,GAAE;8BAC3LA,IAAEqV,MAAMtS;;;;;;;;;;;;;;;;;;;;;;;;KAwBjCC,EAAE,IAAID,EAAEuS,OAAOC,OAAO,CAACC,UAAU,KAAK1Q,MAAM9B","file":"static/js/92.dcf6f386.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import t from\"../../../../../core/Accessor.js\";import s from\"../../../../../core/Handles.js\";import{rad2deg as i,acosClamped as r,deg2rad as o}from\"../../../../../core/mathUtils.js\";import{destroyMaybe as a,isNone as n}from\"../../../../../core/maybe.js\";import c from\"../../../../../core/Quantity.js\";import{whenOnce as l}from\"../../../../../core/watchUtils.js\";import{property as m}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as p}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{reactionInit as d}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{i as h}from\"../../../../../chunks/vec3.js\";import{c as u}from\"../../../../../chunks/vec3f64.js\";import{geodesicLength as f}from\"../../../../../geometry/geometryEngine.js\";import _ from\"../../../../../geometry/Polyline.js\";import{canProjectWithoutEngine as g,projectPointToVector as j,projectPointToWGS84ComparableLonLat as y}from\"../../../../../geometry/projection.js\";import{getSphericalPCPF as v,getReferenceEllipsoid as w,SphericalECEFSpatialReference as D,WGS84ECEFSpatialReference as z}from\"../../../../../geometry/projectionEllipsoid.js\";import{isSupported as P,geodesicLengths as b,inverseGeodeticSolver as M}from\"../../../../../geometry/support/geodesicUtils.js\";import{UnitNormalizer as k}from\"../support/UnitNormalizer.js\";let A=class extends t{constructor(e){super(e),this._unitNormalizer=new k,this._handles=new s,this._tempStartPosition=u(),this._tempEndPosition=u(),this._tempCornerPosition=u()}initialize(){this._handles.add(l(this.view,\"ready\",(()=>this._initialize()),!0))}destroy(){this._handles=a(this._handles)}_initialize(){const e=this.view.spatialReference,t=v(e),s=t===D?z:t;this._sphericalPCPF=s;const i=g(e,s);this._unitNormalizer.spatialReference=i?s:e,this._handles.add(d((()=>({result:this._computedResult,viewData:this.viewData})),(({result:e,viewData:t})=>{t.result=e})))}get _computedResult(){const{startPoint:e,endPoint:t}=this.layer;if(n(e)||n(t))return null;const s=this._euclideanDistances(e,t),i=this._exactGeodesicDistanceAndAngle(e,t,s.horizontal.value);return{directDistance:s.direct,horizontalDistance:s.horizontal,verticalDistance:s.vertical,geodesicDistance:i.distance,geodesicAngle:i.angle}}_euclideanDistances(e,t){const s=e.clone();s.z=t.z;const i=this._tempStartPosition,r=this._tempEndPosition,o=this._tempCornerPosition,a=this.view.spatialReference,n=this._sphericalPCPF,l=g(a,n)?n:a;j(e,i,l),j(t,r,l),j(s,o,l);const m=h(i,r),p=h(o,r),d=Math.abs(t.z-e.z),u=e=>this._unitNormalizer.normalizeDistance(e),f=u(m),_=u(p),y=u(d);return{direct:new c(f,\"meters\"),horizontal:new c(_,\"meters\"),vertical:new c(y,\"meters\")}}_exactGeodesicDistanceAndAngle(e,t,s){const i=e.spatialReference,r=new _({spatialReference:i});r.addPath([e,t]);const o=i.isGeographic&&P(i)?b([r],\"meters\")[0]:i.isWebMercator?f(r,\"meters\"):void 0,{distance:a,angle:n}=o?{distance:o,angle:this._fallbackGeodesicAngle(o,i)}:this._fallbackGeodesicDistance(e,t,s);return{distance:new c(a,\"meters\"),angle:new c(n,\"degrees\")}}_fallbackGeodesicAngle(e,t){return e/w(t).metersPerDegree}_fallbackGeodesicDistance(e,t,s){if(y(e,R)){y(t,G);const e=o(R[0]),s=o(R[1]),a=o(G[0]),n=o(G[1]),c=Math.abs(a-e),l=r(Math.sin(s)*Math.sin(n)+Math.cos(s)*Math.cos(n)*Math.cos(c)),m=i(l),p={distance:0};return M(p,[R[0],R[1]],[G[0],G[1]]),{distance:p.distance,angle:m}}const a=e.spatialReference,n=s;return{distance:n,angle:this._fallbackGeodesicAngle(n,a)}}};e([m()],A.prototype,\"view\",void 0),e([m()],A.prototype,\"layer\",void 0),e([m()],A.prototype,\"viewData\",void 0),e([m()],A.prototype,\"_computedResult\",null),A=e([p(\"esri.views.3d.layers.analysis.DirectLineMeasurement/DirectLineMeasurementController\")],A);const R=u(),G=u();export{A as DirectLineMeasurementController};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../../chunks/tslib.es6.js\";import{bindProjectionMatrix as e,bindView as o}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as t}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as i}from\"../core/shaderTechnique/ShaderTechnique.js\";import{ShaderTechniqueConfiguration as s,parameter as n}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{Default3D as a}from\"../lib/DefaultVertexAttributeLocations.js\";import{Program as m}from\"../lib/Program.js\";import{M as p}from\"../../../../chunks/MeasurementArrow.glsl.js\";import{makePipelineState as l,defaultDepthWriteParams as f,defaultColorWriteParams as h}from\"../../../webgl/renderState.js\";class d extends i{constructor(r,e,o){super(r,e,o)}initializeProgram(r){const e=d.shader.get().build();return new m(r.rctx,e,a)}bindPass(r,o){e(this.program,o.camera.projectionMatrix),this.program.setUniform1f(\"width\",r.width),this.program.setUniform1f(\"outlineSize\",r.outlineSize),this.program.setUniform4fv(\"outlineColor\",r.outlineColor),this.program.setUniform1f(\"stripeLength\",r.stripeLength),this.program.setUniform4fv(\"stripeEvenColor\",r.stripeEvenColor),this.program.setUniform4fv(\"stripeOddColor\",r.stripeOddColor)}bindDraw(r){o(this.program,r),this.program.rebindTextures()}initializePipeline(){return l({polygonOffset:this.configuration.polygonOffsetEnabled&&{factor:0,units:-4},depthTest:{func:513},depthWrite:f,colorWrite:h})}get primitiveType(){return 5}}d.shader=new t(p,(()=>import(\"./MeasurementArrow.glsl.js\")));class u extends s{constructor(){super(...arguments),this.polygonOffsetEnabled=!1}}r([n()],u.prototype,\"polygonOffsetEnabled\",void 0);export{d as MeasurementArrowTechnique,u as MeasurementArrowTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{s as e,n as t,f as s,c as r,i,m as o}from\"../../../../chunks/vec3.js\";import{c as n}from\"../../../../chunks/vec3f64.js\";import{newLayout as a}from\"../../support/buffer/InterleavedLayout.js\";import c from\"../lib/GLMaterial.js\";import{Material as u,materialParametersDefaults as f}from\"../lib/Material.js\";import{MeasurementArrowTechniqueConfiguration as l,MeasurementArrowTechnique as p}from\"../shaders/MeasurementArrowTechnique.js\";class h extends u{constructor(e){super(e,d),this.techniqueConfig=new l}getTechniqueConfig(){return this.techniqueConfig.polygonOffsetEnabled=this.params.polygonOffset,this.techniqueConfig}dispose(){}getPassParameters(){return this.params}intersect(){}createBufferWriter(){return new w}getGLMaterial(e){return 0===e.output?new m(e):void 0}}class m extends c{constructor(e){super(e),this.updateParameters()}updateParameters(){this._technique=this._techniqueRep.releaseAndAcquire(p,this._material.getTechniqueConfig(),this._technique)}beginSlot(e){return 3===e}bind(e){this._technique.bindPass(this._material.getPassParameters(),e)}}const d={width:32,outlineSize:.2,outlineColor:[1,.5,0,1],stripeLength:1,stripeEvenColor:[1,1,1,1],stripeOddColor:[1,.5,0,1],polygonOffset:!1,...f},g=a().vec3f(\"position\").vec3f(\"normal\").vec2f(\"uv0\").f32(\"auxpos1\"),v=n(),q=n(),b=n(),x=n(),C=n();class w{constructor(){this.vertexBufferLayout=g}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return 2*(e.indices.get(\"position\").length/2+1)}write(n,a,c,u){const f=a.vertexAttributes.get(\"position\").data,l=a.vertexAttributes.get(\"normal\").data,p=f.length/3,h=a&&a.indices&&a.indices.get(\"position\");h&&h.length!==2*(p-1)&&console.warn(\"MeasurementArrowMaterial does not support indices\");const m=v,d=q,g=b,w=x,P=C,j=n.transformation,y=n.invTranspTransformation,A=c.position,L=c.normal,M=c.uv0;let _=0;for(let v=0;v<p;++v){const n=3*v;if(e(m,f[n],f[n+1],f[n+2]),v<p-1){const i=3*(v+1);e(d,f[i],f[i+1],f[i+2]),e(P,l[i],l[i+1],l[i+2]),t(P,P),s(g,d,m),t(g,g),r(w,P,g),t(w,w)}const a=i(m,d);j&&y&&(o(m,m,j),o(d,d,j),o(w,w,y));const c=u+2*v,h=c+1;A.setVec(c,m),A.setVec(h,m),L.setVec(c,w),L.setVec(h,w),M.set(c,0,_),M.set(c,1,-1),M.set(h,0,_),M.set(h,1,1),v<p-1&&(_+=a)}const T=c.auxpos1;for(let e=0;e<2*p;++e)T.set(u+e,_)}}export{h as MeasurementArrowMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Handles.js\";import{isNone as r,isSome as t}from\"../../../../core/maybe.js\";import{c as s}from\"../../../../chunks/mat4f64.js\";import{f as i}from\"../../../../chunks/vec3.js\";import{c as a}from\"../../../../chunks/vec3f64.js\";import{sv3d as o}from\"../../../../geometry/support/vectorStacks.js\";import{Object3DVisualElement as n}from\"./Object3DVisualElement.js\";import h from\"../../webgl-engine/lib/GeometryUtil.js\";import{MeasurementArrowMaterial as l}from\"../../webgl-engine/materials/MeasurementArrowMaterial.js\";class d extends n{constructor(e){super(e),this._parameters=c,this._handles=null,this._origin=a(),this._originTransform=s(),this._arrowCenter=a(),this._renderOccluded=4,this._geometry=null,this._stripeLength=1,this._stripesEnabled=!0,this.applyProps(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._arrowMaterial&&this._arrowMaterial.setParameterValues({renderOccluded:e}))}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.geometryChanged()}get stripeLength(){return this._stripeLength}set stripeLength(e){this._stripeLength=e,this.attached&&this._arrowMaterial.setParameterValues({stripeLength:this._stripeLength})}get stripesEnabled(){return this._stripesEnabled}set stripesEnabled(e){if(this._stripesEnabled=e,this.attached){const e=this._stripesEnabled?this._parameters.arrowStripeEvenColor:this._parameters.arrowStripeOddColor;this._arrowMaterial.setParameterValues({stripeEvenColor:e})}}createExternalResources(){const r=this._stripesEnabled?this._parameters.arrowStripeEvenColor:this._parameters.arrowStripeOddColor;this._arrowMaterial=new l({outlineColor:this._parameters.arrowOutlineColor,stripeEvenColor:r,stripeOddColor:this._parameters.arrowStripeOddColor,renderOccluded:this.renderOccluded,polygonOffset:!0}),this._handles=new e,this._handles.add(this.view.state.watch(\"camera\",(()=>{this.viewChanged()})))}destroyExternalResources(){this._arrowMaterial=null,this._handles.destroy(),this._handles=null}forEachExternalMaterial(e){e(this._arrowMaterial)}createGeometries(e){if(r(this._geometry)||r(this._geometry.startRenderSpace)||r(this._geometry.endRenderSpace))return;const t=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);e.addGeometry(t,this._arrowMaterial,this._originTransform),this.viewChanged()}_createArrowGeometry(e,r,t,s){const a=this.view.renderCoordsHelper,n=[],l=[],d=(e,r)=>{const s=o.get();i(s,e,t),n.push(s),l.push(r)};if(\"euclidean\"===s.type){s.eval(.5,this._arrowCenter);const t=o.get();a.worldUpAtPosition(this._arrowCenter,t),d(e,t),d(r,t)}else{s.eval(.5,this._arrowCenter);const e=this._parameters.arrowSubdivisions+1&-2;for(let r=0;r<e;++r){const t=r/(e-1),i=o.get(),n=o.get();s.eval(t,i),a.worldUpAtPosition(i,n),d(i,n)}}return h.createPolylineGeometry(n,l)}geometryChanged(){this.recreateGeometry()}viewChanged(){if(this.view.ready&&this.attached&&t(this._geometry)){const e=this.view.state.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameterValues({width:this._parameters.arrowWidth*e})}}}const c={arrowWidth:16,arrowOutlineColor:[1,.5,0,1],arrowOutlineWidth:.2,arrowStripeEvenColor:[1,1,1,1],arrowStripeOddColor:[1,.5,0,1],arrowStripeLength:16,arrowSubdivisions:128};export{d as MeasurementArrowVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Handles.js\";import{isSome as t}from\"../../../../core/maybe.js\";import{i,t as r,s}from\"../../../../chunks/mat4.js\";import{c as a}from\"../../../../chunks/mat4f64.js\";import{i as o,n as l,f as n,g as u,b as h}from\"../../../../chunks/vec3.js\";import{c as d}from\"../../../../chunks/vec3f64.js\";import{c}from\"../../../../chunks/vec4.js\";import{f as _}from\"../../../../chunks/vec4f32.js\";import{sv3d as m}from\"../../../../geometry/support/vectorStacks.js\";import{Object3DVisualElement as p}from\"./Object3DVisualElement.js\";import{Geometry as M}from\"../../webgl-engine/lib/Geometry.js\";import f from\"../../webgl-engine/lib/GeometryUtil.js\";import{ColorMaterial as g}from\"../../webgl-engine/materials/ColorMaterial.js\";import{RibbonLineMaterial as O}from\"../../webgl-engine/materials/RibbonLineMaterial.js\";class y extends p{constructor(t){super(t),this._handles=new e,this._quadMaterial=null,this._outlineMaterial=null,this._maxSize=0,this._position=d(),this._up=d(),this._right=d(),this._renderOccluded=4,this._color=_(1,0,0,1),this._outlineColor=_(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=16,this.applyProps(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){c(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){c(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){const t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry({previous:e,center:t,next:i}){this._maxSize=Math.min(o(t,e),o(t,i))/3,l(this._up,n(this._up,e,t)),l(this._right,n(this._right,i,t)),u(this._position,t),this.recreateGeometry()}createExternalResources(){this._quadMaterial=new g(this.quadMaterialParameters),this._outlineMaterial=new O(this.outlineMaterialParameters),this._handles.add(this.view.state.watch(\"camera\",(()=>this._updateTransform())))}destroyExternalResources(){this._quadMaterial=null,this._outlineMaterial=null,this._handles.removeAll()}forEachExternalMaterial(e){e(this._quadMaterial),e(this._outlineMaterial)}createGeometries(e){this._createQuadGeometry(e),this._createOutlineGeometry(e),this._updateTransform(e)}_createQuadGeometry(e){const t=this._quadGeometryData(this._up,this._right);e.addGeometry(t,this._quadMaterial)}_createOutlineGeometry(e){if(0===this._outlineSize)return;const t=h(m.get(),this._up,this._right),i=f.createPolylineGeometry([this._up,t,this._right]);e.addGeometry(i,this._outlineMaterial)}_updateTransform(e=this.object){const a=this.view.state.camera,o=this._size*a.computeScreenPixelSizeAt(this._position),l=Math.min(this._maxSize,o);i(z),r(z,z,this._position),s(z,z,[l,l,l]),t(e)&&(e.transformation=z)}_quadGeometryData(e,t){const i=h(m.get(),e,t);return new M([[\"position\",{size:3,data:[0,0,0,...t,...e,...i],exclusive:!0}]],[[\"position\",new Uint16Array([0,1,2,1,2,3])]])}get quadMaterialParameters(){return{color:this._color,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded}}_updateQuadMaterial(){this._quadMaterial&&this._quadMaterial.setParameterValues(this.quadMaterialParameters)}get outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded}}_updateOutlineMaterial(){this._outlineMaterial&&this._outlineMaterial.setParameterValues(this.outlineMaterialParameters)}}const z=a();export{y as RightAngleQuadVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../intl.js\";import t from\"../../../../../core/Accessor.js\";import i from\"../../../../../core/Handles.js\";import{nextHighestPowerOfTen as s,sign as n,deg2rad as r}from\"../../../../../core/mathUtils.js\";import{isSome as a,isNone as o,destroyMaybe as l}from\"../../../../../core/maybe.js\";import{formatDecimal as h,formatDMS as c,formatImperialLength as d,formatImperialVerticalLength as u,formatMetricLength as m,formatMetricVerticalLength as g}from\"../../../../../core/quantityFormatUtils.js\";import{createRenderScreenPointArray3 as p,createRenderScreenPointArray as _}from\"../../../../../core/screenUtils.js\";import{preferredImperialLengthUnit as v,convertUnit as b}from\"../../../../../core/unitUtils.js\";import{whenOnce as L}from\"../../../../../core/watchUtils.js\";import{property as w}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as y}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{autorun as S}from\"../../../../../core/accessorSupport/trackingUtils.js\";import{h as f}from\"../../../../../chunks/vec2.js\";import{a as z,b as V}from\"../../../../../chunks/vec3.js\";import{c as E}from\"../../../../../chunks/vec3f64.js\";import{f as j}from\"../../../../../chunks/vec4f32.js\";import{getReferenceEllipsoid as P}from\"../../../../../geometry/projectionEllipsoid.js\";import{LabelVisualElement as D,mirrorPosition as A}from\"../../../interactive/visualElements/LabelVisualElement.js\";import{LineVisualElement as M}from\"../../../interactive/visualElements/LineVisualElement.js\";import{MeasurementArrowVisualElement as O}from\"../../../interactive/visualElements/MeasurementArrowVisualElement.js\";import{RightAngleQuadVisualElement as C}from\"../../../interactive/visualElements/RightAngleQuadVisualElement.js\";import{GeodesicSegment as x,EuclideanSegment as G}from\"../../../interactive/visualElements/support/Segment.js\";import{screenSpaceTangent as H}from\"../support/viewUtils.js\";import{createStipplePatternSimple as k}from\"../../../webgl-engine/materials/lineStippleUtils.js\";import{onLocaleChange as R}from\"../../../../../intl/locale.js\";import{fetchMessageBundle as T}from\"../../../../../intl/messages.js\";let U=class extends t{constructor(e){super(e),this._params={...Q},this._handles=new i,this._segmentVisualElement=null,this._triangleVisualElement=null,this._rightAngleQuad=null,this._projectedGeodesicLine=null,this._geodesicStartHint=null,this._geodesicEndHint=null,this._segmentLabel=null,this._verticalLabel=null,this._horizontalLabel=null,this._startPosition=E(),this._endPosition=E(),this._cornerPosition=E(),this._startPositionAtSeaLevel=E(),this._endPositionAtSeaLevel=E(),this._state=0,this._segmentLabelDisplayedMeasurement=1,this._triangleOrientationOverride=null,this.messages=null,this.viewMode=0,this.visualizedMeasurement=0,this.actualVisualizedMeasurement=1,this.visualElementOrientation=0,this.triangleCollapseRatioThreshold=.03}get _geodesicDistanceExceeded(){var e;const t=this.layerView.result;return a(t)&&(null==(e=t.horizontalDistance)?void 0:e.value)>this.layer.geodesicDistanceThreshold}get ready(){return 1===this._state}get visible(){return this.layerView.visible&&!this.layerView.suspended}get allowVisualElementsOrientationChange(){return o(this._triangleOrientationOverride)}set allowVisualElementsOrientationChange(e){o(this._triangleOrientationOverride)!==e&&(o(this._triangleOrientationOverride)?this._triangleOrientationOverride=this._getActualVisualElementsOrientation():this._triangleOrientationOverride=null)}get labels(){return 2===this.actualVisualizedMeasurement?{direct:this._horizontalLabel,horizontal:this._segmentLabel,vertical:this._verticalLabel}:{direct:this._segmentLabel,horizontal:this._horizontalLabel,vertical:this._verticalLabel}}get testData(){return{labels:this.labels,stripeLength:this._segmentVisualElement.stripeLength}}initialize(){this._handles.add(L(this.view,\"ready\",(()=>this._initialize()),!0))}_initialize(){switch(this._state){case 1:throw new Error(\"invalid state\");case 2:return}const e=this._params,t={attached:!0,view:this.view};this._segmentVisualElement=new O({...t,geometry:null,renderOccluded:4}),this._triangleVisualElement=new M({...t,width:e.triangleLineWidth,color:e.triangleColor,renderOccluded:4}),this._rightAngleQuad=new C({...t,color:W,renderOccluded:4});const i={...t,polygonOffset:!0,stippleIntegerRepeats:!1,renderOccluded:4};this._projectedGeodesicLine=new M({...i,width:e.geodesicProjectionLineWidth,color:e.geodesicProjectionLineColor,stipplePattern:k(e.guideStippleLengthPixels)}),this._geodesicStartHint=new M({...i,width:e.guideLineWidth,color:e.geodesicProjectionLineColor,stipplePattern:k(e.guideStippleLengthPixels)}),this._geodesicEndHint=new M({...i,width:e.guideLineWidth,color:e.geodesicProjectionLineColor,stipplePattern:k(e.guideStippleLengthPixels)}),this._segmentLabel=new D({...t,fontSize:e.direcLabelFontSize}),this._verticalLabel=new D({...t,fontSize:e.verticalLabelFontSize}),this._horizontalLabel=new D({...t,fontSize:e.horizontalLabelFontSize}),this._handles.add([S((()=>this._updateGeometryAndViewMode())),S((()=>this._updateVisualElementVisibility())),S((()=>this._updateLabelText())),S((()=>this._updateLabelVisibility())),S((()=>this._updateSegmentStripeLength())),R((async()=>this._updateMessageBundle()))]),this._state=1,this._updateMessageBundle()}destroy(){2!==this._state&&(this._handles=l(this._handles),this._segmentVisualElement=l(this._segmentVisualElement),this._triangleVisualElement=l(this._triangleVisualElement),this._rightAngleQuad=l(this._rightAngleQuad),this._projectedGeodesicLine=l(this._projectedGeodesicLine),this._geodesicStartHint=l(this._geodesicStartHint),this._geodesicEndHint=l(this._geodesicEndHint),this._segmentLabel=l(this._segmentLabel),this._verticalLabel=l(this._verticalLabel),this._horizontalLabel=l(this._horizontalLabel),this.set(\"view\",null),this._state=2)}async whenReady(){await L(this,\"ready\")}async whenMessages(){await this.whenReady(),await L(this,\"messages\")}_updateVisualElementVisibility(){if(this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1,this.visible)switch(this.viewMode){case 0:break;case 1:this._segmentVisualElement.visible=!0;break;case 2:this._segmentVisualElement.visible=!0,this._triangleVisualElement.visible=!0,this._rightAngleQuad.visible=!0;break;case 3:this._segmentVisualElement.visible=!0,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}}_updateGeometryAndViewMode(){const e=this.view.renderCoordsHelper,{startPoint:t,endPoint:i}=this.layer;if(o(t)||o(i)||t.equals(i)){this.viewMode=0;const e=this.visualizedMeasurement,t=0===e;return void(this.actualVisualizedMeasurement=t?1:e)}e.toRenderCoords(t,this._startPosition),e.toRenderCoords(i,this._endPosition);const s=this._getActualVisualElementsOrientation(),n=this._updateActualVisualizedMeasurement();this.viewMode=this._computeViewMode(n);let r=this._startPosition,a=this._endPosition;const l=1===s?1:-1,h=l*(e.getAltitude(a)-e.getAltitude(r));h<0&&(r=this._endPosition,a=this._startPosition);const c=2===n?new x(this._startPosition,this._endPosition,e.spatialReference):new G(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=c,this._updateSegmentStripeLength(),this._segmentLabelDisplayedMeasurement=n,this.viewMode){case 1:this._updateSegment(c,s);break;case 2:this._updateSegmentAndTriangle(c,s,r,a,l,h);break;case 3:this._updateSegmentAndProjection(s)}}_updateSegment(e,t){this._segmentLabel.anchor=1===t?\"top\":\"bottom\",this._segmentLabel.geometry={type:\"segment\",segment:e,sampleLocation:\"center\"}}_updateSegmentAndTriangle(e,t,i,s,n,r){const a=this.view,o=a.renderCoordsHelper,l=a.state.camera,h=this._cornerPosition;o.worldUpAtPosition(i,h),z(h,h,n*Math.abs(r)),V(h,h,i),this._triangleVisualElement.geometry=[[[i[0],i[1],i[2]],[h[0],h[1],h[2]],[s[0],s[1],s[2]]]],this._rightAngleQuad.geometry={previous:i,center:h,next:s};const c=new G(i,h),d=new G(h,s),u=F(i,s,h,t,l);this._segmentLabel.anchor=u.segment,this._segmentLabel.geometry={type:\"segment\",segment:e,sampleLocation:\"center\"},this._verticalLabel.geometry={type:\"segment\",segment:c,sampleLocation:\"center\"},this._verticalLabel.anchor=u.vertical,this._horizontalLabel.geometry={type:\"segment\",segment:d,sampleLocation:\"center\"},this._horizontalLabel.anchor=u.horizontal}_updateSegmentAndProjection(e){const t=this.view.renderCoordsHelper;t.setAltitude(this._startPositionAtSeaLevel,0,this._startPosition),t.setAltitude(this._endPositionAtSeaLevel,0,this._endPosition);const i=new x(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,t.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(i),this._geodesicStartHint.setGeometryFromSegment(new G(this._startPositionAtSeaLevel,this._startPosition)),this._geodesicEndHint.setGeometryFromSegment(new G(this._endPositionAtSeaLevel,this._endPosition)),this._segmentLabel.geometry={type:\"segment\",segment:i,sampleLocation:\"center\"},this._segmentLabel.anchor=1===e?\"top\":\"bottom\"}_updateLabelText(){if(1!==this._state)return;const e=this._segmentLabel,t=this._horizontalLabel,i=this._verticalLabel,s=this.messages,n=this.layerView.result;if(o(n)||o(s))return e.text=null,t.text=null,void(i.text=null);const r=this._getLabelsText(s,n),a=1===this._segmentLabelDisplayedMeasurement;e.text=a?r.euclideanDistance:r.geodesicDistance,t.text=r.horizontalDistance,i.text=r.verticalDistance,this.notifyChange(\"labels\")}_updateLabelVisibility(){if(1!==this._state)return;const e=this._segmentLabel,t=this._horizontalLabel,i=this._verticalLabel;if(e.visible=!1,t.visible=!1,i.visible=!1,this.visible)switch(this.viewMode){case 1:e.visible=!0;break;case 2:e.visible=!0,t.visible=!0,i.visible=!0;break;case 3:e.visible=!0}}_getLabelsText(e,{directDistance:t,horizontalDistance:i,verticalDistance:s,geodesicDistance:n,geodesicAngle:r}){const a=this.layerView.unit,o=e=>({euclideanDistance:\"\",geodesicDistance:\"\",horizontalDistance:\"\",verticalDistance:\"\",...e});switch(a){case\"metric\":return o({euclideanDistance:t&&m(e,t),geodesicDistance:n&&m(e,n),horizontalDistance:i&&m(e,i),verticalDistance:s&&g(e,s)});case\"imperial\":return o({euclideanDistance:t&&d(e,t),geodesicDistance:n&&d(e,n),horizontalDistance:i&&d(e,i),verticalDistance:s&&u(e,s)});case\"degrees\":{const t=r&&h(e,r,\"degrees\");return o({euclideanDistance:t,geodesicDistance:t,horizontalDistance:t})}case\"degrees-minutes-seconds\":return o({horizontalDistance:r&&c(r)});default:return o({euclideanDistance:t&&h(e,t,a),geodesicDistance:n&&h(e,n,a),horizontalDistance:i&&h(e,i,a),verticalDistance:s&&h(e,s,a)})}}_updateSegmentStripeLength(){const e=this._measurementArrowStripeLength,t=this._segmentVisualElement;a(e)?(t.stripeLength=e,t.stripesEnabled=!0):t.stripesEnabled=!1}_computeViewMode(e){if(2===e){if(!this._geodesicDistanceExceeded)return 1;if(this._requiresGeodesicGuideAt(this._startPosition)||this._requiresGeodesicGuideAt(this._endPosition))return 3}const t=this.layerView.result;if(o(t))return 1;const{verticalDistance:i,horizontalDistance:s}=t,n=i.value,r=s.value;return Math.min(n/r,r/n)<this.triangleCollapseRatioThreshold?1:2}_getActualVisualElementsOrientation(){if(a(this._triangleOrientationOverride))return this._triangleOrientationOverride;const e=this.visualElementOrientation;return 0===e?this.view.state.camera.aboveGround?1:2:e}_updateActualVisualizedMeasurement(){if(0===this.visualizedMeasurement){this.actualVisualizedMeasurement=1;const e=this.layerView.unit;\"degrees\"!==e&&\"degrees-minutes-seconds\"!==e||(this.actualVisualizedMeasurement=2),this._geodesicDistanceExceeded&&(this.actualVisualizedMeasurement=2)}else this.actualVisualizedMeasurement=this.visualizedMeasurement;return this.actualVisualizedMeasurement}_requiresGeodesicGuideAt(e){const t=this.view;if(!t.state)return!1;const i=t.state.camera,s=t.renderCoordsHelper,n=i.computeScreenPixelSizeAt(e);return s.getAltitude(e)/n>=10}get _measurementArrowStripeLength(){const e=this.view,{result:t,unit:i}=this.layerView;let n=null;if(a(t)){const e=t.directDistance;switch(i){case\"metric\":n=e&&e.toUnit(\"meters\");break;case\"imperial\":n=e&&e.toUnit(v(e.value,e.unit));break;case\"degrees\":case\"degrees-minutes-seconds\":{const e=t.geodesicAngle;n=e&&e.toUnit(\"degrees\");break}default:n=e&&e.toUnit(i)}}if(n){let t=1;return t=s(n.value/30),t*=\"degrees\"===n.unit?P(e.spatialReference).metersPerDegree:b(1,n.unit,\"meters\"),t}return null}_updateMessageBundle(){T(\"esri/core/t9n/Units\").then((e=>{this.messages=e,this.view&&this._updateLabelText()}))}};function F(e,t,i,s,r){const a=B,o=I;r.projectToRenderScreen(i,a),r.projectToRenderScreen(t,o);const l={segment:\"bottom\",horizontal:\"top\",vertical:a[0]<o[0]?\"left\":\"right\"};{const s=J,a=K;if(H(e,i,s,r),H(e,t,a,r),f(s,a)>=q){const e=n(s[1])===n(a[1]);l.segment=e?A(l.vertical):l.vertical}else{const e=N;H(i,t,e,r),f(e,a)>=q&&(l.segment=n(e[0])===n(a[0])?A(l.horizontal):l.horizontal)}}if(2===s){const e=e=>\"top\"===e?\"bottom\":\"top\";l.segment=e(l.segment),l.horizontal=e(l.horizontal),l.vertical=e(l.vertical)}return l}e([w()],U.prototype,\"_state\",void 0),e([w()],U.prototype,\"_segmentLabelDisplayedMeasurement\",void 0),e([w()],U.prototype,\"_triangleOrientationOverride\",void 0),e([w()],U.prototype,\"_geodesicDistanceExceeded\",null),e([w()],U.prototype,\"messages\",void 0),e([w()],U.prototype,\"view\",void 0),e([w()],U.prototype,\"layer\",void 0),e([w()],U.prototype,\"layerView\",void 0),e([w({readOnly:!0})],U.prototype,\"ready\",null),e([w({readOnly:!0})],U.prototype,\"visible\",null),e([w()],U.prototype,\"viewMode\",void 0),e([w()],U.prototype,\"visualizedMeasurement\",void 0),e([w()],U.prototype,\"actualVisualizedMeasurement\",void 0),e([w()],U.prototype,\"visualElementOrientation\",void 0),e([w()],U.prototype,\"triangleCollapseRatioThreshold\",void 0),e([w()],U.prototype,\"allowVisualElementsOrientationChange\",null),e([w()],U.prototype,\"labels\",null),e([w()],U.prototype,\"testData\",null),e([w()],U.prototype,\"_measurementArrowStripeLength\",null),U=e([y(\"esri.views.3d.layers.DirectLineMeasurement.DirectLineMeasurementView\")],U);const W=j(1,.5,0,.75),Q={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:.75,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,triangleColor:W,triangleLineWidth:3,triangleCornerSize:32,triangleSubdivisions:128,arrowWidth:16,arrowOutlineColor:[1,.5,0,1],arrowOutlineWidth:.2,arrowStripeEvenColor:[1,1,1,1],arrowStripeOddColor:[1,.5,0,1],arrowStripeLength:16,arrowSubdivisions:128,geodesicProjectionLineWidth:2,geodesicProjectionLineColor:W,guideLineWidth:2,guideLineColor:W,guideStippleLengthPixels:6,labelDistance:25,direcLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12},q=Math.cos(r(12)),B=p(),I=p(),J=_(),K=_(),N=_();export{U as DirectLineMeasurementView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{unwrapOr as t,destroyMaybe as i}from\"../../../core/maybe.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{defaultUnitPropertyMetadata as r}from\"../../../properties/defaultUnit.js\";import{LayerView3D as l}from\"./LayerView3D.js\";import{DirectLineMeasurementController as n}from\"./analysis/DirectLineMeasurement/DirectLineMeasurementController.js\";import{DirectLineMeasurementView as o}from\"./analysis/DirectLineMeasurement/DirectLineMeasurementView.js\";import u from\"../../layers/LayerView.js\";let p=class extends(l(u)){constructor(e){super(e),this._userUnit=null,this.type=\"direct-line-measurement-3d\",this.result=null}set unit(e){this._userUnit=e}get unit(){return t(this._userUnit,this._defaultUnit)}get viewMode(){return this._analysisView.viewMode}get visualizedMeasurement(){return this._analysisView.visualizedMeasurement}set visualizedMeasurement(e){this._analysisView.visualizedMeasurement=e}get actualVisualizedMeasurement(){return this._analysisView.actualVisualizedMeasurement}get visualElementOrientation(){return this._analysisView.visualElementOrientation}set visualElementOrientation(e){this._analysisView.visualElementOrientation=e}get allowVisualElementsOrientationChange(){return this._analysisView.allowVisualElementsOrientationChange}set allowVisualElementsOrientationChange(e){this._analysisView.allowVisualElementsOrientationChange=e}get triangleCollapseRatioThreshold(){return this._analysisView.triangleCollapseRatioThreshold}set triangleCollapseRatioThreshold(e){this._analysisView.triangleCollapseRatioThreshold=e}get directLabelText(){return this._analysisView.labels.direct.text}get horizontalLabelText(){return this._analysisView.labels.horizontal.text}get verticalLabelText(){return this._analysisView.labels.vertical.text}get testData(){return this._analysisView.testData}initialize(){const e=this.view,t=this.layer;this._analysisView=new o({view:e,layer:t,layerView:this}),this._analysisController=new n({view:e,layer:t,viewData:this})}destroy(){i(this._analysisController),i(this._analysisView)}whenReady(){return this._analysisView.whenReady()}whenMessages(){return this._analysisView.whenMessages()}};e([s(r)],p.prototype,\"_defaultUnit\",void 0),e([s()],p.prototype,\"_userUnit\",void 0),e([s()],p.prototype,\"_analysisView\",void 0),e([s()],p.prototype,\"_analysisController\",void 0),e([s()],p.prototype,\"type\",void 0),e([s()],p.prototype,\"unit\",null),e([s()],p.prototype,\"layer\",void 0),e([s()],p.prototype,\"result\",void 0),e([s({readOnly:!0})],p.prototype,\"viewMode\",null),e([s()],p.prototype,\"visualizedMeasurement\",null),e([s({readOnly:!0})],p.prototype,\"actualVisualizedMeasurement\",null),e([s()],p.prototype,\"visualElementOrientation\",null),e([s()],p.prototype,\"allowVisualElementsOrientationChange\",null),e([s()],p.prototype,\"triangleCollapseRatioThreshold\",null),e([s({readOnly:!0})],p.prototype,\"directLabelText\",null),e([s({readOnly:!0})],p.prototype,\"horizontalLabelText\",null),e([s({readOnly:!0})],p.prototype,\"verticalLabelText\",null),e([s()],p.prototype,\"testData\",null),p=e([a(\"esri.views.3d.layers.DirectLineMeasurementLayerView3D\")],p);var y=p;export default y;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as t}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function o(){const o=new t;o.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\").add(\"width\",\"float\"),o.attributes.add(\"position\",\"vec3\"),o.attributes.add(\"normal\",\"vec3\"),o.attributes.add(\"uv0\",\"vec2\"),o.attributes.add(\"auxpos1\",\"float\"),o.varyings.add(\"vtc\",\"vec2\"),o.varyings.add(\"vlength\",\"float\"),o.varyings.add(\"vradius\",\"float\"),o.vertex.code.add(e`void main(void) {\nvec3 bitangent = normal;\nvtc = uv0;\nvlength = auxpos1;\nvradius = 0.5 * width;\nvec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);\ngl_Position = proj * pos;\n}`),o.fragment.uniforms.add(\"outlineSize\",\"float\").add(\"outlineColor\",\"vec4\").add(\"stripeLength\",\"float\").add(\"stripeEvenColor\",\"vec4\").add(\"stripeOddColor\",\"vec4\");const r=1/Math.sqrt(2);return o.fragment.code.add(e`\n    const float INV_SQRT2 = ${e.float(r)};\n\n    vec4 arrowColor(vec2 tc, float len) {\n      float d = INV_SQRT2 * (tc.x - abs(tc.y));\n      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));\n      d = min(d, 1.0 - abs(tc.y));\n\n      if (d < 0.0) {\n        return vec4(0.0);\n      } else if (d < outlineSize) {\n        return outlineColor;\n      } else {\n        return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;\n      }\n    }\n\n    void main(void) {\n      vec2 ntc = vec2(vtc.x / vradius, vtc.y);\n      vec4 color = arrowColor(ntc, vlength / vradius);\n      if (color.a == 0.0) {\n        discard;\n      }\n      gl_FragColor = color;\n    }\n  `),o}var r=Object.freeze({__proto__:null,build:o});export{r as M,o as b};\n"],"sourceRoot":""}