{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/layers/WMTSLayerView3D.js"],"names":["p","i","getLogger","c","h","l","a","n","constructor","super","arguments","this","type","initialize","e","r","view","then","t","basemapTerrain","tilingSchemeLocked","tilingScheme","layer","activeLayer","s","tileMatrixSet","tileInfo","_getTileInfoSupportError","fullExtent","_getTileInfoCompatibilityError","_getCompatibleTileMatrixSet","tileMatrixSetId","id","_set","addResolvingPromise","when","_initialized","refresh","emit","canResume","_getTileInfoError","suspended","updatingHandles","add","error","notifyChange","tileMatrixSets","find","readOnly","prototype","o","d"],"mappings":"2IAAA,uGAIuoB,MAAMA,EAAEC,IAAEC,UAAU,wCAAwC,IAAIC,EAAE,cAAcC,YAAEC,YAAEC,YAAEC,QAAMC,cAAcC,SAASC,WAAWC,KAAKC,KAAK,UAAkC,2BAAG,OAAM,EAAGC,aAAa,MAAMC,EAAEC,YAAEJ,KAAKK,KAAK,mCAAmCC,MAAM,KAAK,MAAMH,EAAE,IAAI,IAAII,IAAE,wCAAwC,sFAAsF,IAAIP,KAAKK,KAAKG,eAAeC,mBAAmB,MAAMN,IAAI,MAAMb,EAAEU,KAAKK,KAAKG,eAAeE,aAAaN,EAAEJ,KAAKW,MAAMC,YAAY,IAAIC,EAAE,GAAGT,GAAGA,EAAEU,cAAc,CAACD,EAAET,EAAEU,cAAc,MAAMX,EAAEU,EAAEE,SAASR,EAAEP,KAAKgB,yBAAyBb,EAAEU,EAAEI,aAAajB,KAAKkB,+BAA+Bf,EAAEb,GAAG,GAAGiB,EAAE,MAAMA,MAAM,CAAC,GAAGM,EAAEb,KAAKmB,+BAA+BN,EAAE,MAAMV,IAAIC,EAAEgB,gBAAgBP,EAAEQ,GAAGrB,KAAKsB,KAAK,WAAWT,EAAEE,UAAUf,KAAKsB,KAAK,aAAaT,EAAEI,YAAYjB,KAAKW,MAAMM,WAAWJ,EAAEI,cAAcjB,KAAKuB,oBAAoBpB,GAAGH,KAAKwB,MAAM,IAAIxB,KAAKyB,iBAAiBC,UAAU1B,KAAK2B,KAAK,gBAAgBC,YAAY,IAAI9B,MAAM8B,YAAY,OAAM,EAAG,MAAMzB,EAAEH,KAAKW,MAAMC,YAAYE,cAAc,OAAOX,IAAIH,KAAK6B,kBAAkB1B,EAAEY,SAASZ,EAAEc,YAA2B,kBAAGjB,KAAK8B,WAAW9B,KAAK2B,KAAK,gBAAgBF,eAAezB,KAAK+B,gBAAgBC,IAAIhC,KAAK,6BAA6B,IAAIA,KAAK0B,YAAY1B,KAAK+B,gBAAgBC,IAAIhC,KAAK,iBAAiB,IAAIA,KAAK0B,YAAY1B,KAAK+B,gBAAgBC,IAAIhC,KAAKW,MAAM,eAAeR,IAAI,IAAII,EAAEJ,EAAEW,cAAc,GAAGP,EAAE,CAAC,MAAMJ,EAAEH,KAAK6B,kBAAkBtB,EAAEQ,SAASR,EAAEU,YAAYd,IAAId,EAAE4C,MAAM,+DAA+D9B,GAAGI,EAAE,WAAWA,EAAEP,KAAKmB,8BAA8BZ,EAAEJ,EAAEiB,gBAAgBb,EAAEc,GAAGhC,EAAE4C,MAAM,+EAA+EjC,KAAKkC,aAAa,aAAalC,KAAK4B,aAAa5B,KAAK0B,aAAaP,8BAA8B,OAAOnB,KAAKW,MAAMC,YAAYuB,eAAeC,MAAMjC,IAAI,MAAMI,EAAEJ,EAAEY,SAAS,OAAOf,KAAK6B,kBAAkBtB,EAAEJ,EAAEc,eAAeY,kBAAkB1B,EAAEI,GAAG,OAAOP,KAAKgB,yBAAyBb,EAAEI,IAAIP,KAAKkB,+BAA+Bf,EAAEH,KAAKK,KAAKG,eAAeE,gBAAgBP,YAAE,CAACU,YAAE,CAACwB,UAAS,KAAM7C,EAAE8C,UAAU,uBAAuB,MAAMnC,YAAE,CAACU,eAAKrB,EAAE8C,UAAU,kBAAa,GAAQnC,YAAE,CAACU,eAAKrB,EAAE8C,UAAU,aAAQ,GAAQnC,YAAE,CAACU,eAAKrB,EAAE8C,UAAU,iBAAY,GAAQnC,YAAE,CAACU,eAAKrB,EAAE8C,UAAU,gBAAW,GAAQ9C,EAAEW,YAAE,CAACoC,YAAE,yCAAyC/C,GAAG,IAAIgD,EAAEhD,EAAiBgD","file":"static/js/176.c0a5e203.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import i from\"../../../core/Logger.js\";import{whenTrueOnce as r}from\"../../../core/watchUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView3D as a}from\"./LayerView3D.js\";import{TiledLayerView3D as l}from\"./TiledLayerView3D.js\";import n from\"../../layers/LayerView.js\";import{RefreshableLayerView as h}from\"../../layers/RefreshableLayerView.js\";const p=i.getLogger(\"esri.views.3d.layers.WMTSLayerView3d\");let c=class extends(h(l(a(n)))){constructor(){super(...arguments),this.type=\"wmts-3d\"}get hasMixedImageFormats(){return!0}initialize(){const e=r(this.view,\"basemapTerrain.tilingSchemeDone\").then((()=>{const e=()=>new t(\"layerview:no-compatible-tiling-scheme\",\"None of the tiling schemes supported by the service are compatible with the scene.\");if(!this.view.basemapTerrain.tilingSchemeLocked)throw e();const i=this.view.basemapTerrain.tilingScheme,r=this.layer.activeLayer;let s;if(r&&r.tileMatrixSet){s=r.tileMatrixSet;const e=s.tileInfo,t=this._getTileInfoSupportError(e,s.fullExtent)||this._getTileInfoCompatibilityError(e,i);if(t)throw t}else{if(s=this._getCompatibleTileMatrixSet(),!s)throw e();r.tileMatrixSetId=s.id}this._set(\"tileInfo\",s.tileInfo),this._set(\"fullExtent\",s.fullExtent),this.layer.fullExtent=s.fullExtent}));this.addResolvingPromise(e),this.when((()=>this._initialized()))}refresh(){this.emit(\"data-changed\")}canResume(){if(!super.canResume())return!1;const e=this.layer.activeLayer.tileMatrixSet;return e&&!this._getTileInfoError(e.tileInfo,e.fullExtent)}async doRefresh(){this.suspended||this.emit(\"data-changed\")}_initialized(){this.updatingHandles.add(this,\"layer.activeLayer.styleId\",(()=>this.refresh())),this.updatingHandles.add(this,\"tileMatrixSet\",(()=>this.refresh())),this.updatingHandles.add(this.layer,\"activeLayer\",(e=>{let t=e.tileMatrixSet;if(t){const e=this._getTileInfoError(t.tileInfo,t.fullExtent);e&&(p.error(\"The selected tile matrix set is not compatible with the view\",e),t=null)}else t=this._getCompatibleTileMatrixSet(),t?e.tileMatrixSetId=t.id:p.error(\"The layer does not provide a tiling scheme that is compatible with the view\");this.notifyChange(\"suspended\"),this.canResume()&&this.refresh()}))}_getCompatibleTileMatrixSet(){return this.layer.activeLayer.tileMatrixSets.find((e=>{const t=e.tileInfo;return!this._getTileInfoError(t,e.fullExtent)}))}_getTileInfoError(e,t){return this._getTileInfoSupportError(e,t)||this._getTileInfoCompatibilityError(e,this.view.basemapTerrain.tilingScheme)}};e([s({readOnly:!0})],c.prototype,\"hasMixedImageFormats\",null),e([s()],c.prototype,\"fullExtent\",void 0),e([s()],c.prototype,\"layer\",void 0),e([s()],c.prototype,\"suspended\",void 0),e([s()],c.prototype,\"tileInfo\",void 0),c=e([o(\"esri.views.3d.layers.WMTSLayerView3D\")],c);var d=c;export default d;\n"],"sourceRoot":""}