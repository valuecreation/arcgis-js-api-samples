{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/layers/GraphicsLayerView3D.js","../node_modules/@arcgis/core/views/3d/layers/support/projectExtentUtils.js","../node_modules/@arcgis/core/layers/graphics/centroid.js","../node_modules/@arcgis/core/chunks/quickselect.js","../node_modules/@arcgis/core/views/3d/webgl-engine/lib/Object3DStateSet.js","../node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DObjectStateSet.js","../node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DObjectStates.js","../node_modules/@arcgis/core/views/3d/layers/graphics/ExtentSet.js","../node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DElevationAlignment.js","../node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DGraphicLikeLayerView.js","../node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DFrustumVisibility.js"],"names":["g","h","u","constructor","super","arguments","this","type","frustumVisibility","n","slicePlaneEnabled","drapeSourceType","suspendResumeExtent","fullExtentInLocalViewSpatialReference","initialize","_set","o","owner","layer","scaleVisibilityEnabled","graphics3d","setup","setupSuspendResumeExtent","updatingHandles","add","graphicsCore","opacityChange","handles","on","i","graphicUpdateHandler","addResolvingPromise","d","then","internal","notifyChange","s","view","destroy","canResume","suspended","e","scaleVisibility","outsideScaleRange","outsideOfView","clientGraphics","notifyGraphicGeometryChanged","notifyGraphicVisibilityChanged","graphics3DGraphics","graphics3DGraphicsByObjectID","symbolUpdateType","getGraphicFromGraphicUid","whenGraphicBounds","computeAttachmentOrigin","getSymbolLayerSize","queryGraphics","Promise","resolve","loadedGraphics","maskOccludee","highlight","effectiveUpdatePolicy","isUpdating","updating","basemapTerrain","ready","c","computedExtent","extentPadding","setExtent","t","r","displayedNumberOfFeatures","length","maximumNumberOfFeatures","totalNumberOfFeatures","nodes","core","elevationUpdating","elevationAlignment","visibilityFrustum","a","aliasOf","prototype","readOnly","Boolean","p","y","l","spatialReference","fullExtent","equals","clone","state","isLocal","portalItem","destroyed","catch","I","lengths","N","originPosition","coords","f","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","T","push","sort","b","E","m","Math","sqrt","exports","log","M","exp","v","max","floor","min","x","items","addObject","objectStateId","object","addRenderGeometry","renderGeometry","addExternal","remove","_removeObjectStateItem","splice","removeObject","removeRenderGeometry","removeAll","forEach","channel","removeHighlight","removeOcclude","removeRenderGeometryObjectState","stateType","objectIdField","objectStateSet","ids","Set","paused","hasGraphic","graphic","attributes","has","uid","_graphicsCore","_stateSets","Array","acquireSet","releaseSet","set","handle","indexOf","_addObjectStateSet","addObjectStateSet","_removeObjectStateSet","removeObjectState","setUid","get","setUids","setObjectIds","initializeSet","addGraphic","removeGraphic","allGraphicsDeleted","states","_extents","allocator","_tmpExtent","_dirty","clear","contains","removeContained","pushNew","pop","mergeTight","merge","hasProgressed","done","getItemAt","delete","madeProgress","some","filterInPlace","containsPoint","dirtyExtents","globalDirty","averageExtentUpdateSize","dirtyGraphicsSet","updateElevation","layerView","events","queryGraphicUIDsInExtent","elevationProvider","resourceController","scheduler","_elevationChanged","watch","suspendedChange","registerTask","ELEVATION_ALIGNMENT","elevationInfoChange","running","size","empty","runTask","markAllGraphicsElevationDirty","run","_updateDirtyGraphics","_updateDirtyExtents","deconflictor","setDirty","renderCoordsHelper","keys","getGraphics3DGraphicById","alignWithElevation","emit","extent","needsElevationUpdates","context","elevationInfo","mode","xmin","xmax","ymin","ymax","watchUpdatingTracking","S","normalizeCtorArgs","w","preferredUpdatePolicy","graphicSymbolSupported","layerMinMaxScaleChangeHandler","addPromise","spatialIndex","j","objectStates","updateClippingExtent","startCreateGraphics","find","reject","toArray","isArray","map","clippingArea","setClippingExtent","recreateAllGraphics","updateSuspendResumeExtent","C","constructOnly","pause","resume","extentIntersectionDirty","_isVisibleBelowSurface","extentIntersection","viewChange","FRUSTUM_VISIBILITY","elevationBoundsChange","viewingMode","isVisibleBelowSurface","updateIsVisibleBelowSurface","_setDirty","ground","navigationConstraint","opaque","updateExtentIntersection","radius","elevationBounds","update","frustum","isVisibleInFrustum"],"mappings":"0IAAA,qHAIsxB,IAAIA,EAAE,cAAcC,YAAEC,MAAIC,cAAcC,SAASC,WAAWC,KAAKC,KAAK,cAAcD,KAAKE,kBAAkB,IAAIC,IAAEH,KAAKI,mBAAkB,EAAGJ,KAAKK,gBAAgB,EAAEL,KAAKM,oBAAoB,KAAKN,KAAKO,sCAAsC,KAAKC,aAAaR,KAAKS,KAAK,aAAa,IAAIC,IAAE,CAACC,MAAMX,KAAKY,MAAMZ,KAAKY,MAAMC,wBAAuB,KAAMb,KAAKc,WAAWC,QAAQf,KAAKE,kBAAkBa,MAAMf,MAAMA,KAAKgB,2BAA2BhB,KAAKiB,gBAAgBC,IAAIlB,KAAK,eAAe,IAAIA,KAAKc,WAAWK,aAAaC,kBAAkBpB,KAAKqB,QAAQH,IAAIlB,KAAKY,MAAMU,GAAG,kBAAkBC,GAAGvB,KAAKc,WAAWK,aAAaK,qBAAqBD,MAAMvB,KAAKyB,oBAAoBC,YAAE1B,MAAM2B,MAAMJ,GAAGvB,KAAKO,sCAAsCgB,KAAKvB,KAAKY,MAAMgB,SAAS5B,KAAK6B,aAAa,YAAY7B,KAAKqB,QAAQH,IAAIY,YAAE9B,KAAK+B,KAAK,wBAAwB,IAAI/B,KAAK6B,aAAa,eAAeG,UAAUhC,KAAKE,oBAAoBF,KAAKE,kBAAkB8B,UAAUhC,KAAKS,KAAK,oBAAoB,OAAOT,KAAKc,aAAad,KAAKc,WAAWkB,UAAUhC,KAAKS,KAAK,aAAa,OAAwB,oBAAG,OAAOT,KAAKiC,cAAcjC,KAAKE,kBAAkBgC,UAAyB,kBAAG,IAAIX,EAAE,MAAMO,EAAE,GAAG,OAAOK,YAAEnC,KAAKc,WAAWsB,kBAAkBpC,KAAKc,WAAWsB,gBAAgBF,YAAYJ,EAAEO,mBAAkB,GAAIP,EAAEQ,gBAAgB,OAAOf,EAAEvB,KAAKE,qBAAqBqB,EAAEW,WAAWJ,EAA0B,yBAACP,EAAEO,GAAG,OAAOK,YAAEL,GAAGA,EAAES,eAAe,KAAKC,6BAA6BjB,GAAGvB,KAAKc,WAAWK,aAAaqB,6BAA6BjB,GAAGkB,+BAA+BlB,GAAGvB,KAAKc,WAAWK,aAAasB,+BAA+BlB,GAAyB,yBAAG,OAAOvB,KAAKc,WAAWK,aAAauB,mBAAmD,mCAAG,OAAO1C,KAAKc,WAAWd,KAAKc,WAAWK,aAAawB,6BAA6B,KAAyB,uBAAG,OAAO3C,KAAKc,WAAWK,aAAayB,iBAAiBC,yBAAyBtB,GAAG,OAAOvB,KAAKc,WAAW+B,yBAAyBtB,GAAGuB,kBAAkBvB,EAAEY,GAAG,OAAOnC,KAAKc,WAAWgC,kBAAkBvB,EAAEY,GAAGY,wBAAwBxB,EAAEY,GAAG,OAAOnC,KAAKc,WAAWd,KAAKc,WAAWK,aAAa4B,wBAAwBxB,EAAEY,GAAG,KAAKa,mBAAmBzB,EAAEY,GAAG,OAAOnC,KAAKc,WAAWkC,mBAAmBzB,EAAEY,GAAGc,gBAAgB,OAAOC,QAAQC,QAAQnD,KAAKoD,gBAAgBC,aAAa9B,GAAG,OAAOvB,KAAKc,WAAWuC,aAAa9B,GAAG+B,UAAU/B,GAAG,OAAOvB,KAAKc,WAAWwC,UAAU/B,GAAmB,mBAAG,IAAIA,EAAE,OAAO,OAAOA,EAAEvB,KAAKc,iBAAY,EAAOS,EAAEJ,aAAaoC,wBAAwB,EAAEtB,YAAY,IAAIV,EAAE,OAAOzB,MAAMmC,eAAe,OAAOV,EAAEvB,KAAKc,aAAaS,EAAEW,WAAWsB,aAAa,IAAIjC,EAAEY,EAAE,UAAUnC,KAAKc,YAAYd,KAAKc,WAAW2C,UAAUzD,KAAKE,mBAAmBF,KAAKE,kBAAkBuD,YAAYzD,KAAKY,MAAMgB,UAAU,OAAOL,EAAEvB,KAAK+B,OAAO,OAAOI,EAAEZ,EAAEmC,iBAAiBvB,EAAEwB,QAAQ3C,2BAA2B,MAAMO,EAAE,KAAKvB,KAAKM,oBAAoBsD,YAAE5D,KAAKc,WAAWK,aAAa0C,eAAe7D,KAAKM,oBAA30F,IAAi2FN,KAAKc,WAAWK,aAAa2C,eAAe9D,KAAKE,kBAAkB6D,UAAU/D,KAAKM,sBAAsB0D,YAAEhE,KAAKc,WAAWK,aAAa,kBAAkB,IAAII,MAAK,GAAI0C,YAAEjE,KAAKc,WAAWK,aAAa,iBAAiB,IAAII,MAAK,GAAuB,sBAAG,MAAM,CAAC2C,0BAA0BlE,KAAKoD,eAAee,OAAOC,yBAAyB,EAAEC,uBAAuB,EAAEC,MAAM,EAAEC,KAAK,KAAKd,SAASzD,KAAKyD,SAASe,kBAAkBxE,KAAKc,WAAW2D,mBAAmBhB,SAASiB,mBAAmB1E,KAAKE,kBAAkBgC,aAAaX,YAAE,CAACoD,YAAE,CAACC,QAAQ,oBAAoBlF,EAAEmF,UAAU,sBAAiB,GAAQtD,YAAE,CAACoD,YAAE,CAACG,UAAS,KAAMpF,EAAEmF,UAAU,iBAAY,GAAQtD,YAAE,CAACoD,YAAE,CAACG,UAAS,KAAMpF,EAAEmF,UAAU,gBAAgB,MAAMtD,YAAE,CAACoD,YAAE,CAACG,UAAS,KAAMpF,EAAEmF,UAAU,gBAAW,GAAQtD,YAAE,CAACoD,eAAKjF,EAAEmF,UAAU,aAAQ,GAAQtD,YAAE,CAACoD,YAAE,CAACG,UAAS,KAAMpF,EAAEmF,UAAU,yBAAoB,GAAQtD,YAAE,CAACoD,YAAE,CAACG,UAAS,KAAMpF,EAAEmF,UAAU,kBAAa,GAAQtD,YAAE,CAACoD,YAAE,CAAC1E,KAAK8E,WAAWrF,EAAEmF,UAAU,yBAAoB,GAAQtD,YAAE,CAACoD,YAAE,CAACG,UAAS,KAAMpF,EAAEmF,UAAU,cAAc,MAAMnF,EAAE6B,YAAE,CAACyD,YAAE,6CAA6CtF,GAAG,IAAIuF,EAAEvF,EAAiBuF,a,iCCJzrJ,uDAIgL,SAASjB,EAAEA,GAAG,MAAMkB,EAAElB,EAAEjC,KAAKoD,iBAAiBrD,EAAEkC,EAAEpD,MAAMwE,WAAW7D,EAAEO,GAAGA,EAAEqD,iBAAiB,OAAO5D,EAAEA,EAAE8D,OAAOH,GAAGhC,QAAQC,QAAQrB,EAAEwD,SAASnD,YAAEZ,EAAE2D,GAAGhC,QAAQC,QAAQc,YAAEnC,EAAEoD,IAAIlB,EAAEjC,KAAKwD,MAAMC,QAAQ9E,0BAAEoB,EAAEoD,EAAElB,EAAEpD,MAAM6E,YAAY9D,MAAMQ,IAAI6B,EAAE0B,WAAWvD,EAAEA,OAAE,IAASwD,OAAO,IAAI,OAAOzC,QAAQC,QAAQ,MAAMD,QAAQC,QAAQ,Q,iCCAre,SAAShD,EAAEA,EAAE6D,GAAG,OAAO7D,EAAE6D,EAAE,EAAE,EAAEA,EAAE,EAAE,EAAE,SAASA,EAAEA,EAAE4B,EAAElF,EAAEd,EAAEsF,GAAG,IAAIU,IAAIA,EAAEC,QAAQ1B,OAAO,OAAO,KAAK,MAAM2B,EAAE,eAAe,MAAMZ,OAAE,EAAOA,EAAEa,iBAAiB,EAAE,EAAE/B,EAAE6B,QAAQ1B,SAASH,EAAE6B,QAAQ1B,OAAO,GAAGH,EAAEgC,OAAO7B,SAASH,EAAEgC,OAAO7B,OAAO,GAAG,MAAMrC,EAAEkC,EAAEgC,OAAOpC,EAAE,GAAGqC,EAAEvF,EAAE,CAACwF,OAAOC,kBAAkBD,OAAOE,kBAAkBF,OAAOC,kBAAkBD,OAAOE,kBAAkBF,OAAOC,kBAAkBD,OAAOE,mBAAmB,CAACF,OAAOC,kBAAkBD,OAAOE,kBAAkBF,OAAOC,kBAAkBD,OAAOE,oBAAoBP,QAAQtE,EAAEyE,OAAOK,GAAGT,EAAEjG,EAAEQ,EAAEO,EAAEd,GAAG,IAAIF,EAAE,EAAE,IAAI,MAAMS,KAAKoB,EAAE,CAAC,MAAMyC,EAAE7B,EAAE8D,EAAEI,EAAE3G,EAAES,EAAEO,EAAEd,EAAEkG,GAAG9B,GAAGJ,EAAE0C,KAAKtC,GAAGtE,GAAGS,EAAER,EAAE,GAAGiE,EAAE2C,MAAM,CAACpG,EAAE6D,KAAK,IAAI7B,EAAE2D,EAAE3F,EAAE,GAAG2F,EAAE9B,EAAE,GAAG,OAAO,IAAI7B,GAAGzB,IAAIyB,EAAEhC,EAAE,GAAG6D,EAAE,IAAI7B,KAAKyB,EAAEO,OAAO,CAAC,IAAIhE,EAAE,EAAEyD,EAAE,GAAG,GAAG9B,EAAE,GAAG8B,EAAE,GAAG,GAAGzD,EAAE2B,EAAE,GAAG8B,EAAE,GAAG,GAAGzD,EAAEO,IAAIP,EAAE,EAAEyD,EAAE,GAAG,GAAG9B,EAAE,GAAG,IAAI3B,EAAEyD,EAAE,GAAG,GAAGzD,EAAE,IAAI2B,EAAE,GAAGmE,EAAE,IAAInE,EAAE,GAAGmE,EAAE,IAAInE,EAAE,GAAGmE,EAAE,IAAInE,EAAE,GAAGmE,EAAE,IAAIvF,IAAIoB,EAAE,GAAGmE,EAAE,IAAInE,EAAE,GAAGmE,EAAE,OAAOnE,EAAEqC,OAAO,GAAG,IAAIrC,EAAEqC,OAAO,CAAC,MAAMhE,EAAEyF,EAAEC,QAAQ,GAAG5B,EAAEoC,EAAE,EAAE9E,EAAE,GAAGb,EAAEd,GAAG,KAAK,IAAIO,EAAE,OAAO,KAAK2B,EAAE,GAAG3B,EAAE,GAAG2B,EAAE,GAAG3B,EAAE,GAAGO,GAAGP,EAAEgE,OAAO,IAAIrC,EAAE,GAAG3B,EAAE,IAAI,OAAO6D,EAAE,SAAS7B,EAAE6B,EAAE7B,EAAE8B,EAAE2B,EAAElF,EAAEd,EAAEsF,EAAE,GAAG,MAAMY,EAAE3F,EAAEO,EAAEd,GAAG,IAAIkC,EAAEmC,EAAEL,EAAEK,EAAE6B,EAAEG,EAAE,EAAE1E,EAAE,EAAE8E,EAAE,EAAE1G,EAAE,EAAED,EAAE,EAAE,IAAI,IAAIS,EAAE,EAAEqG,EAAEZ,EAAE,EAAEzF,EAAEqG,EAAErG,IAAI2B,GAAGgE,EAAElC,GAAGkC,EAAE,CAAC,MAAM3F,EAAEgC,EAAEL,GAAGmC,EAAE9B,EAAEL,EAAE,GAAG8D,EAAEzD,EAAEL,EAAE,GAAGlC,EAAEuC,EAAEyB,GAAGsB,EAAE/C,EAAEyB,EAAE,GAAGkC,EAAE3D,EAAEyB,EAAE,GAAG,IAAI6C,EAAEtG,EAAE+E,EAAEtF,EAAEqE,EAAEtE,GAAG8G,EAAER,IAAI9F,EAAEP,GAAG6G,EAAElF,IAAI0C,EAAEiB,GAAGuB,EAAE/F,IAAI+F,EAAEtG,EAAE2F,EAAElG,EAAEgG,EAAES,IAAIT,EAAEE,GAAGW,EAAE/G,GAAG+G,GAAGtG,EAAE6D,EAAE,KAAKA,EAAE,GAAG7D,GAAGA,EAAE6D,EAAE,KAAKA,EAAE,GAAG7D,GAAG8D,EAAED,EAAE,KAAKA,EAAE,GAAGC,GAAGA,EAAED,EAAE,KAAKA,EAAE,GAAGC,GAAGvD,IAAIkF,EAAE5B,EAAE,KAAKA,EAAE,GAAG4B,GAAGA,EAAE5B,EAAE,KAAKA,EAAE,GAAG4B,IAAI,GAAGjG,EAAEuF,EAAE,IAAIvF,IAAI,GAAGD,EAAEwF,EAAE,IAAIxF,IAAI,IAAIC,EAAE,OAAO,KAAK,MAAM8G,EAAE,CAACR,EAAE1E,EAAE,GAAG5B,GAAG,OAAOe,IAAI+F,EAAE,GAAGJ,EAAEI,EAAE,GAAG,GAAG/G,GAAG+G,EAAE,SAASxC,EAAED,EAAE7B,EAAE8B,EAAE6B,EAAEhE,GAAG,MAAM8B,EAAEzD,EAAE2F,EAAEhE,GAAG,IAAImE,EAAE9D,EAAEZ,EAAEY,EAAEyB,EAAEyC,EAAE,EAAE1G,EAAE,EAAED,EAAE,EAAE+G,EAAE,EAAE,IAAI,IAAItG,EAAE,EAAEqG,EAAEvC,EAAE,EAAE9D,EAAEqG,EAAErG,IAAI8F,GAAGrC,EAAErC,GAAGqC,EAAE,CAAC,MAAMzD,EAAE6D,EAAEiC,GAAG9D,EAAE6B,EAAEiC,EAAE,GAAGhC,EAAED,EAAEiC,EAAE,GAAGnE,EAAEkC,EAAEzC,GAAGqC,EAAEI,EAAEzC,EAAE,GAAGiF,EAAExC,EAAEzC,EAAE,GAAGmF,EAAEZ,EAAEpF,EAAEP,EAAEgC,EAAE8B,EAAEnC,EAAE8B,EAAE4C,GAAGZ,EAAEzF,EAAEgC,EAAEL,EAAE8B,GAAG,GAAG8C,EAAE,GAAGL,GAAGK,EAAEZ,EAAE,CAAC,MAAM9B,EAAEkB,EAAE/E,EAAEgC,EAAE8B,EAAEnC,EAAE8B,EAAE4C,GAAG7G,GAAG+G,EAAE1C,EAAE,GAAGtE,GAAGgH,EAAE1C,EAAE,GAAGyC,GAAGC,EAAE1C,EAAE,OAAO,CAAC,MAAMA,EAAEpE,EAAEO,EAAEgC,EAAEL,EAAE8B,GAAGjE,GAAG+G,EAAE1C,EAAE,GAAGtE,GAAGgH,EAAE1C,EAAE,IAAI,OAAOqC,EAAE,EAAEP,EAAE,CAACnG,EAAE0G,EAAE3G,EAAE2G,EAAEI,EAAEJ,GAAG,CAAC1G,EAAE0G,EAAE3G,EAAE2G,GAAGpC,EAAE,EAAE6B,EAAE,CAAC9B,EAAE7B,GAAG6B,EAAE7B,EAAE,GAAG6B,EAAE7B,EAAE,IAAI,CAAC6B,EAAE7B,GAAG6B,EAAE7B,EAAE,IAAI,KAAK,SAASyD,EAAEzF,EAAE6D,EAAE7B,EAAE8B,GAAG,MAAM2B,EAAEzD,EAAEhC,EAAEO,EAAEuD,EAAED,EAAE,OAAO2C,KAAKC,KAAKhB,EAAEA,EAAElF,EAAEA,GAAG,SAASA,EAAEP,EAAE6D,EAAE7B,EAAE8B,EAAE2B,EAAElF,GAAG,MAAMd,EAAEqE,EAAE9D,EAAE+E,EAAEU,EAAE5B,EAAE8B,EAAEpF,EAAEyB,EAAE,OAAOwE,KAAKC,KAAKhH,EAAEA,EAAEsF,EAAEA,EAAEY,EAAEA,GAAG,SAASlG,EAAEO,EAAE6D,EAAE7B,EAAE8B,GAAG,MAAM,CAAC9D,EAAE,IAAIgC,EAAEhC,GAAG6D,EAAE,IAAIC,EAAED,IAAI,SAASkB,EAAE/E,EAAE6D,EAAE7B,EAAE8B,EAAE2B,EAAElF,GAAG,MAAM,CAACP,EAAE,IAAI8D,EAAE9D,GAAG6D,EAAE,IAAI4B,EAAE5B,GAAG7B,EAAE,IAAIzB,EAAEyB,IAJ1iE,mC,iCCAA,kCAIA,IAAI8B,EAAED,EAAEtD,EAAE,CAACmG,QAAQ,IAAI5C,EAAEvD,OAAE,KAAUsD,EAAE,WAAgE,SAASA,EAAEC,EAAEU,EAAExE,EAAE8F,EAAE9D,GAAG,KAAK8D,EAAE9F,GAAG,CAAC,GAAG8F,EAAE9F,EAAE,IAAI,CAAC,IAAIR,EAAEsG,EAAE9F,EAAE,EAAEoB,EAAEoD,EAAExE,EAAE,EAAEP,EAAE+G,KAAKG,IAAInH,GAAGoH,EAAE,GAAGJ,KAAKK,IAAI,EAAEpH,EAAE,GAAGqH,EAAE,GAAGN,KAAKC,KAAKhH,EAAEmH,GAAGpH,EAAEoH,GAAGpH,IAAI4B,EAAE5B,EAAE,EAAE,GAAG,EAAE,GAAGqE,EAAEC,EAAEU,EAAEgC,KAAKO,IAAI/G,EAAEwG,KAAKQ,MAAMxC,EAAEpD,EAAEwF,EAAEpH,EAAEsH,IAAIN,KAAKS,IAAInB,EAAEU,KAAKQ,MAAMxC,GAAGhF,EAAE4B,GAAGwF,EAAEpH,EAAEsH,IAAI9E,GAAG,IAAIkF,EAAEpD,EAAEU,GAAGf,EAAEzD,EAAE6E,EAAEiB,EAAE,IAAIvF,EAAEuD,EAAE9D,EAAEwE,GAAGxC,EAAE8B,EAAEgC,GAAGoB,GAAG,GAAG3G,EAAEuD,EAAE9D,EAAE8F,GAAGrC,EAAEoB,GAAG,CAAC,IAAItE,EAAEuD,EAAEL,EAAEoB,GAAGpB,IAAIoB,IAAI7C,EAAE8B,EAAEL,GAAGyD,GAAG,GAAGzD,IAAI,KAAKzB,EAAE8B,EAAEe,GAAGqC,GAAG,GAAGrC,IAAI,IAAI7C,EAAE8B,EAAE9D,GAAGkH,GAAG3G,EAAEuD,EAAE9D,EAAE6E,GAAGtE,EAAEuD,IAAIe,EAAEiB,GAAGjB,GAAGL,IAAIxE,EAAE6E,EAAE,GAAGL,GAAGK,IAAIiB,EAAEjB,EAAE,IAAI,SAAStE,EAAEuD,EAAED,EAAEtD,GAAG,IAAIiE,EAAEV,EAAED,GAAGC,EAAED,GAAGC,EAAEvD,GAAGuD,EAAEvD,GAAGiE,EAAE,SAASA,EAAEV,EAAED,GAAG,OAAOC,EAAED,GAAG,EAAEC,EAAED,EAAE,EAAE,EAAE,OAAhiB,SAAWC,EAAEvD,EAAEP,EAAE8F,EAAE9D,GAAG6B,EAAEC,EAAEvD,EAAEP,GAAG,EAAE8F,GAAGhC,EAAEE,OAAO,EAAEhC,GAAGwC,IAA7D,MAA0jBV,EAAE4C,QAAQ7C,GAAG,IAAIW,EAAEjE,EAAEmG,S,gFCAtnB,MAAM1E,EAAEtC,cAAcG,KAAKsH,MAAM,GAAGC,UAAUpF,EAAE6B,GAAGhE,KAAKsH,MAAMhB,KAAK,CAACrG,KAAK,EAAEuH,cAAcxD,EAAEyD,OAAOtF,IAAIuF,kBAAkBvF,EAAE6B,EAAElC,GAAG9B,KAAKsH,MAAMhB,KAAK,CAACrG,KAAK,EAAEuH,cAAcxD,EAAE2D,eAAexF,EAAExB,MAAMmB,IAAI8F,YAAYzF,EAAE6B,GAAGhE,KAAKsH,MAAMhB,KAAK,CAACrG,KAAK,EAAEuH,cAAcxD,EAAE6D,OAAO1F,IAAI0F,OAAO1F,GAAG,IAAI,IAAI6B,EAAEhE,KAAKsH,MAAMnD,OAAO,EAAEH,GAAG,IAAIA,EAAE,CAAC,MAAMlC,EAAE9B,KAAKsH,MAAMtD,GAAGlC,EAAE0F,gBAAgBrF,IAAInC,KAAK8H,uBAAuBhG,GAAG9B,KAAKsH,MAAMS,OAAO/D,EAAE,KAAKgE,aAAa7F,GAAG,IAAI,IAAI6B,EAAEhE,KAAKsH,MAAMnD,OAAO,EAAEH,GAAG,IAAIA,EAAE,CAAC,MAAMlC,EAAE9B,KAAKsH,MAAMtD,GAAG,IAAIlC,EAAE7B,MAAM6B,EAAE2F,SAAStF,IAAInC,KAAK8H,uBAAuBhG,GAAG9B,KAAKsH,MAAMS,OAAO/D,EAAE,KAAKiE,qBAAqB9F,GAAG,IAAI,IAAI6B,EAAEhE,KAAKsH,MAAMnD,OAAO,EAAEH,GAAG,IAAIA,EAAE,CAAC,MAAMlC,EAAE9B,KAAKsH,MAAMtD,GAAG,IAAIlC,EAAE7B,MAAM6B,EAAE6F,iBAAiBxF,IAAInC,KAAK8H,uBAAuBhG,GAAG9B,KAAKsH,MAAMS,OAAO/D,EAAE,KAAKkE,YAAYlI,KAAKsH,MAAMa,SAAShG,IAAInC,KAAK8H,uBAAuB3F,MAAMnC,KAAKsH,MAAM,GAAGQ,uBAAuB3F,GAAG,OAAOA,EAAElC,MAAM,KAAK,EAAE,IAAIkC,EAAEqF,cAAcY,QAAQjG,EAAEsF,OAAOY,gBAAgBlG,EAAEqF,eAAe,IAAIrF,EAAEqF,cAAcY,SAASjG,EAAEsF,OAAOa,cAAcnG,EAAEqF,eAAe,MAAM,KAAK,EAAErF,EAAExB,MAAM4H,gCAAgCpG,EAAEwF,eAAexF,EAAEqF,eAAe,MAAM,KAAK,EAAErF,EAAE0F,OAAO1F,EAAEqF,iBCA9hC,MAAMrF,EAAEtC,YAAYsC,EAAEZ,GAAGvB,KAAKwI,UAAUrG,EAAEnC,KAAKyI,cAAclH,EAAEvB,KAAK0I,eAAe,IAAI1E,EAAEhE,KAAK2I,IAAI,IAAIC,IAAI5I,KAAK6I,QAAO,EAAGC,WAAW9E,GAAG,GAAGhE,KAAKyI,cAAc,CAAC,MAAMtG,EAAE6B,EAAE+E,QAAQC,WAAWhJ,KAAKyI,eAAe,OAAOzI,KAAK2I,IAAIM,IAAI9G,GAAG,OAAOnC,KAAK2I,IAAIM,IAAIjF,EAAE+E,QAAQG,MCA5M,MAAMpH,EAAEjC,YAAYmE,GAAGhE,KAAKmJ,cAAcnF,EAAEhE,KAAKoJ,WAAW,IAAIC,MAAMrH,UAAUhC,KAAKoJ,YAAYpJ,KAAKoJ,WAAWjB,SAASnE,GAAGA,EAAE0E,eAAeR,cAAclI,KAAKoJ,WAAW,KAAKE,WAAWxH,EAAE6C,GAAG,MAAMpD,EAAE,IAAIY,EAAEL,EAAE6C,GAAG3E,KAAKoJ,WAAW9C,KAAK/E,GAAG,MAAM5B,EAAEqE,aAAG,IAAIhE,KAAKuJ,WAAWhI,KAAK,MAAM,CAACiI,IAAIjI,EAAEkI,OAAO9J,GAAG4J,WAAWvF,GAAGA,EAAE0E,eAAeR,YAAY,MAAM/F,EAAEnC,KAAKoJ,WAAWpJ,KAAKoJ,WAAWM,QAAQ1F,IAAI,GAAG,IAAI7B,GAAGnC,KAAKoJ,WAAWrB,OAAO5F,EAAE,GAAGwH,mBAAmB3F,EAAE7B,GAAG6B,EAAE4F,kBAAkBzH,EAAEqG,UAAUrG,EAAEuG,gBAAgBmB,sBAAsB7F,EAAE7B,GAAG6B,EAAE8F,kBAAkB3H,EAAEuG,gBAAgBqB,OAAO/F,EAAE7B,GAAG6B,EAAE2E,IAAIzH,IAAIiB,GAAG,MAAML,EAAE9B,KAAKmJ,cAAczG,mBAAmBsH,IAAI7H,GAAGL,GAAG9B,KAAK2J,mBAAmB7H,EAAEkC,GAAGiG,QAAQjG,EAAE7B,GAAGA,EAAEgG,SAAShG,GAAGnC,KAAK+J,OAAO/F,EAAE7B,KAAK+H,aAAalG,EAAE7B,GAAGA,EAAEgG,SAAShG,GAAG6B,EAAE2E,IAAIzH,IAAIiB,KAAKnC,KAAKmK,cAAcnG,GAAGoG,WAAWpG,GAAGhE,KAAKoJ,WAAWjB,SAAShG,KAAKA,EAAE0G,QAAQ1G,EAAE2G,WAAW9E,IAAIhE,KAAK2J,mBAAmB3F,EAAE7B,MAAMkI,cAAcrG,GAAGhE,KAAKoJ,WAAWjB,SAAShG,IAAIA,EAAE2G,WAAW9E,IAAIhE,KAAK6J,sBAAsB7F,EAAE7B,MAAMmI,qBAAqBtK,KAAKoJ,YAAYpJ,KAAKoJ,WAAWjB,SAASnE,GAAGA,EAAE0E,eAAeR,cAAciC,cAAcnG,GAAG,MAAM7B,EAAEnC,KAAKmJ,cAAczG,mBAAmBsB,EAAEyE,cAActG,EAAEgG,SAAShG,IAAIA,GAAG6B,EAAE8E,WAAW3G,IAAInC,KAAK2J,mBAAmBxH,EAAE6B,MAAMA,EAAE2E,IAAIR,SAASrG,IAAI,MAAM6C,EAAExC,EAAE6H,IAAIlI,GAAG6C,GAAG3E,KAAK2J,mBAAmBhF,EAAEX,MAAc,WAAG,MAAM,CAACuG,OAAOvK,KAAKoJ,e,kICAnsC,MAAMxF,EAAE/D,cAAcG,KAAKwK,SAAS,IAAIxG,IAAE,CAACyG,UAAUzG,GAAGA,GAAG7B,gBAAMnC,KAAK0K,WAAWvI,cAAInC,KAAK2K,QAAO,EAAY,YAAG,OAAO,IAAI3K,KAAKwK,SAASrG,OAAe,WAAG,OAAOnE,KAAKwK,SAASrG,OAAOyG,QAAQ5K,KAAKwK,SAASI,QAAQ1J,IAAI8C,GAAGhE,KAAK6K,SAAS7G,KAAKhE,KAAK8K,gBAAgB9G,GAAGC,YAAEjE,KAAKwK,SAASO,UAAU/G,GAAGhE,KAAK2K,QAAO,GAAIK,MAAM,OAAOhL,KAAK2K,QAAQ3K,KAAKiL,aAAajL,KAAKwK,SAASQ,MAAME,MAAMlH,GAAG,OAAOhE,KAAKiL,WAAWjH,GAAGA,EAAEmH,cAAcF,WAAWjH,EAAErE,KAAG,MAAMwC,EAAEnC,KAAKwK,SAAS9J,EAAE,IAAIkI,IAAI,IAAIrH,EAAE,EAAE,KAAKA,IAAIY,EAAEgC,QAAQ,CAAChC,EAAEoE,MAAM,CAACvC,EAAE7B,IAAI6B,EAAE,GAAG7B,EAAE,KAAKZ,EAAEY,EAAEgC,OAAOzD,EAAEkK,QAAQ,IAAI,IAAIrJ,EAAE,EAAEA,EAAEY,EAAEgC,SAAS5C,EAAE,CAAC,GAAGyC,EAAEoH,KAAK,OAAO,MAAMzL,EAAEwC,EAAEkJ,UAAU9J,GAAG,IAAI,IAAIyC,EAAEzC,EAAE,EAAEyC,EAAE7B,EAAEgC,SAASH,EAAE,CAAC,MAAMC,EAAE9B,EAAEkJ,UAAUrH,GAAG,GAAGC,EAAE,IAAItE,EAAE,GAAG,MAAMe,EAAEQ,IAAI+C,GAAGvD,EAAEyH,SAAS5G,IAAI,GAAG5B,IAAI4B,EAAE,OAAO,GAAGA,EAAE,IAAI5B,EAAE,GAAG,YAAYe,EAAE4K,OAAO/J,GAAG,MAAMqC,EAAE9B,YAAEnC,GAAGD,EAAEoC,YAAEP,GAAGmF,EAAE1G,KAAK0K,WAAWvK,YAAER,EAAE4B,EAAEmF,GAAG,MAAMhF,EAAEkC,EAAElE,GAAGoC,YAAE4E,GAAGhF,GAAGA,EAAt0B,MAA40BuC,YAAEtE,EAAE+G,GAAGhG,EAAE4K,OAAO/J,GAAGY,EAAE0F,OAAOtG,GAAGyC,EAAEuH,mBAAmB7K,EAAEQ,IAAIvB,IAAIK,KAAK2K,QAAO,EAAGE,SAAS7G,GAAG,OAAOhE,KAAKwK,SAASgB,MAAMrJ,GAAGzB,YAAEyB,EAAE6B,KAAK8G,gBAAgB9G,GAAGhE,KAAKwK,SAASiB,eAAetJ,IAAIzB,YAAEsD,EAAE7B,KAAa,WAAG,MAAM6B,EAAEhE,KAAK,MAAM,CAAC0L,cAAcvJ,GAAG6B,EAAEwG,SAASgB,MAAMxH,GAAGzC,YAAEyC,EAAE7B,OCAxtB,IAAI6C,EAAE,cAAchB,IAAEnE,cAAcC,SAASC,WAAWC,KAAK2L,aAAa,IAAIhM,EAAEK,KAAK4L,aAAY,EAAG5L,KAAK6L,wBAAwB,EAAE7L,KAAK8L,iBAAiB,IAAIlD,IAAI5I,KAAKqB,QAAQ,IAAIS,IAAE9B,KAAK+L,iBAAgB,EAAG/L,KAAKgM,UAAU,KAAKhM,KAAKmB,aAAa,KAAKnB,KAAKiM,OAAO,IAAI1K,IAAER,MAAMoB,EAAE6B,EAAEzC,EAAEO,GAAG9B,KAAKgM,UAAU7J,EAAEnC,KAAKkM,yBAAyBlI,EAAEhE,KAAKmB,aAAaI,EAAEvB,KAAKmM,kBAAkBrK,EAAE,MAAMmC,EAAEjE,KAAKgM,UAAUjK,KAAKqK,mBAAmBC,UAAUrM,KAAKqB,QAAQH,IAAI,CAACY,EAAER,GAAG,oBAAoBa,GAAGnC,KAAKsM,kBAAkBnK,KAAKnC,KAAKgM,UAAUO,MAAM,aAAa,IAAIvM,KAAKwM,oBAAoBvI,EAAEwI,aAAa/L,IAAEgM,oBAAoB1M,QAAQgC,UAAUhC,KAAK8L,iBAAiBlB,QAAQ5K,KAAKqB,QAAQW,UAAUhC,KAAKqB,QAAQ,KAAKrB,KAAKgM,UAAU,KAAKhM,KAAKmB,aAAa,KAAKnB,KAAKkM,yBAAyB,KAAKtB,QAAQ5K,KAAK8L,iBAAiBlB,QAAQ5K,KAAK6B,aAAa,YAAY2K,mBAAkB,IAAKxM,KAAKgM,UAAU9J,UAAUlC,KAAK+L,iBAAgB,GAAG,IAAK/L,KAAKgM,UAAU9J,WAAWlC,KAAK+L,kBAAkB/L,KAAK4L,aAAY,EAAG5L,KAAK6B,aAAa,aAAa8K,sBAAsB3M,KAAK4L,aAAY,EAAG5L,KAAK6B,aAAa,YAAwB,eAAG,OAAO7B,KAAK4M,QAAmB,cAAG,OAAO5M,KAAK8L,iBAAiBe,KAAK,GAAG7M,KAAK2L,eAAe3L,KAAK2L,aAAamB,OAAO9M,KAAK4L,YAAiC,wBAAG,OAAO5L,KAAK8L,iBAAiBe,KAAK7M,KAAK2L,aAAakB,KAAK7M,KAAK6L,wBAAwBkB,QAAQ5K,GAAG,IAAInC,KAAK4L,cAAc5L,KAAKgN,gCAAgChN,KAAK4L,aAAY,EAAGzJ,EAAEoJ,gBAAgBpJ,EAAE8K,KAAK,IAAIjN,KAAK2L,aAAaT,MAAM/I,KAAKnC,KAAK4M,UAAUzK,EAAEiJ,MAAMpL,KAAKkN,qBAAqB/K,GAAGnC,KAAKmN,oBAAoBhL,GAAGnC,KAAKgM,UAAUjK,KAAKqL,aAAaC,WAAWrN,KAAK6B,aAAa,YAAYqL,qBAAqB/K,GAAG,MAAM6B,EAAEhE,KAAKgM,UAAUjK,KAAKuL,mBAAmB/L,EAAE,IAAIvB,KAAKmB,aAAaoC,sBAAsB,IAAI,MAAMzB,KAAK9B,KAAK8L,iBAAiByB,OAAO,CAAC,MAAM5I,EAAE3E,KAAKmB,aAAaqM,yBAAyB1L,GAAG,GAAG9B,KAAK8L,iBAAiBR,OAAOxJ,GAAGmC,YAAEU,KAAKA,EAAE8I,mBAAmBzN,KAAKmM,kBAAkBnI,EAAEzC,GAAGY,EAAEoJ,gBAAgBpJ,EAAEiJ,KAAK,QAAQ+B,oBAAoBhL,GAAG,MAAMnC,KAAK2L,aAAamB,QAAQ3K,EAAEiJ,MAAM,CAAC,MAAMpH,EAAEhE,KAAK2L,aAAaX,MAAMzJ,EAAEvB,KAAKmM,kBAAkBhH,iBAAiBnF,KAAKiM,OAAOyB,KAAK,uBAAuB,CAACC,OAAO3J,EAAEmB,iBAAiB5D,IAAI,MAAMO,EAAE9B,KAAK8L,iBAAiBe,KAAK7M,KAAKkM,yBAAyBlI,EAAEzC,GAAGY,IAAI,MAAM6B,EAAEhE,KAAKmB,aAAaqM,yBAAyBrL,GAAG8B,YAAED,IAAIA,EAAE4J,yBAAyB5N,KAAK8L,iBAAiB5K,IAAIiB,MAAMnC,KAAK6L,wBAAwB,IAAI7L,KAAK8L,iBAAiBe,KAAK/K,GAAG,GAAG9B,KAAK6L,wBAAwB1J,EAAEoJ,gBAAgByB,gCAAgChN,KAAK2L,aAAaf,QAAQ5K,KAAK8L,iBAAiBlB,QAAQ5K,KAAKmB,aAAauB,mBAAmByF,SAAS,CAAChG,EAAE6B,IAAIhE,KAAK8L,iBAAiB5K,IAAI8C,KAAKsI,kBAAkBnK,GAAG,GAAG,UAAUA,EAAE0L,WAAW7N,KAAKmB,aAAaP,MAAMkN,eAAe,sBAAsB9N,KAAKmB,aAAaP,MAAMkN,cAAcC,MAAM,OAAO,MAAMJ,OAAO3J,EAAEmB,iBAAiB5D,GAAGY,EAAE,GAAGnC,KAAKgM,UAAU9J,UAAU,CAAC,IAAIlC,KAAK+L,gBAAgB,CAAC,MAAM5J,EAAEnC,KAAKmB,aAAa0C,eAAe1B,GAAG6B,EAAE,GAAG7B,EAAE6L,MAAMhK,EAAE,GAAG7B,EAAE8L,MAAMjK,EAAE,GAAG7B,EAAE+L,MAAMlK,EAAE,GAAG7B,EAAEgM,OAAOnO,KAAK+L,iBAAgB,GAAI/L,KAAKiM,OAAOyB,KAAK,uBAAuB,CAACC,OAAO3J,EAAEmB,iBAAiB5D,SAASyC,EAAE,MAAK,IAAKhE,KAAK4L,aAAY,EAAG5L,KAAK2L,aAAazK,IAAI8C,GAAGhE,KAAK6B,aAAa,cAAcM,YAAE,CAACwC,YAAE,CAACG,UAAS,KAAME,EAAEH,UAAU,WAAW,MAAM1C,YAAE,CAACwC,YAAE,CAACG,UAAS,KAAME,EAAEH,UAAU,oBAAoB,MAAMG,EAAE7C,YAAE,CAAChC,YAAE,+DAA+D6E,GAAG,IAAItD,EAAEsD,EAAiBtD,O,iCCJ78H,oMAIq1C,IAAIuF,EAAE,cAAc1F,IAAE1B,YAAYmE,GAAGlE,MAAMkE,GAAGhE,KAAKmB,aAAa,KAAKnB,KAAKyE,mBAAmB,IAAI+B,IAAExG,KAAKoO,sBAAsB,IAAIC,IAAErO,KAAKqB,QAAQ,IAAI4C,IAAEjE,KAAKM,oBAAoB,KAAKgO,kBAAkBtK,GAAG,IAAI7B,EAAE,KAAK6B,EAAEnD,gCAAgCmD,EAAE,IAAIA,IAAInD,uBAAuBsB,EAAE,IAAIoM,KAAG,MAAMhN,EAAE,IAAI0E,IAAE,CAACtF,MAAMqD,EAAErD,MAAMC,MAAMoD,EAAEpD,MAAM4N,sBAAsB,EAAEC,wBAAuB,IAAK,MAAM,IAAIzK,EAAE7C,aAAaI,EAAEa,gBAAgBD,GAAG3B,aAAa,MAAMwD,EAAEhE,KAAKoC,gBAAgBuC,YAAEX,IAAI,aAAahE,KAAKY,OAAOZ,KAAKoO,sBAAsBlN,IAAIlB,KAAKY,MAAM,gBAAgB,IAAIoD,EAAE0K,kCAAkC,kBAAkB1O,KAAKY,OAAOZ,KAAKoO,sBAAsBlN,IAAIlB,KAAKY,MAAM,iBAAiB,CAACoD,EAAE7B,KAAKT,YAAEsC,EAAE7B,IAAInC,KAAKoO,sBAAsBO,WAAW3O,KAAKmB,aAAawL,0BAAqC,cAAG,MAAM3I,EAAE,CAACA,EAAE7B,EAAEZ,IAAIvB,KAAKmB,aAAayN,aAAa1C,yBAAyBlI,EAAE7B,EAAEZ,GAAG,GAAGvB,KAAKyE,mBAAmB1D,MAAMf,KAAKW,MAAMqD,EAAEhE,KAAKmB,aAAanB,KAAK+B,KAAKoK,mBAAmBxH,YAAE3E,KAAKoC,kBAAkB,aAAapC,KAAKY,MAAM,CAAC,MAAMuB,EAAEnC,KAAKW,MAAMoB,KAAK2B,eAAe1D,KAAKoC,gBAAgBrB,MAAMf,KAAKW,MAAMX,KAAKY,MAAMoD,EAAEhE,KAAKmB,aAAagB,GAAGnC,KAAKS,KAAK,eAAe,IAAIoO,IAAE7O,KAAKmB,eAAe,UAAUnB,KAAKmB,aAAaJ,MAAM,CAAC0D,mBAAmBzE,KAAKyE,mBAAmBrC,gBAAgBpC,KAAKoC,gBAAgB0M,aAAa9O,KAAK8O,eAAe,MAAM3M,GAAG,GAAGyB,YAAEzB,GAAG,OAAO,MAAMA,EAAEnC,KAAK0F,YAAY1F,KAAKqB,QAAQH,IAAIlB,KAAK+B,KAAKwK,MAAM,gBAAgB,IAAIvM,KAAK+O,yBAAwB,IAAK/O,KAAK+O,uBAAuB/O,KAAKgB,2BAA2BhB,KAAKmB,aAAa6N,uBAAuBhN,UAAUhC,KAAKqB,QAAQX,YAAEV,KAAKqB,SAASrB,KAAKoO,sBAAsBpM,UAAUhC,KAAKS,KAAK,qBAAqBC,YAAEV,KAAKyE,qBAAqBzE,KAAKS,KAAK,kBAAkBC,YAAEV,KAAKoC,kBAAkBpC,KAAKS,KAAK,eAAeC,YAAEV,KAAK8O,eAAe9O,KAAKS,KAAK,eAAeC,YAAEV,KAAKmB,eAA4B,gBAAG,SAASwD,YAAE3E,KAAKoC,mBAAmBpC,KAAKoC,gBAAgBF,WAAuB,eAAG,IAAI8B,EAAE7B,EAAE,SAAS,OAAO6B,EAAEhE,KAAKmB,eAAe6C,EAAEP,UAAUkB,YAAE3E,KAAKoC,kBAAkBpC,KAAKoC,gBAAgBqB,UAAU,OAAOtB,EAAEnC,KAAKoO,wBAAwBjM,EAAEsB,UAAUZ,yBAAyBmB,GAAG,GAAGhE,KAAKW,MAAMyC,eAAe,CAAC,MAAMjB,EAAEnC,KAAKW,MAAMyC,eAAe6L,MAAM9M,GAAGA,EAAE+G,MAAMlF,IAAI,GAAG7B,EAAE,CAAC,MAAM6B,EAAEhE,KAAKY,iBAAiBhB,IAAEI,KAAKY,MAAM,KAAK,OAAOlB,YAAEyC,EAAE6B,KAAKlB,kBAAkBkB,EAAE7B,GAAG,OAAOnC,KAAKmB,aAAanB,KAAKmB,aAAa2B,kBAAkBkB,EAAE7B,GAAGe,QAAQgM,SAASnM,wBAAwBiB,EAAE7B,GAAG,OAAOnC,KAAKmB,aAAanB,KAAKmB,aAAa4B,wBAAwBiB,EAAE7B,GAAG,KAAKa,mBAAmBgB,EAAE7B,GAAG,OAAOnC,KAAKmB,aAAanB,KAAKmB,aAAa6B,mBAAmBgB,EAAE7B,GAAG,KAAKkB,aAAaW,GAAG,MAAMwF,IAAIrH,EAAEsH,OAAOlI,GAAGvB,KAAK8O,aAAaxF,WAAW,EAAE,MAAM,OAAOtJ,KAAK8O,aAAa/E,OAAO5H,EAAE6B,EAAEkF,KAAK3H,EAAE+B,UAAUU,GAAG,GAAGA,aAAa0C,IAAE,OAAOW,EAAE,GAAG,iBAAiBrD,EAAE,OAAOhE,KAAKsD,UAAU,CAACU,IAAI,GAAGA,aAAa7B,IAAE,OAAOnC,KAAKsD,UAAU,CAACU,IAAI,GAAGA,aAAalC,MAAIkC,EAAEA,EAAEmL,WAAW9F,MAAM+F,QAAQpL,IAAIA,EAAEG,OAAO,EAAE,CAAC,GAAGH,EAAE,aAAa7B,IAAE,CAAC,MAAMA,EAAE6B,EAAEqL,KAAKrL,GAAGA,EAAEkF,OAAOM,IAAIjI,EAAEkI,OAAO3H,GAAG9B,KAAK8O,aAAaxF,WAAW,EAAE,MAAM,OAAOtJ,KAAK8O,aAAa7E,QAAQ1I,EAAEY,GAAGL,EAAE,GAAG,iBAAiBkC,EAAE,GAAG,CAAC,MAAM7B,EAAE6B,GAAGwF,IAAIjI,EAAEkI,OAAO3H,GAAG9B,KAAK8O,aAAaxF,WAAW,EAAE,MAAM,OAAOtJ,KAAK8O,aAAa5E,aAAa3I,EAAEY,GAAGL,GAAG,OAAOuF,EAAE0H,uBAAuB,MAAM/K,EAAEhE,KAAK+B,KAAKuN,aAAatP,KAAKmB,aAAaoO,kBAAkBvL,EAAEhE,KAAK+B,KAAKoD,mBAAmBnF,KAAKmB,aAAaqO,sBAAsBC,4BAA4BtP,YAAEH,KAAKoC,mBAAmBpC,KAAKM,oBAAoBoP,YAAE1P,KAAKmB,aAAa0C,eAAe7D,KAAKM,oBAAoB2E,IAAEjF,KAAKmB,aAAa2C,eAAe9D,KAAKoC,gBAAgB2B,UAAU/D,KAAKM,sBAAsBU,2BAA2Bb,YAAEH,KAAKoC,mBAAmBzC,YAAEK,KAAKmB,aAAa,kBAAkB6C,GAAGhE,KAAKyP,8BAA6B,GAAIzP,KAAKmB,aAAaoL,MAAM,iBAAiBvI,GAAGhE,KAAKyP,iCAAiCzL,YAAE,CAACgB,YAAE,CAAC2K,eAAc,KAAM1I,EAAEpC,UAAU,aAAQ,GAAQb,YAAE,CAACgB,YAAE,CAAC2K,eAAc,KAAM1I,EAAEpC,UAAU,aAAQ,GAAQb,YAAE,CAACgB,YAAE,CAACF,UAAS,EAAGF,QAAQ,gBAAgBqC,EAAEpC,UAAU,YAAO,GAAQb,YAAE,CAACgB,YAAE,CAAC2K,eAAc,KAAM1I,EAAEpC,UAAU,oBAAe,GAAQb,YAAE,CAACgB,YAAE,CAAC2K,eAAc,KAAM1I,EAAEpC,UAAU,uBAAkB,GAAQb,YAAE,CAACgB,YAAE,CAACF,UAAS,KAAMmC,EAAEpC,UAAU,0BAAqB,GAAQb,YAAE,CAACgB,YAAE,CAACF,UAAS,KAAMmC,EAAEpC,UAAU,oBAAe,GAAQb,YAAE,CAACgB,YAAE,CAACF,UAAS,KAAMmC,EAAEpC,UAAU,6BAAwB,GAAQb,YAAE,CAACgB,YAAE,CAACF,UAAS,KAAMmC,EAAEpC,UAAU,YAAY,MAAMb,YAAE,CAACgB,YAAE,CAACF,UAAS,KAAMmC,EAAEpC,UAAU,WAAW,MAAMoC,EAAEjD,YAAE,CAACkB,YAAE,iEAAiE+B,GAAG,MAAMI,EAAE,CAACQ,WAAW+H,UAAUC,YAAY,IAAIpJ,EAAEQ,EAAiBR,O,iCCJpxL,2FAIqtB,IAAI7G,EAAE,cAAcoE,IAAEnE,cAAcC,SAASC,WAAWC,KAAKkC,WAAU,EAAGlC,KAAK2N,OAAO,KAAK3N,KAAK8P,yBAAwB,EAAG9P,KAAK+P,wBAAuB,EAAG/P,KAAKqB,QAAQ,IAAIS,IAAE9B,KAAKgM,UAAU,KAAKhM,KAAKyD,UAAS,EAAG1C,MAAMoB,GAAGnC,KAAKgM,UAAU7J,EAAEnC,KAAKgQ,mBAAmB,IAAIrL,IAAE,CAAC2I,mBAAmBnL,EAAEJ,KAAKuL,qBAAqB,MAAMtJ,EAAE7B,EAAEJ,KAAKD,EAAEkC,EAAEN,eAAeO,EAAED,EAAEoI,mBAAmBC,UAAUrM,KAAKqB,QAAQH,IAAI,CAAC8C,EAAE1C,GAAG,UAAU,IAAItB,KAAKiQ,eAAejM,EAAEuB,MAAMgH,MAAM,UAAU,IAAIvM,KAAKiQ,eAAc,GAAIhM,EAAEwI,aAAavH,IAAEgL,mBAAmBlQ,MAAM8B,EAAER,GAAG,2BAA2B,IAAItB,KAAKmQ,4BAA4B,UAAUnM,EAAEoM,YAAYpQ,KAAKqQ,uBAAsB,EAAGrQ,KAAKqB,QAAQH,IAAI,CAACK,YAAEO,EAAE,CAAC,UAAU,cAAc,IAAI9B,KAAKsQ,gCAAgC/O,YAAEyC,EAAE,wCAAwC,IAAIhE,KAAKsQ,kCAAkCtO,UAAUhC,KAAKgM,UAAU,KAAKhM,KAAK2N,OAAO,KAAK3N,KAAKgQ,mBAAmB,KAAKhQ,KAAKqB,UAAUrB,KAAKqB,QAAQW,UAAUhC,KAAKqB,QAAQ,MAAMkP,YAAYvQ,KAAKyD,UAAUzD,KAAKS,KAAK,YAAW,GAAIsD,UAAU5B,GAAGnC,KAAK2N,OAAOxL,EAAEnC,KAAK8P,yBAAwB,EAAG9P,KAAKuQ,YAAYN,aAAajQ,KAAKuQ,YAAYJ,wBAAwBnQ,KAAKuQ,YAAYvQ,KAAK8P,yBAAwB,EAA4B,0BAAC3N,GAAGnC,KAAK+P,uBAAuB5N,EAAEnC,KAAKuQ,YAAYvQ,KAAK8P,yBAAwB,EAAGQ,8BAA8B,MAAMnO,EAAEnC,KAAKgM,UAAUjK,KAAKiC,EAAE7B,EAAEuB,eAAe5B,EAAE,UAAUK,EAAEiO,YAAY7O,EAAEY,EAAEkN,IAAImB,QAAQrO,EAAEkN,IAAImB,OAAOC,sBAAsB,SAAStO,EAAEkN,IAAImB,OAAOC,qBAAqBxQ,KAAKD,KAAKqQ,sBAAsBvO,IAAIkC,EAAE0M,QAAQnP,EAAEoP,2BAA2B,IAAI3Q,KAAK8P,wBAAwB,OAAO9P,KAAK8P,yBAAwB,EAAG,MAAM3N,EAAEnC,KAAKgM,UAAUjK,KAAK,IAAIiC,EAAE,GAAGhE,KAAK+P,uBAAuB/L,GAAG,GAAGtD,YAAEyB,EAAEgD,kBAAkByL,WAAW,CAAC,MAAMxJ,IAAItF,EAAEoF,IAAI3F,GAAGY,EAAEuB,eAAemN,gBAAgB7M,EAAElC,EAAE6E,KAAKO,IAAI,GAAG3F,EAAEO,IAAhyD,IAAsyD,IAAI9B,KAAKgQ,mBAAmBc,OAAO9Q,KAAK2N,OAAOxL,EAAEgD,iBAAiBnB,GAAc,cAAG,OAAOhE,KAAKyD,SAASsJ,UAAU,GAAG/M,KAAKS,KAAK,YAAW,IAAKT,KAAK2N,OAAO,YAAY3N,KAAKS,KAAK,aAAY,GAAIT,KAAK2Q,2BAA2B,MAAMxO,EAAEnC,KAAKgM,UAAUjK,KAAKgP,QAAQ/M,EAAEtD,YAAEV,KAAKgM,UAAUjK,KAAKoD,kBAAkByL,OAAO5Q,KAAKS,KAAK,aAAaT,KAAKgQ,mBAAmBgB,mBAAmB7O,EAAE6B,MAAM7B,YAAE,CAAC8B,YAAE,CAACa,UAAS,KAAMlF,EAAEiF,UAAU,iBAAY,GAAQ1C,YAAE,CAAC8B,YAAE,CAACa,UAAS,KAAMlF,EAAEiF,UAAU,gBAAW,GAAQjF,EAAEuC,YAAE,CAAChC,YAAE,8DAA8DP,GAAG,IAAIoF,EAAEpF,EAAiBoF","file":"static/js/48.d7fd7dcd.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as i}from\"../../../chunks/tslib.es6.js\";import{isSome as e}from\"../../../core/maybe.js\";import{whenTrueOnce as s,init as t,watch as r}from\"../../../core/watchUtils.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as p}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView3D as h}from\"./LayerView3D.js\";import n from\"./graphics/Graphics3DFrustumVisibility.js\";import o from\"./graphics/Graphics3DGraphicLikeLayerView.js\";import{enlargeExtent as c}from\"./graphics/graphicUtils.js\";import{toViewIfLocal as d}from\"./support/projectExtentUtils.js\";import u from\"../../layers/LayerView.js\";const l=1.2;let g=class extends(h(u)){constructor(){super(...arguments),this.type=\"graphics-3d\",this.frustumVisibility=new n,this.slicePlaneEnabled=!1,this.drapeSourceType=1,this.suspendResumeExtent=null,this.fullExtentInLocalViewSpatialReference=null}initialize(){this._set(\"graphics3d\",new o({owner:this,layer:this.layer,scaleVisibilityEnabled:!0})),this.graphics3d.setup(),this.frustumVisibility.setup(this),this.setupSuspendResumeExtent(),this.updatingHandles.add(this,\"fullOpacity\",(()=>this.graphics3d.graphicsCore.opacityChange())),this.handles.add(this.layer.on(\"graphic-update\",(i=>this.graphics3d.graphicsCore.graphicUpdateHandler(i)))),this.addResolvingPromise(d(this).then((i=>this.fullExtentInLocalViewSpatialReference=i))),this.layer.internal?this.notifyChange(\"updating\"):this.handles.add(s(this.view,\"basemapTerrain.ready\",(()=>this.notifyChange(\"updating\"))))}destroy(){this.frustumVisibility&&(this.frustumVisibility.destroy(),this._set(\"frustumVisibility\",null)),this.graphics3d&&(this.graphics3d.destroy(),this._set(\"graphics3d\",null))}get legendEnabled(){return this.canResume()&&!this.frustumVisibility.suspended}get suspendInfo(){var i;const s={};return e(this.graphics3d.scaleVisibility)&&this.graphics3d.scaleVisibility.suspended&&(s.outsideScaleRange=!0),s.outsideOfView=!(null==(i=this.frustumVisibility)||!i.suspended),s}async fetchPopupFeatures(i,s){return e(s)?s.clientGraphics:null}notifyGraphicGeometryChanged(i){this.graphics3d.graphicsCore.notifyGraphicGeometryChanged(i)}notifyGraphicVisibilityChanged(i){this.graphics3d.graphicsCore.notifyGraphicVisibilityChanged(i)}get graphics3DGraphics(){return this.graphics3d.graphicsCore.graphics3DGraphics}get graphics3DGraphicsByObjectID(){return this.graphics3d?this.graphics3d.graphicsCore.graphics3DGraphicsByObjectID:null}get symbolUpdateType(){return this.graphics3d.graphicsCore.symbolUpdateType}getGraphicFromGraphicUid(i){return this.graphics3d.getGraphicFromGraphicUid(i)}whenGraphicBounds(i,e){return this.graphics3d.whenGraphicBounds(i,e)}computeAttachmentOrigin(i,e){return this.graphics3d?this.graphics3d.graphicsCore.computeAttachmentOrigin(i,e):null}getSymbolLayerSize(i,e){return this.graphics3d.getSymbolLayerSize(i,e)}queryGraphics(){return Promise.resolve(this.loadedGraphics)}maskOccludee(i){return this.graphics3d.maskOccludee(i)}highlight(i){return this.graphics3d.highlight(i)}get updatePolicy(){var i;return(null==(i=this.graphics3d)?void 0:i.graphicsCore.effectiveUpdatePolicy)||1}canResume(){var i;return super.canResume()&&!(null!=(i=this.graphics3d)&&i.suspended)}isUpdating(){var i,e;return!(!(this.graphics3d&&this.graphics3d.updating||this.frustumVisibility&&this.frustumVisibility.updating)&&(this.layer.internal||null!=(i=this.view)&&null!=(e=i.basemapTerrain)&&e.ready))}setupSuspendResumeExtent(){const i=()=>{this.suspendResumeExtent=c(this.graphics3d.graphicsCore.computedExtent,this.suspendResumeExtent,l,this.graphics3d.graphicsCore.extentPadding),this.frustumVisibility.setExtent(this.suspendResumeExtent)};t(this.graphics3d.graphicsCore,\"computedExtent\",(()=>i()),!0),r(this.graphics3d.graphicsCore,\"extentPadding\",(()=>i()),!0)}get performanceInfo(){return{displayedNumberOfFeatures:this.loadedGraphics.length,maximumNumberOfFeatures:-1,totalNumberOfFeatures:-1,nodes:0,core:null,updating:this.updating,elevationUpdating:this.graphics3d.elevationAlignment.updating,visibilityFrustum:!this.frustumVisibility.suspended}}};i([a({aliasOf:\"layer.graphics\"})],g.prototype,\"loadedGraphics\",void 0),i([a({readOnly:!0})],g.prototype,\"suspended\",void 0),i([a({readOnly:!0})],g.prototype,\"legendEnabled\",null),i([a({readOnly:!0})],g.prototype,\"updating\",void 0),i([a()],g.prototype,\"layer\",void 0),i([a({readOnly:!0})],g.prototype,\"frustumVisibility\",void 0),i([a({readOnly:!0})],g.prototype,\"graphics3d\",void 0),i([a({type:Boolean})],g.prototype,\"slicePlaneEnabled\",void 0),i([a({readOnly:!0})],g.prototype,\"suspendInfo\",null),g=i([p(\"esri.views.3d.layers.GraphicsLayerView3D\")],g);var y=g;export default y;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{canProject as e,project as r}from\"../../../../geometry/support/webMercatorUtils.js\";import{projectGeometry as o}from\"../../../../portal/support/geometryServiceUtils.js\";function t(t){const l=t.view.spatialReference,s=t.layer.fullExtent,i=s&&s.spatialReference;return i?i.equals(l)?Promise.resolve(s.clone()):e(i,l)?Promise.resolve(r(s,l)):t.view.state.isLocal?o(s,l,t.layer.portalItem).then((e=>!t.destroyed&&e?e:void 0)).catch((()=>null)):Promise.resolve(null):Promise.resolve(null)}export{t as toViewIfLocal};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nfunction n(n,t){return n?t?4:3:t?3:2}function t(t,I,o,u,l){if(!I||!I.lengths.length)return null;const N=\"upperLeft\"===(null==l?void 0:l.originPosition)?-1:1;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);const s=t.coords,c=[],f=o?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:i,coords:T}=I,h=n(o,u);let g=0;for(const n of i){const t=e(f,T,g,n,o,u,N);t&&c.push(t),g+=n*h}if(c.sort(((n,t)=>{let e=N*n[2]-N*t[2];return 0===e&&o&&(e=n[4]-t[4]),e})),c.length){let n=6*c[0][2];s[0]=c[0][0]/n,s[1]=c[0][1]/n,o&&(n=6*c[0][4],s[2]=0!==n?c[0][3]/n:0),(s[0]<f[0]||s[0]>f[1]||s[1]<f[2]||s[1]>f[3]||o&&(s[2]<f[4]||s[2]>f[5]))&&(s.length=0)}if(!s.length){const n=I.lengths[0]?r(T,0,i[0],o,u):null;if(!n)return null;s[0]=n[0],s[1]=n[1],o&&n.length>2&&(s[2]=n[2])}return t}function e(t,e,r,I,o,u,l=1){const N=n(o,u);let s=r,c=r+N,f=0,i=0,T=0,h=0,g=0;for(let n=0,b=I-1;n<b;n++,s+=N,c+=N){const n=e[s],r=e[s+1],I=e[s+2],u=e[c],l=e[c+1],N=e[c+2];let E=n*l-u*r;h+=E,f+=(n+u)*E,i+=(r+l)*E,o&&(E=n*N-u*I,T+=(I+N)*E,g+=E),n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n),r<t[2]&&(t[2]=r),r>t[3]&&(t[3]=r),o&&(I<t[4]&&(t[4]=I),I>t[5]&&(t[5]=I))}if(h*l>0&&(h*=-1),g*l>0&&(g*=-1),!h)return null;const E=[f,i,.5*h];return o&&(E[3]=T,E[4]=.5*g),E}function r(t,e,r,N,s){const c=n(N,s);let f=e,i=e+c,T=0,h=0,g=0,E=0;for(let n=0,b=r-1;n<b;n++,f+=c,i+=c){const n=t[f],e=t[f+1],r=t[f+2],s=t[i],c=t[i+1],b=t[i+2],m=N?o(n,e,r,s,c,b):I(n,e,s,c);if(m)if(T+=m,N){const t=l(n,e,r,s,c,b);h+=m*t[0],g+=m*t[1],E+=m*t[2]}else{const t=u(n,e,s,c);h+=m*t[0],g+=m*t[1]}}return T>0?N?[h/T,g/T,E/T]:[h/T,g/T]:r>0?N?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function I(n,t,e,r){const I=e-n,o=r-t;return Math.sqrt(I*I+o*o)}function o(n,t,e,r,I,o){const u=r-n,l=I-t,N=o-e;return Math.sqrt(u*u+l*l+N*N)}function u(n,t,e,r){return[n+.5*(e-n),t+.5*(r-t)]}function l(n,t,e,r,I,o){return[n+.5*(r-n),t+.5*(I-t),e+.5*(o-e)]}export{t as getCentroidOptimizedGeometry,r as lineCentroid};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nvar r,t,o={exports:{}};r=o,void 0!==(t=function(){function r(r,o,n,f,e){t(r,o,n||0,f||r.length-1,e||a)}function t(r,a,n,f,e){for(;f>n;){if(f-n>600){var h=f-n+1,i=a-n+1,u=Math.log(h),M=.5*Math.exp(2*u/3),v=.5*Math.sqrt(u*M*(h-M)/h)*(i-h/2<0?-1:1);t(r,a,Math.max(n,Math.floor(a-i*M/h+v)),Math.min(f,Math.floor(a+(h-i)*M/h+v)),e)}var x=r[a],c=n,p=f;for(o(r,n,a),e(r[f],x)>0&&o(r,n,f);c<p;){for(o(r,c,p),c++,p--;e(r[c],x)<0;)c++;for(;e(r[p],x)>0;)p--}0===e(r[n],x)?o(r,n,p):o(r,++p,f),p<=a&&(n=p+1),a<=p&&(f=p-1)}}function o(r,t,o){var a=r[t];r[t]=r[o],r[o]=a}function a(r,t){return r<t?-1:r>t?1:0}return r}())&&(r.exports=t);var a=o.exports;export{a as q};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nclass e{constructor(){this.items=[]}addObject(e,t){this.items.push({type:0,objectStateId:t,object:e})}addRenderGeometry(e,t,s){this.items.push({type:1,objectStateId:t,renderGeometry:e,owner:s})}addExternal(e,t){this.items.push({type:2,objectStateId:t,remove:e})}remove(e){for(let t=this.items.length-1;t>=0;--t){const s=this.items[t];s.objectStateId===e&&(this._removeObjectStateItem(s),this.items.splice(t,1))}}removeObject(e){for(let t=this.items.length-1;t>=0;--t){const s=this.items[t];0===s.type&&s.object===e&&(this._removeObjectStateItem(s),this.items.splice(t,1))}}removeRenderGeometry(e){for(let t=this.items.length-1;t>=0;--t){const s=this.items[t];1===s.type&&s.renderGeometry===e&&(this._removeObjectStateItem(s),this.items.splice(t,1))}}removeAll(){this.items.forEach((e=>{this._removeObjectStateItem(e)})),this.items=[]}_removeObjectStateItem(e){switch(e.type){case 0:0===e.objectStateId.channel?e.object.removeHighlight(e.objectStateId):1===e.objectStateId.channel&&e.object.removeOcclude(e.objectStateId);break;case 1:e.owner.removeRenderGeometryObjectState(e.renderGeometry,e.objectStateId);break;case 2:e.remove(e.objectStateId)}}}export{e as Object3DStateSet};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{Object3DStateSet as t}from\"../../webgl-engine/lib/Object3DStateSet.js\";class e{constructor(e,i){this.stateType=e,this.objectIdField=i,this.objectStateSet=new t,this.ids=new Set,this.paused=!1}hasGraphic(t){if(this.objectIdField){const e=t.graphic.attributes[this.objectIdField];return this.ids.has(e)}return this.ids.has(t.graphic.uid)}}export{e as Graphics3DObjectStateSet};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{makeHandle as t}from\"../../../../core/handleUtils.js\";import{Graphics3DObjectStateSet as e}from\"./Graphics3DObjectStateSet.js\";class s{constructor(t){this._graphicsCore=t,this._stateSets=new Array}destroy(){this._stateSets&&this._stateSets.forEach((t=>t.objectStateSet.removeAll())),this._stateSets=null}acquireSet(s,a){const i=new e(s,a);this._stateSets.push(i);const h=t((()=>this.releaseSet(i)));return{set:i,handle:h}}releaseSet(t){t.objectStateSet.removeAll();const e=this._stateSets?this._stateSets.indexOf(t):-1;-1!==e&&this._stateSets.splice(e,1)}_addObjectStateSet(t,e){t.addObjectStateSet(e.stateType,e.objectStateSet)}_removeObjectStateSet(t,e){t.removeObjectState(e.objectStateSet)}setUid(t,e){t.ids.add(e);const s=this._graphicsCore.graphics3DGraphics.get(e);s&&this._addObjectStateSet(s,t)}setUids(t,e){e.forEach((e=>this.setUid(t,e)))}setObjectIds(t,e){e.forEach((e=>t.ids.add(e))),this.initializeSet(t)}addGraphic(t){this._stateSets.forEach((e=>{!e.paused&&e.hasGraphic(t)&&this._addObjectStateSet(t,e)}))}removeGraphic(t){this._stateSets.forEach((e=>{e.hasGraphic(t)&&this._removeObjectStateSet(t,e)}))}allGraphicsDeleted(){this._stateSets&&this._stateSets.forEach((t=>t.objectStateSet.removeAll()))}initializeSet(t){const e=this._graphicsCore.graphics3DGraphics;t.objectIdField?e.forEach((e=>{e&&t.hasGraphic(e)&&this._addObjectStateSet(e,t)})):t.ids.forEach((s=>{const a=e.get(s);a&&this._addObjectStateSet(a,t)}))}get test(){return{states:this._stateSets}}}export{s as Graphics3DObjectStates};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/PooledArray.js\";import{create as e,set as r,area as s,expand as n,contains as o,containsPoint as i}from\"../../../../geometry/support/aaBoundingRect.js\";import{noBudget as h}from\"../../../support/Scheduler.js\";const a=.05;class c{constructor(){this._extents=new t({allocator:t=>t||e()}),this._tmpExtent=e(),this._dirty=!1}get empty(){return 0===this._extents.length}get size(){return this._extents.length}clear(){this._extents.clear()}add(t){this.contains(t)||(this.removeContained(t),r(this._extents.pushNew(),t),this._dirty=!0)}pop(){return this._dirty&&this.mergeTight(),this._extents.pop()}merge(t){return this.mergeTight(t),t.hasProgressed}mergeTight(t=h){const e=this._extents,o=new Set;let i=0;for(;i!==e.length;){e.sort(((t,e)=>t[0]-e[0])),i=e.length,o.clear();for(let i=0;i<e.length;++i){if(t.done)return;const h=e.getItemAt(i);for(let t=i+1;t<e.length;++t){const r=e.getItemAt(t);if(r[0]>=h[2])break;o.add(r)}o.forEach((i=>{if(h===i)return;if(i[2]<=h[0])return void o.delete(i);const c=s(h),g=s(i),m=this._tmpExtent;n(h,i,m);const d=c+g;(s(m)-d)/d<a&&(r(h,m),o.delete(i),e.remove(i),t.madeProgress())})),o.add(h)}}this._dirty=!1}contains(t){return this._extents.some((e=>o(e,t)))}removeContained(t){this._extents.filterInPlace((e=>!o(t,e)))}get test(){const t=this;return{containsPoint:e=>t._extents.some((t=>i(t,e)))}}}export{c as ExtentSet};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import i from\"../../../../core/Evented.js\";import s from\"../../../../core/Handles.js\";import{isSome as r}from\"../../../../core/maybe.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as n}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{ExtentSet as h}from\"./ExtentSet.js\";import{TaskPriority as o}from\"../../../support/Scheduler.js\";let p=class extends t{constructor(){super(...arguments),this.dirtyExtents=new h,this.globalDirty=!1,this.averageExtentUpdateSize=0,this.dirtyGraphicsSet=new Set,this.handles=new s,this.updateElevation=!1,this.layerView=null,this.graphicsCore=null,this.events=new i}setup(e,t,i,s){this.layerView=e,this.queryGraphicUIDsInExtent=t,this.graphicsCore=i,this.elevationProvider=s;const r=this.layerView.view.resourceController.scheduler;this.handles.add([s.on(\"elevation-change\",(e=>this._elevationChanged(e))),this.layerView.watch(\"suspended\",(()=>this.suspendedChange())),r.registerTask(o.ELEVATION_ALIGNMENT,this)])}destroy(){this.dirtyGraphicsSet.clear(),this.handles.destroy(),this.handles=null,this.layerView=null,this.graphicsCore=null,this.queryGraphicUIDsInExtent=null}clear(){this.dirtyGraphicsSet.clear(),this.notifyChange(\"updating\")}suspendedChange(){!0===this.layerView.suspended?this.updateElevation=!1:!1===this.layerView.suspended&&this.updateElevation&&(this.globalDirty=!0,this.notifyChange(\"updating\"))}elevationInfoChange(){this.globalDirty=!0,this.notifyChange(\"updating\")}get updating(){return this.running}get running(){return this.dirtyGraphicsSet.size>0||this.dirtyExtents&&!this.dirtyExtents.empty||this.globalDirty}get updatingRemaining(){return this.dirtyGraphicsSet.size+this.dirtyExtents.size*this.averageExtentUpdateSize}runTask(e){for(this.globalDirty&&(this.markAllGraphicsElevationDirty(),this.globalDirty=!1,e.madeProgress()),e.run((()=>this.dirtyExtents.merge(e)));this.running&&!e.done;)this._updateDirtyGraphics(e),this._updateDirtyExtents(e);this.layerView.view.deconflictor.setDirty(),this.notifyChange(\"updating\")}_updateDirtyGraphics(e){const t=this.layerView.view.renderCoordsHelper,i=0===this.graphicsCore.effectiveUpdatePolicy;for(const s of this.dirtyGraphicsSet.keys()){const a=this.graphicsCore.getGraphics3DGraphicById(s);if(this.dirtyGraphicsSet.delete(s),r(a)&&(a.alignWithElevation(this.elevationProvider,t,i),e.madeProgress()),e.done)return}}_updateDirtyExtents(e){for(;!this.dirtyExtents.empty&&!e.done;){const t=this.dirtyExtents.pop(),i=this.elevationProvider.spatialReference;this.events.emit(\"invalidate-elevation\",{extent:t,spatialReference:i});const s=this.dirtyGraphicsSet.size;this.queryGraphicUIDsInExtent(t,i,(e=>{const t=this.graphicsCore.getGraphics3DGraphicById(e);r(t)&&t.needsElevationUpdates()&&this.dirtyGraphicsSet.add(e)})),this.averageExtentUpdateSize=.1*(this.dirtyGraphicsSet.size-s)+.9*this.averageExtentUpdateSize,e.madeProgress()}}markAllGraphicsElevationDirty(){this.dirtyExtents.clear(),this.dirtyGraphicsSet.clear(),this.graphicsCore.graphics3DGraphics.forEach(((e,t)=>this.dirtyGraphicsSet.add(t)))}_elevationChanged(e){if(\"scene\"===e.context&&(!this.graphicsCore.layer.elevationInfo||\"relative-to-scene\"!==this.graphicsCore.layer.elevationInfo.mode))return;const{extent:t,spatialReference:i}=e;if(this.layerView.suspended){if(!this.updateElevation){const e=this.graphicsCore.computedExtent;e&&t[2]>e.xmin&&t[0]<e.xmax&&t[3]>e.ymin&&t[1]<e.ymax&&(this.updateElevation=!0)}this.events.emit(\"invalidate-elevation\",{extent:t,spatialReference:i})}else t[0]===-1/0?this.globalDirty=!0:this.dirtyExtents.add(t),this.notifyChange(\"updating\")}};e([a({readOnly:!0})],p.prototype,\"updating\",null),e([a({readOnly:!0})],p.prototype,\"updatingRemaining\",null),p=e([n(\"esri.views.3d.layers.graphics.Graphics3DElevationAlignment\")],p);var d=p;export default d;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import e from\"../../../../Graphic.js\";import i from\"../../../../core/Accessor.js\";import s from\"../../../../core/Collection.js\";import r from\"../../../../core/Handles.js\";import{isSome as a,destroyMaybe as o,isNone as n}from\"../../../../core/maybe.js\";import{isAbortError as c}from\"../../../../core/promiseUtils.js\";import{init as h}from\"../../../../core/watchUtils.js\";import{property as p}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as l}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{diff as d}from\"../../../../core/accessorSupport/diffUtils.js\";import u from\"../../../../layers/Layer.js\";import{hydrateGraphic as g}from\"../../../../layers/graphics/hydratedFeatures.js\";import m from\"../../../../rest/support/Query.js\";import{SUSPEND_RESUME_EXTENT_OPTIMISM as y}from\"./constants.js\";import{Graphics3DCore as f}from\"./Graphics3DCore.js\";import b from\"./Graphics3DElevationAlignment.js\";import{Graphics3DObjectStates as j}from\"./Graphics3DObjectStates.js\";import w from\"./Graphics3DScaleVisibility.js\";import{enlargeExtent as C}from\"./graphicUtils.js\";import{WatchUpdatingTracking as S}from\"../../../support/WatchUpdatingTracking.js\";let v=class extends i{constructor(t){super(t),this.graphicsCore=null,this.elevationAlignment=new b,this.watchUpdatingTracking=new S,this.handles=new r,this.suspendResumeExtent=null}normalizeCtorArgs(t){let e=null;t.scaleVisibilityEnabled&&(delete(t={...t}).scaleVisibilityEnabled,e=new w);const i=new f({owner:t.owner,layer:t.layer,preferredUpdatePolicy:1,graphicSymbolSupported:!0});return{...t,graphicsCore:i,scaleVisibility:e}}initialize(){const t=this.scaleVisibility;a(t)&&\"minScale\"in this.layer&&this.watchUpdatingTracking.add(this.layer,\"scaleRangeId\",(()=>t.layerMinMaxScaleChangeHandler())),\"elevationInfo\"in this.layer&&this.watchUpdatingTracking.add(this.layer,\"elevationInfo\",((t,e)=>{d(t,e)&&this.watchUpdatingTracking.addPromise(this.graphicsCore.elevationInfoChange())}))}async setup(){const t=(t,e,i)=>this.graphicsCore.spatialIndex.queryGraphicUIDsInExtent(t,e,i);if(this.elevationAlignment.setup(this.owner,t,this.graphicsCore,this.view.elevationProvider),a(this.scaleVisibility)&&\"minScale\"in this.layer){const e=this.owner.view.basemapTerrain;this.scaleVisibility.setup(this.owner,this.layer,t,this.graphicsCore,e)}this._set(\"objectStates\",new j(this.graphicsCore));try{await this.graphicsCore.setup({elevationAlignment:this.elevationAlignment,scaleVisibility:this.scaleVisibility,objectStates:this.objectStates})}catch(e){if(c(e))return;throw e}this.destroyed||(this.handles.add(this.view.watch(\"clippingArea\",(()=>this.updateClippingExtent()),!0)),this.updateClippingExtent(),this.setupSuspendResumeExtent(),this.graphicsCore.startCreateGraphics())}destroy(){this.handles=o(this.handles),this.watchUpdatingTracking.destroy(),this._set(\"elevationAlignment\",o(this.elevationAlignment)),this._set(\"scaleVisibility\",o(this.scaleVisibility)),this._set(\"objectStates\",o(this.objectStates)),this._set(\"graphicsCore\",o(this.graphicsCore))}get suspended(){return!(!a(this.scaleVisibility)||!this.scaleVisibility.suspended)}get updating(){var t,e;return!!(null!=(t=this.graphicsCore)&&t.updating||a(this.scaleVisibility)&&this.scaleVisibility.updating||null!=(e=this.watchUpdatingTracking)&&e.updating)}getGraphicFromGraphicUid(t){if(this.owner.loadedGraphics){const e=this.owner.loadedGraphics.find((e=>e.uid===t));if(e){const t=this.layer instanceof u?this.layer:null;return g(e,t)}}}whenGraphicBounds(t,e){return this.graphicsCore?this.graphicsCore.whenGraphicBounds(t,e):Promise.reject()}computeAttachmentOrigin(t,e){return this.graphicsCore?this.graphicsCore.computeAttachmentOrigin(t,e):null}getSymbolLayerSize(t,e){return this.graphicsCore?this.graphicsCore.getSymbolLayerSize(t,e):null}maskOccludee(t){const{set:e,handle:i}=this.objectStates.acquireSet(1,null);return this.objectStates.setUid(e,t.uid),i}highlight(t){if(t instanceof m)return x;if(\"number\"==typeof t)return this.highlight([t]);if(t instanceof e)return this.highlight([t]);if(t instanceof s&&(t=t.toArray()),Array.isArray(t)&&t.length>0){if(t[0]instanceof e){const e=t.map((t=>t.uid)),{set:i,handle:s}=this.objectStates.acquireSet(0,null);return this.objectStates.setUids(i,e),s}if(\"number\"==typeof t[0]){const e=t,{set:i,handle:s}=this.objectStates.acquireSet(0,null);return this.objectStates.setObjectIds(i,e),s}}return x}updateClippingExtent(){const t=this.view.clippingArea;this.graphicsCore.setClippingExtent(t,this.view.spatialReference)&&this.graphicsCore.recreateAllGraphics()}updateSuspendResumeExtent(){n(this.scaleVisibility)||(this.suspendResumeExtent=C(this.graphicsCore.computedExtent,this.suspendResumeExtent,y,this.graphicsCore.extentPadding),this.scaleVisibility.setExtent(this.suspendResumeExtent))}setupSuspendResumeExtent(){n(this.scaleVisibility)||(h(this.graphicsCore,\"computedExtent\",(t=>this.updateSuspendResumeExtent()),!0),this.graphicsCore.watch(\"extentPadding\",(t=>this.updateSuspendResumeExtent())))}};t([p({constructOnly:!0})],v.prototype,\"owner\",void 0),t([p({constructOnly:!0})],v.prototype,\"layer\",void 0),t([p({readOnly:!0,aliasOf:\"owner.view\"})],v.prototype,\"view\",void 0),t([p({constructOnly:!0})],v.prototype,\"graphicsCore\",void 0),t([p({constructOnly:!0})],v.prototype,\"scaleVisibility\",void 0),t([p({readOnly:!0})],v.prototype,\"elevationAlignment\",void 0),t([p({readOnly:!0})],v.prototype,\"objectStates\",void 0),t([p({readOnly:!0})],v.prototype,\"watchUpdatingTracking\",void 0),t([p({readOnly:!0})],v.prototype,\"suspended\",null),t([p({readOnly:!0})],v.prototype,\"updating\",null),v=t([l(\"esri.views.3d.layers.graphics.Graphics3DGraphicLikeLayerView\")],v);const x={remove(){},pause(){},resume(){}};var E=v;export default E;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import s from\"../../../../core/Handles.js\";import{init as i}from\"../../../../core/watchUtils.js\";import{property as r}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as n}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{getReferenceEllipsoid as o}from\"../../../../geometry/projectionEllipsoid.js\";import{FrustumExtentIntersection as a}from\"../../support/FrustumExtentIntersection.js\";import{TaskPriority as l}from\"../../../support/Scheduler.js\";const h=1.2;let u=class extends t{constructor(){super(...arguments),this.suspended=!1,this.extent=null,this.extentIntersectionDirty=!0,this._isVisibleBelowSurface=!1,this.handles=new s,this.layerView=null,this.updating=!0}setup(e){this.layerView=e,this.extentIntersection=new a({renderCoordsHelper:e.view.renderCoordsHelper});const t=e.view,s=t.basemapTerrain,r=t.resourceController.scheduler;this.handles.add([t.on(\"resize\",(()=>this.viewChange())),t.state.watch(\"camera\",(()=>this.viewChange()),!0),r.registerTask(l.FRUSTUM_VISIBILITY,this),s.on(\"elevation-bounds-change\",(()=>this.elevationBoundsChange()))]),\"local\"===t.viewingMode?this.isVisibleBelowSurface=!0:this.handles.add([i(s,[\"opacity\",\"wireframe\"],(()=>this.updateIsVisibleBelowSurface())),i(t,\"map.ground.navigationConstraint.type\",(()=>this.updateIsVisibleBelowSurface()))])}destroy(){this.layerView=null,this.extent=null,this.extentIntersection=null,this.handles&&(this.handles.destroy(),this.handles=null)}_setDirty(){this.updating||this._set(\"updating\",!0)}setExtent(e){this.extent=e,this.extentIntersectionDirty=!0,this._setDirty()}viewChange(){this._setDirty()}elevationBoundsChange(){this._setDirty(),this.extentIntersectionDirty=!0}set isVisibleBelowSurface(e){this._isVisibleBelowSurface=e,this._setDirty(),this.extentIntersectionDirty=!0}updateIsVisibleBelowSurface(){const e=this.layerView.view,t=e.basemapTerrain,s=\"local\"===e.viewingMode,i=e.map.ground&&e.map.ground.navigationConstraint&&\"none\"===e.map.ground.navigationConstraint.type;this.isVisibleBelowSurface=s||!t.opaque||i}updateExtentIntersection(){if(!this.extentIntersectionDirty)return;this.extentIntersectionDirty=!1;const e=this.layerView.view;let t;if(this._isVisibleBelowSurface)t=-.3*o(e.spatialReference).radius;else{const{min:s,max:i}=e.basemapTerrain.elevationBounds;t=s-Math.max(1,(i-s)*(h-1))}this.extentIntersection.update(this.extent,e.spatialReference,t)}get running(){return this.updating}runTask(){if(this._set(\"updating\",!1),!this.extent)return void this._set(\"suspended\",!1);this.updateExtentIntersection();const e=this.layerView.view.frustum,t=o(this.layerView.view.spatialReference).radius;this._set(\"suspended\",!this.extentIntersection.isVisibleInFrustum(e,t))}};e([r({readOnly:!0})],u.prototype,\"suspended\",void 0),e([r({readOnly:!0})],u.prototype,\"updating\",void 0),u=e([n(\"esri.views.3d.layers.graphics.Graphics3DFrustumVisibility\")],u);var p=u;export default p;\n"],"sourceRoot":""}