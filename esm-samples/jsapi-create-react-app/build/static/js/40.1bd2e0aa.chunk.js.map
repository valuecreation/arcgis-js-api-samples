{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/interactive/Manipulator3D.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ShadedColorMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/ShadedColorMaterial.js","../node_modules/@arcgis/core/views/3d/interactive/manipulatorUtils.js","../node_modules/@arcgis/core/views/3d/interactive/analysisTools/slice/sliceToolConfig.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/SlicePlaneMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/SlicePlaneMaterial.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/SlicePlaneVisualElement.js","../node_modules/@arcgis/core/widgets/Slice/SlicePlane.js","../node_modules/@arcgis/core/views/3d/interactive/analysisTools/slice/sliceToolUtils.js","../node_modules/@arcgis/core/views/3d/interactive/graphics/Slice/SliceController.js","../node_modules/@arcgis/core/views/3d/interactive/graphics/Slice/SliceView.js","../node_modules/@arcgis/core/views/3d/layers/analysis/Slice/SliceLayerViewData.js","../node_modules/@arcgis/core/views/3d/layers/SliceLayerView3D.js","../node_modules/@arcgis/core/layers/support/I3SIndexInfo.js","../node_modules/@arcgis/core/chunks/ImageMaterial.glsl.js","../node_modules/@arcgis/core/portal/support/resourceExtension.js","../node_modules/@arcgis/core/core/accessorSupport/decorators/persistable.js","../node_modules/@arcgis/core/layers/support/I3SLayerDefinitions.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/Object3DVisualElement.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ImageMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/ImageMaterial.js","../node_modules/@arcgis/core/layers/buildingSublayers/BuildingComponentSublayer.js","../node_modules/@arcgis/core/layers/buildingSublayers/BuildingSublayer.js","../node_modules/@arcgis/core/layers/support/capabilities.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElement.js","../node_modules/@arcgis/core/views/3d/interactive/visualElements/LineVisualElement.js","../node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js","../node_modules/@arcgis/core/chunks/ShadedColorMaterial.glsl.js","../node_modules/@arcgis/core/chunks/SlicePlaneMaterial.glsl.js"],"names":["a","B","U","_","v","H","E","X","x","y","z","spatialReference","S","p","initializeProgram","e","r","shader","get","i","this","configuration","t","build","output","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","screenSizeEnabled","shadingEnabled","OITEnabled","transparencyPassType","multipassTerrainEnabled","cullAboveGround","b","rctx","P","bindPass","color","n","shadingTint","l","shadingDirection","s","program","camera","projectionMatrix","setUniform4fv","setUniform2fv","nearFar","inverseViewport","o","blendColor","w","setUniform3fv","setUniformMatrix4fv","viewInverseTransposeMatrix","bindDraw","origin","rebindTextures","setPipelineState","blending","transparent","h","m","culling","cullFace","depthTest","func","depthWrite","writeDepth","T","u","colorWrite","polygonOffset","g","initializePipeline","f","j","d","constructor","super","arguments","c","count","prototype","Map","Math","cos","backgroundColor","gridColor","setUniform1f","gridWidth","intersect","createBufferWriter","getGLMaterial","_technique","_techniqueRep","constructionContext","updateParameters","beginSlot","bind","_material","params","_renderOccluded","_gridWidth","_gridColor","_backgroundColor","applyProps","_updateMaterial","createExternalResources","materialParameters","destroyExternalResources","forEachExternalMaterial","createGeometries","createSquareGeometry","addGeometry","renderOccluded","setParameterValues","type","position","heading","tilt","width","height","clone","equals","readOnly","json","read","write","Number","nonNullable","range","min","max","normalize","Ge","getLogger","xe","worldUpAtPosition","D","basis1","ct","round","ft","at","Ee","Fe","fromRenderCoords","worldBasisAtPosition","k","basis2","lt","PI","V","_handles","_internalChange","_currentSlicePlane","state","initialize","add","layerView","layerViewData","excludedLayers","on","item","error","title","id","preventDefault","includes","view","_initialize","Error","has","set","all","activeController","push","watch","_updateSlicePlaneFromBoundedPlane","_updateLayerViews","_updateActiveController","_updateViewSlicePlane","allLayerViews","analysis","_updateBoundedPlaneFromSlicePlane","_set","destroy","active","lastIndexOf","splice","length","delete","slicePlane","plane","A","toRenderCoords","C","F","wkid","renderCoordsHelper","console","warn","tiltEnabled","visible","layers","forEach","indexOf","layer","sublayerViews","sublayer","basemapTerrain","excludeGroundSurface","_gridVisualElement","_outlineVisualElement","_updateMaterials","ve","attached","re","oe","Pe","se","writeDepthEnabled","geometry","_updatePlane","_update","transform","editable","stipplePattern","showGrid","value","_get","cast","analysisView","analysisController","_initialized","resolve","destroyed","promise","whenReady","controller","aliasOf","async","floor","rootIndex","nodesPerPage","rootPage","query","token","responseType","signal","data","pageSize","lodMetric","lodSelectionMetricType","urlPrefix","split","pop","rootNode","pageError","nodeError","url","include","linearDepth","vertex","uniforms","attributes","varyings","code","fragment","float","Object","freeze","__proto__","Blob","png","jpeg","jpg","bmp","gif","txt","xml","svg","zip","pbf","gz","origins","String","writer","resources","verifyItemRelativeUrls","writtenUrls","rootPath","originIdOf","portalItem","resourceFromPath","path","O","toUpdate","toKeep","resource","I","pendingOperations","default","then","itemRelativeUrl","catch","toAdd","content","finish","R","JSON","stringify","toJSON","factor","source","baseColorFactor","baseColorTexture","metallicRoughnessTexture","metallicFactor","roughnessFactor","alphaMode","alphaCutoff","doubleSided","normalTexture","occlusionTexture","emissiveTexture","emissiveFactor","pbrMetallicRoughness","opaque","mask","blend","Boolean","none","back","front","reader","index","dds","ktx2","basis","atlas","Float32","UInt64","UInt32","UInt16","UInt8","draco","offset","triangle","_resources","_transform","object","transformation","recreate","createResources","recreateGeometry","_stage","removeMany","geometries","removeAllGeometries","setVisible","addMany","destroyResources","isPickable","updatePolicy","castShadow","remove","dispose","updateVisibility","opacity","stencilWrite","sceneHasOcludees","stencilTest","enableOffset","_occludeePipelineState","getPipelineState","pipeline","supportsEdges","techniqueConfig","getTechniqueConfig","relativeElevation","material","updateTexture","textureId","releaseAndAcquire","_output","_updateOccludeeState","hasOccludees","ensureParameters","bindTextures","bindTextureScale","initTextureTransparent","Q","L","LoadableMixin","nodePages","materialDefinitions","textureSetDefinitions","geometryDefinitions","serviceUpdateTimeStamp","fields","associatedLayer","outFields","listMode","renderer","definitionExpression","popupEnabled","popupTemplate","layerType","parsedUrl","readAssociatedLayer","associatedFeatureServiceItem","associatedLayerID","layerId","name","displayField","createPopupTemplate","load","_fetchService","indexInfo","apiKey","addResolvingPromise","Promise","q","getField","fieldsIndex","getFieldDomain","getFeatureType","feature","domains","domain","types","typeIdField","capabilities","supportsZ","supportsM","isVersioned","createQuery","geometryType","returnGeometry","returnZ","where","sqlFormat","queryExtent","_getAssociatedLayerForQuery","queryFeatureCount","queryFeatures","features","sourceLayer","queryObjectIds","getFieldUsageInfo","supportsLabelingInfo","supportsRenderer","supportsPopupTemplate","supportsLayerQuery","loaded","_loadAssociatedLayerForQuery","service","enabled","allowNull","target","Point","modelName","isEmpty","readTitle","alias","readIdOnlyOnce","ignoreOrigin","attachment","supportsContentType","supportsExifInfo","supportsKeywords","supportsName","supportsSize","supportsAttachment","editing","supportsDeleteByAnonymous","supportsDeleteByOthers","supportsGeometryUpdate","supportsGlobalId","supportsReturnServiceEditsInSourceSpatialReference","supportsRollbackOnFailure","supportsUpdateByAnonymous","supportsUpdateByOthers","supportsUpdateWithoutM","supportsUploadWithItemId","metadata","supportsAdvancedFieldProperties","operations","supportsCalculate","supportsTruncate","supportsValidateSql","supportsAdd","supportsDelete","supportsEditing","supportsChangeTracking","supportsQuery","supportsQueryAttachments","supportsResizeAttachments","supportsSync","supportsUpdate","supportsExceedsLimitStatistics","queryRelated","supportsCount","supportsOrderBy","supportsPagination","maxRecordCount","maxRecordCountFactor","standardMaxRecordCount","supportsCacheHint","supportsCentroid","supportsDisjointSpatialRelationship","supportsDistance","supportsDistinct","supportsExtent","supportsFormatPBF","supportsGeometryProperties","supportsHavingClause","supportsHistoricMoment","supportsMaxRecordCountFactor","supportsPercentileStatistics","supportsQuantization","supportsQuantizationEditMode","supportsQueryByOthers","supportsQueryGeometry","supportsResultType","supportsSqlExpression","supportsStandardizedQueriesOnly","supportsTopFeaturesQuery","supportsStatistics","tileMaxRecordCount","_attached","_resourcesCreated","_visible","_createResources","_destroyResources","_width","_color","_innerWidth","_innerColor","_stipplePattern","_stippleOffColor","_stippleIntegerRepeats","_writeDepthEnabled","_falloff","_polygonOffset","setGeometryFromExtent","setGeometryFromFrustum","lines","endpoint","setGeometryFromBoundedPlane","setGeometryFromSegment","endRenderSpace","points","createRenderGeometry","setGeometryFromSegments","map","_geometry","_createLineGeometries","stippleOffColor","isClosed","falloff","innerColor","innerWidth","stippleIntegerRepeats","Float64Array","attributeData","removeDuplicateStartEnd","perScreenPixelRatio","screenSize","extensions"],"mappings":"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","file":"static/js/40.1bd2e0aa.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport\"../../../geometry.js\";import{neverReached as e}from\"../../../core/compilerUtils.js\";import t from\"../../../core/Evented.js\";import{deg2rad as i}from\"../../../core/mathUtils.js\";import{isSome as s,isNone as o,unwrapOr as r,unwrap as n}from\"../../../core/maybe.js\";import{createScreenPointArray as a,createRenderScreenPointArray3 as c,screenPointObjectToArray as l,castRenderScreenPointArray as h}from\"../../../core/screenUtils.js\";import{once as d}from\"../../../core/accessorSupport/utils.js\";import{f as u}from\"../../../chunks/mat3.js\";import{c as _}from\"../../../chunks/mat3f64.js\";import{d as g,h as m,m as f,i as p}from\"../../../chunks/mat4.js\";import{c as v}from\"../../../chunks/mat4f64.js\";import{j as b}from\"../../../chunks/vec2.js\";import{b as y,t as j,m as L,a as S,g as R,h as w,s as O,f as T}from\"../../../chunks/vec3.js\";import{c as E,Z as A}from\"../../../chunks/vec3f64.js\";import{canProjectWithoutEngine as D,projectPoint as F,sphericalPCPFtoLonLatElevation as z,computeLatLonToENURotation as k}from\"../../../geometry/projection.js\";import{getReferenceEllipsoid as P}from\"../../../geometry/projectionEllipsoid.js\";import{containsPointObject as I}from\"../../../geometry/support/aaBoundingRect.js\";import{distance2 as M,fromPoints as C,closestRayDistance2 as x,create as B}from\"../../../geometry/support/lineSegment.js\";import{fromPositionAndNormal as W,intersectRay as V,create as H}from\"../../../geometry/support/plane.js\";import{create as U}from\"../../../geometry/support/ray.js\";import{sv3d as G}from\"../../../geometry/support/vectorStacks.js\";import{clonePoint as Z}from\"../../../layers/graphics/hydratedFeatures.js\";import{getElevationAtPoint as q}from\"../support/ElevationProvider.js\";import{fromScreen as J}from\"../support/geometryUtils/ray.js\";import K from\"../webgl-engine/lib/Camera.js\";import{Object3D as N}from\"../webgl-engine/lib/Object3D.js\";import{WebGLLayer as Q}from\"../webgl-engine/lib/WebGLLayer.js\";import X from\"../../../geometry/Point.js\";class Y{constructor(e){this.idHint=0,this.camera=new K,this._elevation={offset:0,override:null},this.collisionType={type:\"point\"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=v(),this._worldFrame=null,this._renderLocation=E(),this._renderLocationDirty=!0,this._location=new X({x:0,y:0,z:0}),this._elevationAlignedLocation=new X,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=0,this._focused=!1,this.events=new t.EventEmitter,this._screenLocation={screenPointArray:a(),renderScreenPointArray:c(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayer=null,this._materialIdReferences=null,this._location.spatialReference=e.view.spatialReference;for(const t in e)this[t]=e[t];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera)}destroy(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this.camera=null}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}set available(e){e!==this._available&&(this._available=e,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:d((()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()}))}}set radius(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}get radius(){return this._radius}set worldSized(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(e){$(e)&&(this._screenLocationDirty=!0),g(this._modelTransform,e),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=v()),ee(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(e){Z(e,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit(\"location-update\",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(e){Z(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit(\"location-update\",{location:this._location})}_updateElevationAlignedLocation(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;const e=s(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=this.location.spatialReference,this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit(\"select-changed\",{action:e?\"select\":\"deselect\"}))}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._updateEngineObject())}updateStateEnabled(e,t){t?this.state|=e:this.state&=~e}_setFocused(e){e!==this._focused&&(this._focused=e,this.events.emit(\"focus-changed\",{action:!0===e?\"focus\":\"unfocus\"}))}get focused(){return this._focused}get screenLocation(){return this.ensureScreenLocation(),this._screenLocation}ensureScreenLocation(){if(!this._screenLocationDirty)return;this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1;let e;if($(this._modelTransform)){const t=this._calculateModelTransformOffset(_e);e=y(t,t,this.renderLocation)}else e=this.renderLocation;this.camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}intersectionDistance(t,i){if(!this.available)return null;const s=l(t,te),r=this._getCollisionRadius(i),n=-1*this.collisionPriority;switch(this.collisionType.type){case\"point\":if(b(this.screenLocation.screenPointArray,s)<r*r)return this.screenLocation.renderScreenPointArray[2]+n;break;case\"line\":{const e=this.collisionType.paths,t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,ne),a=r*this.screenLocation.pixelSize,c=J(this.camera,s,se);if(o(c))return null;for(const s of e){if(0===s.length)continue;const e=L(ce,s[0],i);for(let t=1;t<s.length;t++){const o=L(le,s[t],i),r=x(C(e,o,ie),c);if(null!=r&&r<a*a){const t=y(G.get(),e,o);S(t,t,.5);const i=h(G.get());return this.camera.projectToRenderScreen(t,i),i[2]+n}R(e,o)}}break}case\"disc\":{var a;const e=this.collisionType.direction,t=null!=(a=this.collisionType.offset)?a:A,i=this._getWorldToScreenObjectScale(),c=this._calculateObjectTransform(i,ne),l=r*this.screenLocation.pixelSize,h=J(this.camera,s,se);if(o(h))return null;const d=u(oe,c),_=j(de,e,d),g=L(ue,t,c);W(g,_,ae);const m=he;if(V(ae,h,m)&&w(m,g)<l*l)return this.screenLocation.renderScreenPointArray[2]+n;break}case\"ribbon\":{const{paths:e,direction:t}=this.collisionType,i=this._getWorldToScreenObjectScale(),a=this._calculateObjectTransform(i,ne),c=r*this.camera.computeScreenPixelSizeAt(this.renderLocation),l=J(this.camera,s,se);if(o(l))return null;const d=u(oe,a),_=j(de,t,d),g=this._calculateModelTransformPosition(ue);W(g,_,ae);const m=he;if(!V(ae,l,m))break;for(const s of e){if(0===s.length)continue;const e=L(ce,s[0],a);for(let t=1;t<s.length;t++){const i=L(le,s[t],a),o=M(C(e,i,ie),m);if(null!=o&&o<c*c){const t=y(G.get(),e,i);S(t,t,.5);const s=h(G.get());return this.camera.projectToRenderScreen(t,s),s[2]+n}R(e,i)}}break}default:e(this.collisionType)}return null}attach(e={manipulator3D:{}}){var t;if(!this.view._stage)return;const i=e.manipulator3D;if(o(i.engineLayerId)){const e=new Q({isPickable:!1,updatePolicy:1});this.view._stage.add(e),i.engineLayerId=e.id,this._engineLayer=e}else null!=(t=this.view._stage)&&t.getObject&&(this._engineLayer=this.view._stage.getObject(i.engineLayerId));i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,o(this._materialIdReferences)&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this.camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),D(this._location.spatialReference,this.view.spatialReference)||(this.location=new X({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(e={manipulator3D:{}}){const t=e.manipulator3D;t.engineLayerReferences--;const i=0===t.engineLayerReferences;i&&(t.engineLayerId=null),this._removeResourcesFromStage(i),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this.camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(e){F(this.location,ge,e.spatialReference),I(e.extent,ge)&&(this.location=this._location)}_evaluateElevationAlignment(e=this.location){if(o(this.elevationInfo))return!1;let t=null,i=0;const s=r(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case\"on-the-ground\":t=r(q(this.view.elevationProvider,e,\"ground\"),0);break;case\"relative-to-ground\":i=r(q(this.view.elevationProvider,e,\"ground\"),0)+s;break;case\"relative-to-scene\":i=r(q(this.view.elevationProvider,e,\"scene\"),0)+s;break;case\"absolute-height\":i=s}return(i!==this._elevation.offset||t!==this._elevation.override)&&(this._elevation.offset=i,this._elevation.override=t,!0)}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const e=this._getWorldToScreenObjectScale(),t=ne;if(!0===this.autoScaleRenderObjects){const i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);const{objectsByState:i}=this._ensureEngineResources(),s=(this.focused?2:1)|(this.selected?8:4),o=this._noDisplayCount>0;for(const{stateMask:r,objects:n}of i){if(o){for(const e of n)e.setVisible(!1);continue}const e=!(0!=(15&r))||(s&r)==(15&r),i=!(0!=(65520&r))||(this.state&r)==(65520&r);if(e&&i)for(const s of n)s.setVisible(!0),s.transformation=t;else for(const t of n)t.setVisible(!1)}}_ensureEngineResources(){if(o(this._engineResources)){const e=n(this._engineLayer),t=[],i=new Set;this.renderObjects.forEach((({material:e})=>{i.has(e)||(t.push(e),i.add(e))}));const s=(e,t)=>{const{geometry:i,material:s,transform:o}=t;Array.isArray(i)?i.forEach((t=>e.addGeometry(t,s,o))):e.addGeometry(i,s,o)},o=new Map;this._renderObjects.forEach((e=>{const t=new N({castShadow:!1});s(t,e);const i=e.stateMask||0,r=o.get(i)||[];r.push(t),o.set(i,r)}));const r=[];o.forEach(((e,t)=>r.push({stateMask:t,objects:e}))),this._engineResources={objectsByState:r,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){if(this._engineResourcesAddedToStage||o(this._engineResources))return;const{objectsByState:e,layer:t,materials:i}=this._engineResources;i.forEach((e=>{const t=n(this._materialIdReferences),i=t.get(e.id)||0;0===i&&this.view._stage.add(e),t.set(e.id,i+1)})),e.forEach((({objects:e})=>{t.addMany(e),this.view._stage.addMany(e)})),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(e=!1){if(!this._engineResourcesAddedToStage||o(this._engineResources))return;const{objectsByState:t,layer:i,materials:s}=this._engineResources;t.forEach((({objects:e})=>{i.removeMany(e),this.view._stage.removeMany(e)})),s.forEach((e=>{const t=n(this._materialIdReferences),i=t.get(e.id);1===i?(this.view._stage.remove(e),t.delete(e.id)):t.set(e.id,i-1)})),e&&this.view._stage.remove(i),this._engineResourcesAddedToStage=!1}_getCollisionRadius(e){return this._getFocusedSize(this.radius,!0)*(\"touch\"===e?this.touchMultiplier:1)}_getFocusedSize(e,t){return e*(t?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(e){const t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,re);return O(e,i[12],i[13],i[14])}_calculateModelTransformOffset(e){const t=this._calculateModelTransformPosition(e);return T(e,t,this.renderLocation)}_calculateObjectTransform(e,t){return m(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&f(t,t,this._worldFrame),f(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,s(this._applyObjectTransform)&&this._applyObjectTransform(t),t}get test(){let e=!1;if(s(this._engineResources))for(const t in this._engineResources.objectsByState){const i=this._engineResources.objectsByState[t];for(const t of i.objects)if(t.isVisible){e=!0;break}if(e)break}return{areAnyResourcesVisible:e}}}function $(e){return 0!==e[12]||0!==e[13]||0!==e[14]}function ee(e,t,s){switch(e.viewingMode){case\"local\":return p(s),!0;case\"global\":{const o=P(e.renderCoordsHelper.spatialReference);return z(t,0,ce,0,o.radius),k(i(ce[1]),i(ce[0]),s),!0}}}const te=a(),ie=B(),se=U(),oe=_(),re=v(),ne=v(),ae=H(),ce=E(),le=E(),he=E(),de=E(),ue=E(),_e=E(),ge=new X({x:0,y:0,z:0,spatialReference:null});export{Y as Manipulator3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{c as r}from\"../../../../chunks/vec4f64.js\";import{bindScreenSizeScalingUniforms as i}from\"../core/shaderLibrary/ScreenSizeScaling.glsl.js\";import{bindSliceUniformsWithOrigin as t}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindMultipassTerrainTexture as o}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindProjectionMatrix as s,bindView as a,bindCameraPosition as n}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as l}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as p}from\"../core/shaderTechnique/ShaderTechnique.js\";import{ShaderTechniqueConfiguration as d,parameter as c}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{blendingDefault as h,OITBlending as m,OITDepthWrite as u,OITPolygonOffset as g}from\"../lib/OrderIndependentTransparency.js\";import{Program as b}from\"../lib/Program.js\";import{S as f}from\"../../../../chunks/ShadedColorMaterial.glsl.js\";import{makePipelineState as v,cullingParams as y,defaultDepthWriteParams as T,defaultColorWriteParams as E}from\"../../../webgl/renderState.js\";class S extends p{initializeProgram(e){const r=S.shader.get(),i=this.configuration,t=r.build({output:i.output,slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,screenSizeEnabled:i.screenSizeEnabled,shadingEnabled:i.shadingEnabled,OITEnabled:0===i.transparencyPassType,multipassTerrainEnabled:i.multipassTerrainEnabled,cullAboveGround:i.cullAboveGround});return new b(e.rctx,t,P)}bindPass(e,r){const{screenSizeEnabled:t,shadingEnabled:a}=this.configuration,{color:n,shadingTint:l,shadingDirection:p}=e;s(this.program,r.camera.projectionMatrix),this.program.setUniform4fv(\"color\",n),r.multipassTerrainEnabled&&(this.program.setUniform2fv(\"cameraNearFar\",r.camera.nearFar),this.program.setUniform2fv(\"inverseViewport\",r.inverseViewport),o(this.program,r)),a&&(this.program.setUniform4fv(\"shadedColor\",this.blendColor(w,l,n)),this.program.setUniform3fv(\"shadingDirection\",p),this.program.setUniformMatrix4fv(\"viewNormal\",r.camera.viewInverseTransposeMatrix)),t&&i(this.program,e,r)}bindDraw(e){a(this.program,e),n(this.program,e.origin,e.camera.viewInverseTransposeMatrix),t(this.program,this.configuration,e),this.program.rebindTextures()}blendColor(e,r,i){const t=1-r[3],o=r[3]+i[3]*t;return 0===o?(e[3]=o,e):(e[0]=(r[0]*r[3]+i[0]*i[3]*t)/o,e[1]=(r[1]*r[3]+i[1]*i[3]*t)/o,e[2]=(r[2]*r[3]+i[2]*i[3]*t)/o,e[3]=i[3],e)}setPipelineState(e){const r=this.configuration,i=3===e,t=2===e;return v({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?h:m(e),culling:y(r.cullFace),depthTest:{func:t?513:r.shadingEnabled?515:513},depthWrite:i?r.writeDepth&&T:u(e),colorWrite:E,polygonOffset:i||t?null:g})}initializePipeline(){return this.setPipelineState(this.configuration.transparencyPassType)}}S.shader=new l(f,(()=>import(\"./ShadedColorMaterial.glsl.js\")));class j extends d{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([c({count:8})],j.prototype,\"output\",void 0),e([c({count:3})],j.prototype,\"cullFace\",void 0),e([c()],j.prototype,\"slicePlaneEnabled\",void 0),e([c()],j.prototype,\"transparent\",void 0),e([c()],j.prototype,\"writeDepth\",void 0),e([c()],j.prototype,\"screenSizeEnabled\",void 0),e([c()],j.prototype,\"shadingEnabled\",void 0),e([c({count:4})],j.prototype,\"transparencyPassType\",void 0),e([c()],j.prototype,\"multipassTerrainEnabled\",void 0),e([c()],j.prototype,\"cullAboveGround\",void 0);const P=new Map([[\"position\",0],[\"normal\",1],[\"offset\",2]]),w=r();export{S as ShadedColorMaterialTechnique,j as ShadedColorMaterialTechniqueConfiguration,P as ShadedColorMaterialVertexAttrLocations};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{n as e,s as t,a as r,b as i}from\"../../../../chunks/vec3.js\";import{c as s}from\"../../../../chunks/vec3f64.js\";import{center as a,scale as n}from\"../../../../geometry/support/aaBoundingBox.js\";import{BufferViewVec3f as o}from\"../../../../geometry/support/buffer/BufferView.js\";import{newLayout as u}from\"../../support/buffer/InterleavedLayout.js\";import c from\"../lib/GLMaterial.js\";import{Material as h,materialParametersDefaults as f}from\"../lib/Material.js\";import{assert as l}from\"../lib/Util.js\";import{writeDefaultAttributes as p,writePosition as m}from\"./internal/bufferWriterUtils.js\";import{intersectTriangleGeometry as d}from\"./internal/MaterialUtil.js\";import{ShadedColorMaterialTechniqueConfiguration as b,ShadedColorMaterialVertexAttrLocations as g,ShadedColorMaterialTechnique as q}from\"../shaders/ShadedColorMaterialTechnique.js\";class v extends h{constructor(e){super(e,C),this.supportsEdges=!0,this.techniqueConfig=new b,this._vertexAttributeLocations=g}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.screenSizeEnabled=this.params.screenSizeEnabled,this.techniqueConfig.shadingEnabled=this.params.shadingEnabled,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}getPassParameters(){return this.params}intersect(e,s,o,u,c,h,f){if(this.params.screenSizeEnabled){const o=e.vertexAttributes.get(\"offset\"),l={applyToVertex:(e,s,a,n)=>{const c=t(P,o.data[3*n+0],o.data[3*n+1],o.data[3*n+2]),h=t(x,e,s,a);return r(c,c,this.params.screenSize*u.camera.computeRenderPixelSizeAt(c)),i(h,h,c),[h[0],h[1],h[2]]},applyToAabb:e=>{const t=a(e,P);return n(e,this.params.screenSize*u.camera.computeRenderPixelSizeAt(t))}};d(e,s,u,c,h,l,f)}else d(e,s,u,c,h,void 0,f)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new E(e):void 0}createBufferWriter(){return new S(this.params.screenSizeEnabled)}}class E extends c{constructor(e){super(e),this.updateParameters()}updateParameters(e){this._technique=this._techniqueRep.releaseAndAcquire(q,this._material.getTechniqueConfig(this._output,e),this._technique)}beginSlot(e){if(4===this._output)return 3===e;let t=3;return this._technique.configuration.transparent&&(t=this._technique.configuration.writeDepth?5:8),e===t}ensureParameters(e){this.updateParameters(e)}bind(e){this._technique.bindPass(this._material.getPassParameters(),e)}}const C={color:[1,1,1,1],shadingTint:[0,0,0,.25],shadingDirection:e(s(),[.5,-.5,-.5]),transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,screenSizeEnabled:!1,screenSize:14,shadingEnabled:!0,...f};class S{constructor(e){this.screenSizeEnabled=e;const t=u().vec3f(\"position\").vec3f(\"normal\");this.screenSizeEnabled&&t.vec3f(\"offset\"),this.vertexBufferLayout=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(\"position\").length}write(e,t,r,i){if(p(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,r,i),this.screenSizeEnabled){if(!t.vertexAttributes.has(\"offset\"))throw new Error(\"offset vertex attribute required for screenSizeEnabled ShadedColorMaterial\");{const s=t.vertexAttributes.get(\"offset\"),a=t.indices.get(\"offset\");l(3===s.size);const n=r.getField(\"offset\",o);if(!n)throw new Error(\"unable to acquire view for offset\");m(a,s.data,e.invTranspTransformation,n,i)}}}}const P=s(),x=s();export{v as ShadedColorMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../core/maybe.js\";import{a as r}from\"../../../chunks/mat4.js\";import{f as n,c as o,m as c,n as a}from\"../../../chunks/vec3.js\";import{f as i}from\"../../../chunks/vec4f64.js\";import{sv3d as s,sm4d as l}from\"../../../geometry/support/vectorStacks.js\";import{hydrateGeometry as m}from\"../../../layers/graphics/hydratedFeatures.js\";import{Manipulator3D as u}from\"./Manipulator3D.js\";import{computeCentroid as p}from\"../layers/graphics/graphicUtils.js\";import g from\"../webgl-engine/lib/GeometryUtil.js\";import{ColorMaterial as f}from\"../webgl-engine/materials/ColorMaterial.js\";import{ShadedColorMaterial as h}from\"../webgl-engine/materials/ShadedColorMaterial.js\";function d(e,t=4,r=!0){const n=i(e[0],e[1],e[2],e.length>3?e[3]:1),o=e[3]<1;return r?new h({color:n,transparent:o,writeDepth:!0,cullFace:2,renderOccluded:t}):new f({color:n,transparent:o,writeDepth:!0,cullFace:2,renderOccluded:t})}function j(e,t=4){const r=i(e[0],e[1],e[2],4===e.length?e[3]:1);return new f({color:r,transparent:!0,writeDepth:!0,cullFace:1,renderOccluded:t})}function w(e,t,r){return new u({view:e,renderObjects:[{geometry:g.createSphereGeometry(1,32,32),material:d(i(t[0],t[1],t[2],null!=r?r:1))}]})}function y(e,t,a,i){const m=n(s.get(),e,a),u=b(m,o(s.get(),i,m),a,l.get());r(u,u);const p=c(s.get(),t,u);return Math.atan2(p[1],p[0])}function b(e,t,r,n){const c=a(s.get(),e),i=a(s.get(),t),l=o(s.get(),c,i);return n[0]=c[0],n[1]=c[1],n[2]=c[2],n[3]=0,n[4]=i[0],n[5]=i[1],n[6]=i[2],n[7]=0,n[8]=l[0],n[9]=l[1],n[10]=l[2],n[11]=0,n[12]=r[0],n[13]=r[1],n[14]=r[2],n[15]=1,n}function O(t,r){const n=t.getViewForGraphic(r);return e(n)&&\"computeAttachmentOrigin\"in n?n.computeAttachmentOrigin(r,t.spatialReference):null}function v(t,r,n){const o=O(t,n);e(o)?r.elevationAlignedLocation=o:F(r,n.geometry)}function F(e,r){if(t(r))return;const n=\"mesh\"===r.type?r.anchor:p(r);t(n)||(e.location=m(n))}export{y as calculateInputRotationTransform,b as calculateTranslateRotateFromBases,d as createManipulatorMaterial,j as createManipulatorOutlineMaterial,w as createSphereManipulator,O as getGraphicAttachmentOrigin,v as placeAtGraphic};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport o from\"../../../../../core/has.js\";import{deg2rad as t}from\"../../../../../core/mathUtils.js\";const r=o(\"mac\")?\"Meta\":\"Control\",s=\"Shift\",a=2,c=1.15,m=1.15,h=1.1,e=2500,i=.02,f=Math.cos(t(45)),p=Math.cos(t(5)),M=.95,j=.3,l=.7,n=[1,.5,0],x=2,C=1,S=[...n,l],U=[0,0,0,.04],b=[...n,.5],d=[...n,1],g=[1,1,1,1],k=[1,.8,.6,1],q=[1,.93,.86,1],u=[...n,1],v=[...n,1],w=3,y=11,z=22.5,A=40,B=48,D=2.25,E=4,F=1,G=.3,H=6,I=4,J=12,K=40,L=27,N=1600,O=.4;export{a as DISPLAY_FOCUS_MULTIPLIER,b as GRID_COLOR,n as HANDLE_COLOR,l as HANDLE_OPACITY,i as INITIAL_DEPTH_OFFSET_FRAC,O as INITIAL_PLANE_HALF_SIZE_VIEW_PROPORTION,U as PLANE_BACKGROUND_COLOR,N as PLANE_MIN_BASIS_SCREEN_LEN2,S as PLANE_OUTLINE_COLOR,C as PLANE_OUTLINE_WIDTH,x as PLANE_PREVIEW_OUTLINE_WIDTH,e as POINTER_MOVE_TIMER_MS,M as PREVIEW_FADE_DOT_THRESHOLD,j as PREVIEW_FADE_DURATION_SECONDS,H as RESIZE_HANDLE_CORNER_INPUT_RADIUS,E as RESIZE_HANDLE_CORNER_WIDTH,I as RESIZE_HANDLE_EDGE_INPUT_RADIUS,G as RESIZE_HANDLE_EDGE_PADDING_FRAC,F as RESIZE_HANDLE_EDGE_WIDTH,d as ROTATE_HEADING_CALLOUT_COLOR,L as ROTATE_HEADING_DISC_RADIUS,h as ROTATE_HEADING_DISC_RADIUS_FOCUS_MULTIPLIER,K as ROTATE_HEADING_OFFSET_DISTANCE,J as ROTATE_HEADING_TIP_LENGTH,k as SHIFT_RESTART_ARROW_CAP_COLOR,B as SHIFT_RESTART_ARROW_LENGTH,D as SHIFT_RESTART_ARROW_OUTLINE_WIDTH,g as SHIFT_RESTART_ARROW_TIP_COLOR,u as SHIFT_RESTART_CALLOUT_COLOR,A as SHIFT_RESTART_OFFSET_DISTANCE,v as SHIFT_RESTART_OUTLINE_COLOR,m as SHIFT_RESTART_TIP_FOCUS_MULTIPLIER,z as SHIFT_RESTART_TIP_LENGTH,y as SHIFT_RESTART_TIP_RADIUS,q as SHIFT_RESTART_TUBE_COLOR,c as SHIFT_RESTART_TUBE_FOCUS_MULTIPLIER,w as SHIFT_RESTART_TUBE_RADIUS,p as SMALL_ANGLE_DOT_THRESHOLD,f as VERTICAL_DOT_THRESHOLD,r as forceHorizontalModifier,s as forceVerticalModifier};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{bindProjectionMatrix as r,bindView as e}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as i}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../core/shaderTechnique/ShaderTechnique.js\";import{Default3D as t}from\"../lib/DefaultVertexAttributeLocations.js\";import{Program as a}from\"../lib/Program.js\";import{S as s}from\"../../../../chunks/SlicePlaneMaterial.glsl.js\";import{makePipelineState as l,separateBlendingParams as n,defaultColorWriteParams as m}from\"../../../webgl/renderState.js\";class d extends o{initializeProgram(r){const e=d.shader.get().build();return new a(r.rctx,e,t)}bindPass(e,i){r(this.program,i.camera.projectionMatrix),this.program.setUniform4fv(\"backgroundColor\",e.backgroundColor),this.program.setUniform4fv(\"gridColor\",e.gridColor),this.program.setUniform1f(\"gridWidth\",e.gridWidth)}bindDraw(r){e(this.program,r),this.program.rebindTextures()}initializePipeline(){return l({blending:n(1,1,771,771),depthTest:{func:513},colorWrite:m})}}d.shader=new i(s,(()=>import(\"./SlicePlaneMaterial.glsl.js\")));export{d as SlicePlaneMaterialTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import{autoDispose as r}from\"../lib/AutoDisposable.js\";import e from\"../lib/GLMaterial.js\";import{Material as i,materialParametersDefaults as s}from\"../lib/Material.js\";import{DefaultBufferWriter as o,PositionUVLayout as a}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as n}from\"./internal/MaterialUtil.js\";import{SlicePlaneMaterialTechnique as u}from\"../shaders/SlicePlaneMaterialTechnique.js\";class l extends i{constructor(t){super(t,m)}intersect(t,r,e,i,s,o,a){return n(t,r,i,s,o,void 0,a)}createBufferWriter(){return new o(a)}getGLMaterial(t){return 0===t.output?new c(t):void 0}}class c extends e{constructor(t){super(t),this._technique=new u(this._techniqueRep.constructionContext,null),this.updateParameters()}updateParameters(){}beginSlot(t){return 8===t}bind(t){this._technique.bindPass(this._material.params,t)}}t([r()],c.prototype,\"_technique\",void 0);const m={backgroundColor:[1,0,0,.5],gridColor:[0,1,0,.5],gridWidth:4,...s};export{l as SlicePlaneMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as r}from\"../../../../core/maybe.js\";import{c as e}from\"../../../../chunks/vec4.js\";import{f as t}from\"../../../../chunks/vec4f32.js\";import{Object3DVisualElement as i}from\"./Object3DVisualElement.js\";import a from\"../../webgl-engine/lib/GeometryUtil.js\";import{SlicePlaneMaterial as s}from\"../../webgl-engine/materials/SlicePlaneMaterial.js\";class d extends i{constructor(r){super(r),this._material=null,this._renderOccluded=4,this._gridWidth=1,this._gridColor=t(1,0,0,1),this._backgroundColor=t(1,0,0,1),this.applyProps(r)}get renderOccluded(){return this._renderOccluded}set renderOccluded(r){r!==this._renderOccluded&&(this._renderOccluded=r,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(r){this._gridWidth!==r&&(this._gridWidth=r,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(r){e(this._gridColor,r),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(r){e(this._backgroundColor,r),this._updateMaterial()}createExternalResources(){this._material=new s(this.materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(e){r(this._material)&&e(this._material)}createGeometries(e){if(r(this._material)){const r=a.createSquareGeometry();e.addGeometry(r,this._material)}}get materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded}}_updateMaterial(){r(this._material)&&this._material.setParameterValues(this.materialParameters)}}export{d as SlicePlaneVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import{JSONSupport as o}from\"../../core/JSONSupport.js\";import{clone as e}from\"../../core/lang.js\";import{isSome as i}from\"../../core/maybe.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import{cast as s}from\"../../core/accessorSupport/decorators/cast.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{ensureNumber as h}from\"../../core/accessorSupport/ensureType.js\";import{persistable as a}from\"../../core/accessorSupport/decorators/persistable.js\";import{cyclicalDeg as n}from\"../../views/3d/support/mathUtils.js\";import m from\"../../geometry/Point.js\";var l;let c=l=class extends o{constructor(t){super(t),this.type=\"plane\",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}clone(){return new l({position:e(this.position),heading:this.heading,tilt:this.tilt,width:this.width,height:this.height})}equals(t){return this.heading===t.heading&&this.tilt===t.tilt&&i(this.position)&&i(t.position)&&this.position.equals(t.position)&&this.width===t.width&&this.height===t.height}};t([r({readOnly:!0,json:{read:!1,write:!0}})],c.prototype,\"type\",void 0),t([r({type:m}),a()],c.prototype,\"position\",void 0),t([r({type:Number,nonNullable:!0,range:{min:0,max:360}}),a(),s((t=>n.normalize(h(t),0,!0)))],c.prototype,\"heading\",void 0),t([r({type:Number,nonNullable:!0,range:{min:0,max:360}}),a(),s((t=>n.normalize(h(t),0,!0)))],c.prototype,\"tilt\",void 0),t([r({type:Number,nonNullable:!0}),a()],c.prototype,\"width\",void 0),t([r({type:Number,nonNullable:!0}),a()],c.prototype,\"height\",void 0),c=l=t([p(\"esri.widgets.Slice.SlicePlane\")],c);var d=c;export default d;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport\"../../../../../geometry.js\";import{neverReached as e}from\"../../../../../core/compilerUtils.js\";import t from\"../../../../../core/Logger.js\";import{rad2deg as s,deg2rad as i}from\"../../../../../core/mathUtils.js\";import{isSome as r,isNone as o}from\"../../../../../core/maybe.js\";import{castRenderScreenPointArray3 as n}from\"../../../../../core/screenUtils.js\";import{r as a,i as c,s as l,m,b as g,t as d,w as u}from\"../../../../../chunks/mat4.js\";import{c as p}from\"../../../../../chunks/mat4f64.js\";import{r as f}from\"../../../../../chunks/quat.js\";import{a as b,g as h,d as w,c as y,n as j,b as M,l as k,f as P,p as v,s as O}from\"../../../../../chunks/vec3.js\";import{a as T,c as U,f as R}from\"../../../../../chunks/vec3f64.js\";import{r as S,f as L,a as A,n as E,u as F,i as G}from\"../../../../../chunks/boundedPlane.js\";import{fromVectorsAndPoint as C,fromPositionAndNormal as I}from\"../../../../../geometry/support/plane.js\";import{create as x}from\"../../../../../geometry/support/ray.js\";import{angleAroundAxis as z}from\"../../../../../geometry/support/vector.js\";import{sv3d as D,sm4d as B,sq4d as V}from\"../../../../../geometry/support/vectorStacks.js\";import{Manipulator3D as q}from\"../../Manipulator3D.js\";import{calculateTranslateRotateFromBases as H}from\"../../manipulatorUtils.js\";import{SMALL_ANGLE_DOT_THRESHOLD as N,RESIZE_HANDLE_EDGE_PADDING_FRAC as W,PLANE_MIN_BASIS_SCREEN_LEN2 as $,INITIAL_PLANE_HALF_SIZE_VIEW_PROPORTION as J,SHIFT_RESTART_OFFSET_DISTANCE as K,SHIFT_RESTART_ARROW_TIP_COLOR as Q,SHIFT_RESTART_ARROW_CAP_COLOR as X,SHIFT_RESTART_TUBE_COLOR as Y,SHIFT_RESTART_OUTLINE_COLOR as Z,SHIFT_RESTART_CALLOUT_COLOR as _,SHIFT_RESTART_TIP_RADIUS as ee,ROTATE_HEADING_CALLOUT_COLOR as te,PLANE_OUTLINE_COLOR as se,PLANE_OUTLINE_WIDTH as ie,PLANE_BACKGROUND_COLOR as re,GRID_COLOR as oe,RESIZE_HANDLE_CORNER_INPUT_RADIUS as ne,RESIZE_HANDLE_EDGE_INPUT_RADIUS as ae,ROTATE_HEADING_TIP_LENGTH as ce,VERTICAL_DOT_THRESHOLD as le,SHIFT_RESTART_TUBE_RADIUS as me,SHIFT_RESTART_TIP_LENGTH as ge,SHIFT_RESTART_TUBE_FOCUS_MULTIPLIER as de,SHIFT_RESTART_TIP_FOCUS_MULTIPLIER as ue,SHIFT_RESTART_ARROW_OUTLINE_WIDTH as pe,ROTATE_HEADING_OFFSET_DISTANCE as fe,ROTATE_HEADING_DISC_RADIUS as be,ROTATE_HEADING_DISC_RADIUS_FOCUS_MULTIPLIER as he,HANDLE_COLOR as we,DISPLAY_FOCUS_MULTIPLIER as ye,RESIZE_HANDLE_EDGE_WIDTH as je,SHIFT_RESTART_ARROW_LENGTH as Me,RESIZE_HANDLE_CORNER_WIDTH as ke}from\"./sliceToolConfig.js\";import{LineVisualElement as Pe}from\"../../visualElements/LineVisualElement.js\";import{SlicePlaneVisualElement as ve}from\"../../visualElements/SlicePlaneVisualElement.js\";import{fromRender as Oe}from\"../../../support/geometryUtils/ray.js\";import{Geometry as Te}from\"../../../webgl-engine/lib/Geometry.js\";import Ue from\"../../../webgl-engine/lib/GeometryUtil.js\";import{ColorMaterial as Re}from\"../../../webgl-engine/materials/ColorMaterial.js\";import{ImageMaterial as Se}from\"../../../webgl-engine/materials/ImageMaterial.js\";import{NativeLineMaterial as Le}from\"../../../webgl-engine/materials/NativeLineMaterial.js\";import{RibbonLineMaterial as Ae}from\"../../../webgl-engine/materials/RibbonLineMaterial.js\";import Ee from\"../../../../../widgets/Slice/SlicePlane.js\";import Fe from\"../../../../../geometry/Point.js\";const Ge=t.getLogger(\"esri.views.3d.interactive.analysisTools.slice.sliceToolUtils\");function Ce(e,t,s,i,r,o,n,a){return Ie(t,n.worldUpAtPosition(e,D.get()),r,o,a.basis1,a.basis2),b(a.basis1,a.basis1,s),b(a.basis2,a.basis2,i),h(a.origin,e),C(a.basis2,a.basis1,a.origin,a.plane),a}function Ie(e,t,s,i,r,o){const n=w(e,t),a=D.get(),c=D.get();switch(0===i?Math.abs(n)>le?1:2:i){case 2:{const i=Math.abs(n)<=N?e:s.viewUp;y(a,i,t),h(c,t);break}case 1:y(a,s.viewUp,t),y(c,t,a);break;case 3:{const i=Math.abs(n)<=N?t:s.viewUp;y(a,i,e),y(c,e,a);break}}const l=y(D.get(),a,c);w(l,s.viewForward)>0&&b(c,c,-1),j(r,a),j(o,c)}function xe(e,t,s){const i=t.worldUpAtPosition(e.origin,D.get()),r=e.basis1,o=ct(e,i),n=Math.round(o/ft)*ft;return S(e,n-o,r,s)}function ze(e,t,s,i,r,o){const n=h(D.get(),r.origin);M(n,n,b(D.get(),r.basis1,e.direction[0]<0?1:-1)),M(n,n,b(D.get(),r.basis2,e.direction[1]<0?1:-1));const a=k(r.basis1),c=k(r.basis2),l=P(D.get(),s,n),m=P(D.get(),t,n);let g=0,d=0;if(Ze(e)){const t=Ye(r),s=Ye(o);g=a-.5*e.direction[0]*w(r.basis1,m)/a,d=c-.5*e.direction[1]*w(r.basis2,m)/c;const i=s/t;g*=i,d*=i}const u=g+.5*e.direction[0]*w(r.basis1,l)/a,p=d+.5*e.direction[1]*w(r.basis2,l)/c,f=b(D.get(),r.basis1,u/a),y=b(D.get(),r.basis2,p/c);(u<=0||Qe(o.origin,f,i)<=$)&&h(f,o.basis1),(p<=0||Qe(o.origin,y,i)<=$)&&h(y,o.basis2);const j=h(D.get(),n);return M(j,j,b(D.get(),f,e.direction[0]<0?-1:1)),M(j,j,b(D.get(),y,e.direction[1]<0?-1:1)),L(j,f,y,o)}function De(e,t){return J*Math.min(t.width,t.height)*t.computeRenderPixelSizeAt(e)}function Be(e,t,s,i){const r=y(D.get(),t,s);return y(r,r,t),I(e,r,i)}function Ve(e,t){return H(e.basis1,e.basis2,e.origin,t)}function qe(e,t,s,i){const r=t.worldUpAtPosition(e.origin,D.get()),o=D.get();switch(s){case 1:h(o,r);break;case 2:h(o,e.basis1)}return I(e.origin,o,i)}function He(e,t,s,i){const r=Ke(s,2),o=B.get();a(o,t,r.edge*Math.PI/2);const c=j(D.get(),r.basis);let l=b(D.get(),c,r.direction*i.computeScreenPixelSizeAt(r.position)*K);M(l,l,r.position);const m=i.projectToRenderScreen(l,n(D.get())),g=Ne(i,m);Oe(i,m,pt),j(pt.direction,pt.direction);const d=D.get();!g&&G(s,pt,d)&&(l=d),o[12]=0,o[13]=0,o[14]=0,e.modelTransform=o,e.renderLocation=T(l),g?e.state|=ut:e.state&=~ut}function Ne(e,t){const[s,i,r,o]=e.viewport,n=Math.min(r,o)/16;let a=!0;return t[0]<s+n?(t[0]=s+n,a=!1):t[0]>s+r-n&&(t[0]=s+r-n,a=!1),t[1]<i+n?(t[1]=i+n,a=!1):t[1]>i+o-n&&(t[1]=i+o-n,a=!1),a}function We(e,t,s,i){const r=k(i.basis1),o=k(i.basis2),n=Xe(i),g=Ye(i),d=O(D.get(),0,0,0);M(d,b(D.get(),i.basis1,t.direction[0]),b(D.get(),i.basis2,t.direction[1])),M(d,i.origin,d);let u=0,p=1;if(Ze(t))1===t.direction[0]&&-1===t.direction[1]?u=ft:1===t.direction[0]&&1===t.direction[1]?u=Math.PI:-1===t.direction[0]&&1===t.direction[1]&&(u=3*Math.PI/2),p=g;else{const e=0!==t.direction[0]?1:2;u=1===e?ft:0,p=(1===e?o:r)-n}const f=c(B.get());a(f,f,u),l(f,f,O(D.get(),p,p,p)),m(f,s,f),f[12]=0,f[13]=0,f[14]=0,e.modelTransform=f,e.renderLocation=d}function $e(e,t,s,i){const r=i.worldUpAtPosition(s.origin,D.get()),o=Ke(s,0),n=c(B.get());a(n,n,o.edge*Math.PI/2),g(n,n,-ct(s,r)),m(n,t,n),n[12]=0,n[13]=0,n[14]=0,e.modelTransform=n,e.renderLocation=o.position}function Je(e,t,s){const i=Ke(s,1),r=c(B.get());a(r,r,i.edge*Math.PI/2),g(r,r,ft),m(r,t,r),r[12]=0,r[13]=0,r[14]=0,e.modelTransform=r,e.renderLocation=i.position}function Ke(e,t){switch(t){case 0:return{basis:e.basis1,direction:1,position:M(D.get(),e.origin,e.basis1),edge:t};case 1:return{basis:e.basis2,direction:1,position:M(D.get(),e.origin,e.basis2),edge:t};case 2:return{basis:e.basis1,direction:-1,position:P(D.get(),e.origin,e.basis1),edge:t};case 3:return{basis:e.basis2,direction:-1,position:P(D.get(),e.origin,e.basis2),edge:t}}}function Qe(e,t,s){const i=s.projectToRenderScreen(M(D.get(),e,t),n(D.get())),r=s.projectToRenderScreen(P(D.get(),e,t),n(D.get()));return v(P(i,i,r))}function Xe(e){const t=k(e.basis1),s=k(e.basis2);return W*Math.min(t,s)}function Ye(e){return Xe(e)}function Ze(e){return 0!==e.direction[0]&&0!==e.direction[1]}function _e(e,t=1){const s=0===t?K:0,i=[R(s,0,-Me/2),R(s,0,Me/2)],r=nt(i,!0),o=(e,t)=>rt(i,i,{tubeRadius:me,tipRadius:ee,tipLength:ge,tubeFocusMultiplier:de,tipFocusMultiplier:ue,padding:e,bothEnds:!0,flat:null,focusTipLength:!0,addCap:t}),n=o(0,!1),a=o(pe,!0),c=new Re({color:Q,cullFace:2,renderOccluded:16}),l=new Re({color:X,cullFace:2,renderOccluded:16}),m=new Re({color:Y,cullFace:2,renderOccluded:16}),g=new Re({color:Z,transparent:!0,writeDepth:!1,cullFace:1,renderOccluded:2}),d=Ue.createPolylineGeometry([[s,0,0],[s-K,0,0]]),u=Ue.createPolylineGeometry([[s,0,0],[s-K,0,0]]),p=new Le({color:_,renderOccluded:4});return new q({view:e,renderObjects:[...n.normal.map((({part:e,geometry:t,transform:s})=>({geometry:t,material:\"tip\"===e?c:\"cap\"===e?l:m,transform:s,stateMask:1|dt}))),...a.normal.map((({geometry:e,transform:t})=>({geometry:e,material:g,transform:t,stateMask:1|dt}))),{geometry:d,material:p,stateMask:1|dt|ut},...n.focused.map((({part:e,geometry:t,transform:s})=>({geometry:t,material:\"tip\"===e?c:\"cap\"===e?l:m,transform:s,stateMask:2|dt}))),...a.focused.map((({geometry:e,transform:t})=>({geometry:e,material:g,transform:t,stateMask:2|dt}))),{geometry:u,material:p,stateMask:2|dt|ut}],autoScaleRenderObjects:!1,collisionType:{type:\"line\",paths:[r]},collisionPriority:1,radius:ee,state:dt})}function et(e,t){const s=new Se({transparent:!0,writeDepth:!1,textureId:t.id,renderOccluded:16}),i=fe,r=be,o=r*he,n=e=>{const t=new Uint32Array([0,1,2,2,3,0]);return new Te([[\"position\",{size:3,data:[i-e,-e,0,i+e,-e,0,i+e,e,0,i-e,e,0],exclusive:!0}],[\"uv0\",{size:2,data:[0,0,1,0,1,1,0,1]}]],[[\"position\",t],[\"uv0\",t]])},a=Ue.createPolylineGeometry([[0,0,0],[i-r,0,0]]),c=Ue.createPolylineGeometry([[0,0,0],[i-o,0,0]]),l=new Le({color:te,renderOccluded:4}),m=[{geometry:n(r),material:s,stateMask:1|dt},{geometry:a,material:l,stateMask:1|dt},{geometry:n(o),material:s,stateMask:2|dt},{geometry:c,material:l,stateMask:2|dt}];return new q({view:e,renderObjects:m,autoScaleRenderObjects:!1,collisionType:{type:\"disc\",direction:[0,0,1],offset:[i,0,0]},collisionPriority:1,radius:r/2,state:dt})}function tt(e){return new Pe({view:e,attached:!0,color:se,width:ie,writeDepthEnabled:!1,renderOccluded:4,geometry:[[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]]]})}function st(e){return new ve({view:e,attached:!0,backgroundColor:[...re],gridColor:oe,gridWidth:4,renderOccluded:4})}function it(e,t){const s=Ze(t),i=s?[R(1,0,0),R(0,0,0),R(0,1,0)]:[R(1,0,0),R(-1,0,0)],r=Ue.createPolylineGeometry(i),o=[...we,1],n=e=>new Ae({color:o,width:e,renderOccluded:4}),a=()=>new Le({color:o,renderOccluded:4}),c=s?ke:je,l=c*ye,m=je,g=e=>e>1?n(e):a(),d=[{geometry:r,material:g(c),stateMask:1|bt},{geometry:r,material:g(l),stateMask:2|bt},{geometry:r,material:g(m),stateMask:ht}],u=new q({view:e,renderObjects:d,collisionType:{type:\"line\",paths:[i]},autoScaleRenderObjects:!1,worldSized:!0,radius:s?ne:ae,idHint:s?1:2});return u.state=bt,u}function rt(e,t,s){const i=i=>{const o=(i?t:e).slice(0),n=P(D.get(),o[0],o[1]);j(n,n);const a=P(D.get(),o[o.length-1],o[o.length-2]);if(j(a,a),s.padding>0){const e=b(U(),a,-s.padding);if(o[o.length-1]=M(e,e,o[o.length-1]),s.bothEnds){const e=b(U(),n,-s.padding);o[0]=M(e,e,o[0])}}const g=i?s.tipFocusMultiplier:1,h=s.tipLength*(s.focusTipLength?g:1),w=s.tipRadius*g,y=c(B.get());if(s.padding>0){const e=h/4,t=O(D.get(),0,e,0),i=1+s.padding/e;d(y,y,t),l(y,y,O(D.get(),i,i,i)),d(y,y,b(t,t,-1/i))}const k=c(p()),v=R(0,1,0),T=u(p(),f(V.get(),v,a));T[12]=o[o.length-1][0],T[13]=o[o.length-1][1],T[14]=o[o.length-1][2],m(T,T,y);const S=[{part:\"tube\",geometry:ot(s.tubeRadius*(i?s.tubeFocusMultiplier:1)+s.padding,s.flat,o),transform:k}];let L,A;if(r(s.flat)?L=Ue.createExtrudedTriangle(h,w,w,s.flat.thickness):(L=Ue.createConeGeometry(h,w,24,!1,!1,!0),A=Ue.createConeGeometry(h,w,24,!1,!0,!1)),S.push({part:\"tip\",geometry:L,transform:T}),A&&S.push({part:\"cap\",geometry:A,transform:T}),s.bothEnds){const e=u(p(),f(V.get(),v,n));e[12]=o[0][0],e[13]=o[0][1],e[14]=o[0][2],m(e,e,y),S.push({part:\"tip\",geometry:L,transform:e}),A&&S.push({part:\"cap\",geometry:A,transform:e})}return S};return{normal:i(!1),focused:i(!0)}}function ot(e,t,s){const i=[];if(r(t))i.push([e,t.thickness/2],[-e,t.thickness/2],[-e,-t.thickness/2],[e,-t.thickness/2]);else{const t=12;for(let s=0;s<t;s++){const r=s/t*2*Math.PI;i.push([Math.cos(r)*e,Math.sin(r)*e])}}return Ue.createPathExtrusionGeometry(i,s,[],[],!1)}function nt(e,t){const s=P(U(),e[e.length-1],e[e.length-2]);if(j(s,s),b(s,s,ce),M(s,s,e[e.length-1]),t){const t=P(U(),e[0],e[1]);return j(t,t),b(t,t,ce),M(t,t,e[0]),[t,...e,s]}return[...e,s]}function at(e,t,i,n=new Ee){if(o(e))return null;const a=r(n.position)?n.position:new Fe;t.fromRenderCoords(e.origin,a,i),n.position=a;const c=t.worldUpAtPosition(e.origin,D.get()),l=t.worldBasisAtPosition(e.origin,1,D.get());return n.width=2*k(e.basis1),n.height=2*k(e.basis2),n.tilt=s(ct(e,c)),n.heading=s(lt(e,c,l)),n}function ct(e,t){return z(t,e.basis2,e.basis1)+ft}function lt(e,t,s){return z(e.basis1,s,t)-ft}function mt(e,t,s=A()){return o(e)||o(e.position)?null:t.toRenderCoords(e.position,s.origin)?(t.worldBasisAtPosition(s.origin,0,s.basis1),t.worldBasisAtPosition(s.origin,1,s.basis2),C(s.basis2,s.basis1,s.origin,s.plane),S(s,-i(e.heading),E(s),s),S(s,i(e.tilt),s.basis1,s),b(s.basis1,s.basis1,e.width/2),b(s.basis2,s.basis2,e.height/2),F(s),s):(Ge.error(`Failed to project slice plane position, projection from ${e.position.spatialReference.wkid} is not supported`),null)}function gt(t){switch(t.type){case\"building-scene\":case\"csv\":case\"direct-line-measurement\":case\"area-measurement\":case\"feature\":case\"geo-rss\":case\"geojson\":case\"graphics\":case\"group\":case\"integrated-mesh\":case\"kml\":case\"line-of-sight\":case\"map-notes\":case\"ogc-feature\":case\"point-cloud\":case\"route\":case\"slice\":case\"scene\":case\"stream\":case\"voxel\":case\"subtype-group\":case\"unknown\":case\"unsupported\":case\"wfs\":case null:return!1;case\"base-dynamic\":case\"base-elevation\":case\"base-tile\":case\"bing-maps\":case\"elevation\":case\"imagery\":case\"imagery-tile\":case\"map-image\":case\"open-street-map\":case\"tile\":case\"vector-tile\":case\"wcs\":case\"web-tile\":case\"wms\":case\"wmts\":return!0;default:return e(t.type),!1}}const dt=16,ut=32,pt=x(),ft=Math.PI/2,bt=16,ht=32;export{dt as DidPointerMoveRecentlyFlag,ut as IsShiftEdgeOnScreenFlag,nt as addArrowTips,Ve as calculateBoundedPlaneTranslateRotate,Ye as calculateDiagonalResizeHandleScale,De as calculatePlaneHalfSize,Xe as calculateResizeHandlePadding,Qe as calculateScreenSpaceBasisLength2,rt as createArrowGeometry,st as createGridVisualElement,tt as createOutlineVisualElement,Ce as createPlane,it as createResizeManipulator,et as createRotateManipulator,qe as createRotatePlane,_e as createShiftManipulator,Be as createShiftPlane,xe as forceHorizontalOrVertical,gt as isAlwaysDrapedLayer,Ze as isDiagonalResizeHandle,Ie as normalToBases,at as planeToShape,bt as resizeNormal,ht as resizeOutlineOnly,ze as resizePlane,mt as shapeToPlane,We as updateResizeHandle,$e as updateRotateHeadingHandle,Je as updateRotateTiltHandle,He as updateShiftRestartHandle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import i from\"../../../../../core/Accessor.js\";import t from\"../../../../../core/Handles.js\";import a from\"../../../../../core/Logger.js\";import{isNone as r,isSome as l}from\"../../../../../core/maybe.js\";import{whenOnce as s}from\"../../../../../core/watchUtils.js\";import{property as n}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{a as c}from\"../../../../../chunks/boundedPlane.js\";import d from\"../../../../../layers/Layer.js\";import h from\"../../../../../layers/buildingSublayers/BuildingComponentSublayer.js\";import{isAlwaysDrapedLayer as y,shapeToPlane as u,forceHorizontalOrVertical as p,planeToShape as w}from\"../../analysisTools/slice/sliceToolUtils.js\";import v from\"../../../../../widgets/Slice/SlicePlane.js\";const V=a.getLogger(\"esri.views.3d.interactive.graphics.Slice.SliceController\");let f=class extends i{constructor(e){super(e),this._handles=new t,this._internalChange=!1,this._currentSlicePlane=null,this.state=\"pending\"}get ready(){return\"ready\"===this.state}initialize(){this._handles.add(this.layerView.layerViewData.excludedLayers.on(\"before-add\",(e=>{const i=e.item;null!=i&&(i instanceof d||i instanceof h)?i instanceof d&&y(i)?(V.error(\"excludedLayers\",`Layer '${i.title}, id:${i.id}' of type '${i.type}' can not be individually excluded from slicing. Use 'excludeGroundSurface' instead.`),e.preventDefault()):this.layerView.layerViewData.excludedLayers.includes(i)&&e.preventDefault():(V.error(\"excludedLayers\",\"Invalid layer type, layer must derive from Layer or BuildingComponentSublayer\"),e.preventDefault())}))),this._handles.add(s(this.view,\"ready\",(()=>this._initialize()),!0))}_initialize(){switch(this.state){case\"pending\":break;case\"destroyed\":return;case\"ready\":throw new Error(\"state error\")}C(this.view,this),this._handles.add([this.layerView.layerViewData.watch(\"plane\",(()=>{this._internalChange||this._updateSlicePlaneFromBoundedPlane(),this._updateLayerViews()}),!0),this.layerView.layerViewData.watch(\"excludeGroundSurface\",(()=>this._updateLayerViews()),!0),this.layerView.layerViewData.excludedLayers.on(\"change\",(()=>this._updateLayerViews())),this.layerView.watch([\"active\",\"visible\"],(()=>{this._updateActiveController(),this._updateViewSlicePlane()}),!0),this.view.allLayerViews.on(\"change\",(()=>this._updateLayerViews()))]),this._handles.add([this.analysis.watch(\"plane\",(()=>{this._internalChange||(this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane())}),!0)],\"analysis\"),this._set(\"state\",\"ready\"),this._updateActiveController(),this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane()}destroy(){switch(this.state){case\"destroyed\":case\"pending\":return}this.layerView.active=!1,P(this.view,this),this._handles.destroy(),this.view.slicePlane=null,this.set(\"view\",null),this._set(\"state\",\"destroyed\")}async whenReady(){return await s(this,\"ready\"),this}_updateBoundedPlaneFromSlicePlane(){const e=this.analysis.plane,i=this._currentSlicePlane;if(r(i)&&r(e)||l(i)&&l(e)&&e.equals(i))return;let t=null,a=null;l(e)&&(t=u(e,this.view.renderCoordsHelper,c()),l(t)?a={heading:e.heading,tilt:e.tilt,position:e.position,width:e.width,height:e.height}:console.warn(\"Failed slice plane conversion.\")),this._currentSlicePlane=a,l(t)&&!this.analysis.tiltEnabled&&p(t,this.view.renderCoordsHelper,t),this._internalChange=!0,this.layerView.layerViewData.plane=t,this._internalChange=!1}_updateSlicePlaneFromBoundedPlane(){const e=this.layerView.layerViewData.plane,i=w(e,this.view.renderCoordsHelper,this.view.spatialReference,new v);let t=null;l(i)&&(t={heading:i.heading,tilt:i.tilt,position:i.position,width:i.width,height:i.height}),this._currentSlicePlane=t,l(e)&&(this.analysis.tiltEnabled||p(e,this.view.renderCoordsHelper,e)),this._internalChange=!0,this.analysis.plane=i,this._internalChange=!1,this._updateViewSlicePlane()}_updateActiveController(){if(_)return;const e=S(this.view);if(this.layerView.active)l(e.activeController)&&e.activeController!==this?(_=!0,e.activeController.layerView.active=!1,_=!1):l(e.activeController)&&e.activeController,this._updateLayerViews(),e.activeController=this;else{if(l(e.activeController)&&e.activeController!==this)return;l(e.activeController)&&e.activeController===this&&(e.activeController=null,this._updateLayerViews())}}_updateViewSlicePlane(){\"ready\"===this.state&&g(this.view)}_updateLayerViews(){const e=l(this.layerView.layerViewData.plane)&&this.layerView.visible&&this.layerView.active,i=[],t=e=>{\"layers\"in e?e.layers.forEach(t):i.push(e)};this.layerView.layerViewData.excludedLayers.forEach(t),this.view.allLayerViews.forEach((t=>{\"slicePlaneEnabled\"in t&&(t.slicePlaneEnabled=e&&i.indexOf(t.layer)<0),\"sublayerViews\"in t&&t.sublayerViews.forEach((t=>{t.slicePlaneEnabled=e&&i.indexOf(t.sublayer)<0}))})),null!=this.view.basemapTerrain&&(this.view.basemapTerrain.slicePlaneEnabled=e&&!this.layerView.layerViewData.excludeGroundSurface)}};e([n({readOnly:!0})],f.prototype,\"state\",void 0),e([n()],f.prototype,\"view\",void 0),e([n()],f.prototype,\"analysis\",void 0),e([n()],f.prototype,\"layerView\",void 0),e([n()],f.prototype,\"ready\",null),f=e([o(\"esri.views.3d.interactive.graphics.Slice.SliceController\")],f);const m=new Map;let _=!1;function g(e){const i=S(e).activeController;l(i)&&l(i.layerView.layerViewData.plane)&&i.layerView.visible?e.slicePlane=i.layerView.layerViewData.plane:e.slicePlane=null}function C(e,i){m.has(e)||m.set(e,{all:[],activeController:null}),m.get(e).all.push(i)}function S(e){return m.get(e)}function P(e,i){if(!m.has(e))throw new Error(\"view expected in global slice register\");const t=m.get(e),a=t.all.lastIndexOf(i);if(-1===a)throw new Error(\"controller expected in global slice register\");t.all.splice(a,1),0===t.all.length&&m.delete(e)}export{f as SliceController};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import t from\"../../../../../core/Accessor.js\";import i from\"../../../../../core/Handles.js\";import{isNone as s,destroyMaybe as a,isSome as r}from\"../../../../../core/maybe.js\";import{whenOnce as l}from\"../../../../../core/watchUtils.js\";import{property as o}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as n}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{v as h,m as d}from\"../../../../../chunks/mat4.js\";import{s as p,l as u}from\"../../../../../chunks/vec3.js\";import{sm4d as c,sv3d as m}from\"../../../../../geometry/support/vectorStacks.js\";import{PLANE_OUTLINE_WIDTH as y,PLANE_PREVIEW_OUTLINE_WIDTH as w,PLANE_OUTLINE_COLOR as _,PLANE_BACKGROUND_COLOR as V,GRID_COLOR as g}from\"../../analysisTools/slice/sliceToolConfig.js\";import{createGridVisualElement as v,createOutlineVisualElement as E,calculateBoundedPlaneTranslateRotate as b}from\"../../analysisTools/slice/sliceToolUtils.js\";import{createStipplePatternSimple as f}from\"../../../webgl-engine/materials/lineStippleUtils.js\";let j=class extends t{constructor(e){super(e),this._handles=new i,this._gridVisualElement=null,this._outlineVisualElement=null,this.state=\"pending\"}get ready(){return\"ready\"===this.state}set showGrid(e){this._set(\"showGrid\",e),this._updateMaterials()}set editable(e){this._set(\"editable\",e),this._updateMaterials()}initialize(){this._initialize()}async _initialize(){switch(this.state){case\"pending\":break;case\"destroyed\":return;case\"ready\":throw new Error(\"state error\")}if(await l(this.view,\"ready\",!0),s(this.layerView.layerViewData))throw new Error(\"expected internal object to be valid\");this._gridVisualElement=v(this.view),this._outlineVisualElement=E(this.view),this._handles.add([this.analysis.watch(\"opacity\",(()=>this._updateMaterials()),!0)],\"analysis\"),this._handles.add([this.layerView.watch(\"visible\",(()=>this._updateMaterials()),!0),this.layerView.layerViewData.watch(\"plane\",(()=>this._updatePlane()),!0),this.layerView.watch(\"active\",(()=>this._updateMaterials()),!0)],\"internal\"),this._updatePlane(),this._set(\"state\",\"ready\")}destroy(){switch(this.state){case\"destroyed\":case\"pending\":return}this._handles.destroy(),this._gridVisualElement=a(this._gridVisualElement),this._outlineVisualElement=a(this._outlineVisualElement),this.set(\"view\",null),this._set(\"state\",\"destroyed\")}async whenReady(){return await l(this,\"ready\"),this}_update(){switch(this.state){case\"pending\":case\"destroyed\":return}}_updatePlane(){const e=this.layerView.layerViewData.plane,t=r(e)?b(e,c.get()):null;if(this._outlineVisualElement.width=y,r(e)){const i=p(m.get(),u(e.basis1),u(e.basis2),1),s=h(c.get(),i),a=d(s,t,s);this._outlineVisualElement.transform=a,this._gridVisualElement.transform=a}this._updateMaterials()}_updateMaterials(){const e=this.layerView.layerViewData.plane&&this.analysis.visible,t=this.layerView.active,i=[_[0],_[1],_[2],_[3]];this._outlineVisualElement.color=i,this._outlineVisualElement.width=this.editable?y:w,this._outlineVisualElement.stipplePattern=t?null:f(5);const s=[V[0],V[1],V[2],V[3]],a=!!r(this.layerView.layerViewData)&&this.showGrid?g:[0,0,0,0];this._gridVisualElement.backgroundColor=s,this._gridVisualElement.gridColor=a,this._gridVisualElement.visible=e,this._outlineVisualElement.visible=e}};e([o({readOnly:!0})],j.prototype,\"state\",void 0),e([o()],j.prototype,\"view\",void 0),e([o()],j.prototype,\"analysis\",void 0),e([o()],j.prototype,\"layerView\",void 0),e([o()],j.prototype,\"ready\",null),e([o({value:!1})],j.prototype,\"showGrid\",null),e([o({value:!0})],j.prototype,\"editable\",null),j=e([n(\"esri.views.3d.interactive.graphics.Slice.SliceView\")],j);export{j as SliceView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import r from\"../../../../../core/Accessor.js\";import o from\"../../../../../core/Collection.js\";import{referenceSetter as s,castForReferenceSetter as t}from\"../../../../../core/collectionUtils.js\";import{property as c}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/Logger.js\";import{subclass as p}from\"../../../../../core/accessorSupport/decorators/subclass.js\";let i=class extends r{constructor(){super(...arguments),this.plane=null,this.excludeGroundSurface=!1}get excludedLayers(){return this._get(\"excludedLayers\")||new o}set excludedLayers(e){this._set(\"excludedLayers\",s(e,this._get(\"excludedLayers\")))}};e([c()],i.prototype,\"plane\",void 0),e([c()],i.prototype,\"excludeGroundSurface\",void 0),e([c({cast:t})],i.prototype,\"excludedLayers\",null),i=e([p(\"esri.views.3d.interactive.graphics.Slice.SliceInternal\")],i);export{i as SliceLayerViewData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as i}from\"../../../chunks/tslib.es6.js\";import{createDeferred as e}from\"../../../core/promiseUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as t}from\"../../../core/accessorSupport/decorators/subclass.js\";import{SliceController as r}from\"../interactive/graphics/Slice/SliceController.js\";import{SliceView as a}from\"../interactive/graphics/Slice/SliceView.js\";import{LayerView3D as o}from\"./LayerView3D.js\";import{SliceLayerViewData as l}from\"./analysis/Slice/SliceLayerViewData.js\";import n from\"../../layers/LayerView.js\";let y=class extends(o(n)){constructor(){super(...arguments),this.type=\"slice-3d\",this.analysisView=null,this.analysisController=null,this._initialized=e(),this.layerViewData=new l,this.active=!0,this.showGrid=!1,this.editable=!1}initialize(){this.analysisView=new a({view:this.view,analysis:this.layer,layerView:this}),this.analysisController=new r({view:this.view,analysis:this.layer,layerView:this}),this._initialized.resolve()}destroy(){this.analysisView.destroy(),this.analysisView=null,this.analysisController.destroy(),this.analysisController=null}async when(){return this.destroyed?null:(await this._initialized.promise,this.destroyed?null:(await this.analysisView.whenReady(),this.destroyed?null:(await this.analysisController.whenReady(),this)))}get testData(){return{view:this.analysisView,controller:this.analysisController}}};i([s()],y.prototype,\"type\",void 0),i([s()],y.prototype,\"layerViewData\",void 0),i([s()],y.prototype,\"layer\",void 0),i([s()],y.prototype,\"active\",void 0),i([s({aliasOf:\"analysisView.showGrid\"})],y.prototype,\"showGrid\",void 0),i([s({aliasOf:\"analysisView.editable\"})],y.prototype,\"editable\",void 0),y=i([t(\"esri.views.3d.layers.SliceLayerView3D\")],y);var p=y;export default p;export{y as SliceLayerView3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import o from\"../../core/Error.js\";import{isSome as r}from\"../../core/maybe.js\";async function n(n,t,s,a,i,d){let l=null;if(r(s)){const o=`${n}/nodepages/`,t=o+Math.floor(s.rootIndex/s.nodesPerPage);try{return{type:\"page\",rootPage:(await e(t,{query:{f:\"json\",token:a},responseType:\"json\",signal:d})).data,rootIndex:s.rootIndex,pageSize:s.nodesPerPage,lodMetric:s.lodSelectionMetricType,urlPrefix:o}}catch(f){r(i)&&i.warn(\"#fetchIndexInfo()\",\"Failed to load root node page. Falling back to node documents.\",t,f),l=f}}if(!t)return null;const p=`${n}/nodes/`,c=p+(t&&t.split(\"/\").pop());try{return{type:\"node\",rootNode:(await e(c,{query:{f:\"json\",token:a},responseType:\"json\",signal:d})).data,urlPrefix:p}}catch(f){throw new o(\"sceneservice:root-node-missing\",\"Root node missing.\",{pageError:l,nodeError:f,url:c})}}export{n as fetchIndexInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{Slice as e}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ReadLinearDepth as a}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{multipassTerrainTest as o}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{defaultMaskAlphaCutoff as i}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{ColorConversion as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{glsl as t}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as l}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function s(s){const n=new l;return n.include(r,{linearDepth:!1}),n.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),n.attributes.add(\"position\",\"vec3\"),n.attributes.add(\"uv0\",\"vec2\"),n.varyings.add(\"vpos\",\"vec3\"),s.multipassTerrainEnabled&&n.varyings.add(\"depth\",\"float\"),n.vertex.uniforms.add(\"textureCoordinateScaleFactor\",\"vec2\"),n.vertex.code.add(t`\n    void main(void) {\n      vpos = position;\n      ${s.multipassTerrainEnabled?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  `),n.include(e,s),s.multipassTerrainEnabled&&(n.fragment.include(a),n.include(o,s)),n.fragment.uniforms.add(\"tex\",\"sampler2D\"),n.fragment.uniforms.add(\"opacity\",\"float\"),n.varyings.add(\"vTexCoord\",\"vec2\"),7===s.output?n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    `):(n.fragment.include(d),n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ${s.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n    }\n    `)),n}var n=Object.freeze({__proto__:null,build:s});export{n as I,s as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{getPathExtension as i}from\"../../core/urlUtils.js\";function p(i){return o[n(i)]||e}function n(i){return i instanceof Blob?i.type:t(i.url)}function t(p){const n=i(p);return g[n]||a}const o={},a=\"text/plain\",e=o[a],g={png:\"image/png\",jpeg:\"image/jpeg\",jpg:\"image/jpg\",bmp:\"image/bmp\",gif:\"image/gif\",json:\"application/json\",txt:\"text/plain\",xml:\"application/xml\",svg:\"image/svg+xml\",zip:\"application/zip\",pbf:\"application/vnd.mapbox-vector-tile\",gz:\"application/gzip\"};for(const l in g)o[g[l]]=l;export{p as getResourceContentExtension};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as t,isNone as r,get as e}from\"../../maybe.js\";import{isMultiOriginJSONMixin as o}from\"../../multiOriginJSONSupportUtils.js\";import{isAbsolute as i,isBlobProtocol as n,join as s,getPathExtension as u}from\"../../urlUtils.js\";import{generateUUID as p}from\"../../uuid.js\";import{getOwnPropertyMetadata as a}from\"../metadata.js\";import{nameToId as c}from\"../PropertyOrigin.js\";import{propertyJSONMeta as l}from\"./property.js\";import{getResourceContentExtension as f}from\"../../../portal/support/resourceExtension.js\";import{r as m,t as y,i as h,p as d}from\"../../../chunks/persistableUrlUtils.js\";function g(r){const e=t(r)&&r.origins?r.origins:[void 0];return(t,o)=>{const i=w(r,t,o);for(const r of e){const e=l(t,r,o);for(const t in i)e[t]=i[t]}}}function w(r,e,o){if(t(r)&&\"resource\"===r.type)return v(r,e,o);switch(t(r)&&r.type?r.type:\"other\"){case\"other\":return{read:!0,write:!0};case\"url\":{const{read:t,write:r}=d;return{read:t,write:r}}}}function v(e,s,u){const p=a(s,u);return{type:String,read:(t,r,e)=>{const o=m(t,r,e);return p.type===String?o:\"function\"==typeof p.type?new p.type({url:o}):void 0},write:{writer(s,a,l,f){if(!f||!f.resources)return\"string\"==typeof s?void(a[l]=y(s,f)):void(a[l]=s.write({},f));const m=P(s),d=m?y(m,{...f,verifyItemRelativeUrls:f&&f.verifyItemRelativeUrls?{writtenUrls:f.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null},1):null,g=p.type!==String&&(!o(this)||f&&f.origin&&this.originIdOf(u)>c(f.origin));f&&f.portalItem&&t(d)&&!i(d)?g?j(this,u,s,d,a,l,f,e):I(d,a,l,f):f&&f.portalItem&&(r(d)||t(h(d))||n(d)||g)?U(this,u,s,d,a,l,f,e):a[l]=d}}}}function U(t,r,o,i,u,a,c,l){const m=p(),y=S(o,i,c),h=s(e(l,\"prefix\"),m),d=`${h}.${f(y)}`,g=c.portalItem.resourceFromPath(d);n(i)&&c.resources.pendingOperations.push(b(i).then((t=>{g.path=`${h}.${f(t)}`,u[a]=g.itemRelativeUrl})).catch((()=>{}))),O(t,r,g,y,c.resources.toAdd),u[a]=g.itemRelativeUrl}function j(t,r,e,o,i,n,s,p){const a=s.portalItem.resourceFromPath(o),c=S(e,o,s);f(c)===u(a.path)?(O(t,r,a,c,s.resources.toUpdate),i[n]=o):U(t,r,e,o,i,n,s,p)}function I(t,r,e,o){o.resources.toKeep.push({resource:o.portalItem.resourceFromPath(t)}),r[e]=t}function O(t,r,e,o,i){i.push({resource:e,content:o,finish:e=>{R(t,r,e)}})}function S(t,r,e){return\"string\"==typeof t?{url:r}:new Blob([JSON.stringify(t.toJSON(e))],{type:\"application/json\"})}async function b(t){const r=(await import(\"../../../request.js\")).default,{data:e}=await r(t,{responseType:\"blob\"});return e}function P(t){return r(t)?null:\"string\"==typeof t?t:t.url}function R(t,r,e){\"string\"==typeof t[r]?t[r]=e.url:t[r].url=e.url}export{g as persistable};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{JSONSupport as t}from\"../../core/JSONSupport.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{enumeration as r}from\"../../core/accessorSupport/decorators/enumeration.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";let s=class extends t{constructor(){super(...arguments),this.nodesPerPage=null,this.rootIndex=0,this.lodSelectionMetricType=null}};e([o({type:Number})],s.prototype,\"nodesPerPage\",void 0),e([o({type:Number})],s.prototype,\"rootIndex\",void 0),e([o({type:String})],s.prototype,\"lodSelectionMetricType\",void 0),s=e([p(\"esri.layer.support.I3SNodePageDefinition\")],s);let i=class extends t{constructor(){super(...arguments),this.factor=1}};e([o({type:Number,json:{read:{source:\"textureSetDefinitionId\"}}})],i.prototype,\"id\",void 0),e([o({type:Number})],i.prototype,\"factor\",void 0),i=e([p(\"esri.layer.support.I3SMaterialTexture\")],i);let a=class extends t{constructor(){super(...arguments),this.baseColorFactor=[1,1,1,1],this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.metallicFactor=1,this.roughnessFactor=1}};e([o({type:[Number]})],a.prototype,\"baseColorFactor\",void 0),e([o({type:i})],a.prototype,\"baseColorTexture\",void 0),e([o({type:i})],a.prototype,\"metallicRoughnessTexture\",void 0),e([o({type:Number})],a.prototype,\"metallicFactor\",void 0),e([o({type:Number})],a.prototype,\"roughnessFactor\",void 0),a=e([p(\"esri.layer.support.I3SMaterialPBRMetallicRoughness\")],a);let l=class extends t{constructor(){super(...arguments),this.alphaMode=\"opaque\",this.alphaCutoff=.25,this.doubleSided=!1,this.cullFace=\"none\",this.normalTexture=null,this.occlusionTexture=null,this.emissiveTexture=null,this.emissiveFactor=null,this.pbrMetallicRoughness=null}};e([r({opaque:\"opaque\",mask:\"mask\",blend:\"blend\"})],l.prototype,\"alphaMode\",void 0),e([o({type:Number})],l.prototype,\"alphaCutoff\",void 0),e([o({type:Boolean})],l.prototype,\"doubleSided\",void 0),e([r({none:\"none\",back:\"back\",front:\"front\"})],l.prototype,\"cullFace\",void 0),e([o({type:i})],l.prototype,\"normalTexture\",void 0),e([o({type:i})],l.prototype,\"occlusionTexture\",void 0),e([o({type:i})],l.prototype,\"emissiveTexture\",void 0),e([o({type:[Number]})],l.prototype,\"emissiveFactor\",void 0),e([o({type:a})],l.prototype,\"pbrMetallicRoughness\",void 0),l=e([p(\"esri.layer.support.I3SMaterialDefinition\")],l);let n=class extends t{};e([o({type:String,json:{read:{source:[\"name\",\"index\"],reader:(e,t)=>null!=e?e:`${t.index}`}}})],n.prototype,\"name\",void 0),e([r({jpg:\"jpg\",png:\"png\",dds:\"dds\",\"ktx-etc2\":\"ktx-etc2\",ktx2:\"ktx2\",basis:\"basis\"})],n.prototype,\"format\",void 0),n=e([p(\"esri.layer.support.I3STextureFormat\")],n);let u=class extends t{constructor(){super(...arguments),this.atlas=!1}};e([o({type:[n]})],u.prototype,\"formats\",void 0),e([o({type:Boolean})],u.prototype,\"atlas\",void 0),u=e([p(\"esri.layer.support.I3STextureSetDefinition\")],u);let y=class extends t{};e([r({Float32:\"Float32\",UInt64:\"UInt64\",UInt32:\"UInt32\",UInt16:\"UInt16\",UInt8:\"UInt8\"})],y.prototype,\"type\",void 0),e([o({type:Number})],y.prototype,\"component\",void 0),y=e([p(\"esri.layer.support.I3SGeometryAttribute\")],y);let d=class extends t{};e([r({draco:\"draco\"})],d.prototype,\"encoding\",void 0),e([o({type:[String]})],d.prototype,\"attributes\",void 0),d=e([p(\"esri.layer.support.I3SGeometryCompressedAttributes\")],d);let c=class extends t{constructor(){super(...arguments),this.offset=0}};e([o({type:Number})],c.prototype,\"offset\",void 0),e([o({type:y})],c.prototype,\"position\",void 0),e([o({type:y})],c.prototype,\"normal\",void 0),e([o({type:y})],c.prototype,\"uv0\",void 0),e([o({type:y})],c.prototype,\"color\",void 0),e([o({type:y})],c.prototype,\"uvRegion\",void 0),e([o({type:y})],c.prototype,\"featureId\",void 0),e([o({type:y})],c.prototype,\"faceRange\",void 0),e([o({type:d})],c.prototype,\"compressedAttributes\",void 0),c=e([p(\"esri.layer.support.I3SGeometryBuffer\")],c);let m=class extends t{};e([r({triangle:\"triangle\"})],m.prototype,\"topology\",void 0),e([o()],m.prototype,\"geometryBuffers\",void 0),m=e([p(\"esri.layer.support.I3SGeometryDefinition\")],m);export{y as I3SGeometryAttribute,c as I3SGeometryBuffer,d as I3SGeometryCompressedAttributes,m as I3SGeometryDefinition,l as I3SMaterialDefinition,a as I3SMaterialPBRMetallicRoughness,i as I3SMaterialTexture,s as I3SNodePageDefinition,n as I3STextureFormat,u as I3STextureSetDefinition};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as s}from\"../../../../core/maybe.js\";import{d as r}from\"../../../../chunks/mat4.js\";import{c as t}from\"../../../../chunks/mat4f64.js\";import{VisualElement as o}from\"./VisualElement.js\";import{Object3D as i}from\"../../webgl-engine/lib/Object3D.js\";import{WebGLLayer as a}from\"../../webgl-engine/lib/WebGLLayer.js\";class c extends o{constructor(e){super(e.view),this._resources=null,this._transform=t()}get object(){return e(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(s){r(this._transform,s),e(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(s(this._resources))return;const e=this._resources.object,r=this.view._stage;r.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),r.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new a({isPickable:!1,updatePolicy:1});e.add(s);const r=new i({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((s=>e.add(s))),e.add(r),s.add(r),this.visible||r.setVisible(!1),this._resources={layer:s,object:r}}destroyResources(){const e=this.view._stage;!s(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((s=>{e.remove(s),s.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){s(this._resources)||this._resources.object.setVisible(e)}}export{c as Object3DVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{bindSliceUniformsWithOrigin as t}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindMultipassTerrainTexture as r}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindProjectionMatrix as i,bindView as s}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as a}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../core/shaderTechnique/ShaderTechnique.js\";import{ShaderTechniqueConfiguration as n,parameter as l}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{Default3D as p}from\"../lib/DefaultVertexAttributeLocations.js\";import{OITBlending as c,OITDepthTest as u,OITDepthWrite as d,getOITPolygonOffset as h}from\"../lib/OrderIndependentTransparency.js\";import{Program as m}from\"../lib/Program.js\";import{stencilWriteMaskOn as b,stencilToolMaskBaseParams as f,stencilBaseAllZerosParams as g}from\"../lib/StencilUtils.js\";import{I as y}from\"../../../../chunks/ImageMaterial.glsl.js\";import{makePipelineState as T,cullingParams as P,defaultDepthWriteParams as v,defaultColorWriteParams as j,simpleBlendingParams as S}from\"../../../webgl/renderState.js\";class E extends o{initializeProgram(e){const t=E.shader.get(),r=this.configuration,i=t.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new m(e.rctx,i,p)}bindPass(e,t){i(this.program,t.camera.projectionMatrix),this.program.setUniform1f(\"opacity\",e.opacity),t.multipassTerrainEnabled&&(this.program.setUniform2fv(\"cameraNearFar\",t.camera.nearFar),this.program.setUniform2fv(\"inverseViewport\",t.inverseViewport),r(this.program,t))}bindDraw(e){s(this.program,e),t(this.program,this.configuration,e),this.program.rebindTextures()}setPipelineState(e,t){const r=this.configuration,i=3===e,s=2===e;return T({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?w:c(e),culling:P(r.cullFace),depthTest:{func:u(e)},depthWrite:i?r.writeDepth&&v:d(e),colorWrite:j,stencilWrite:r.sceneHasOcludees?b:null,stencilTest:r.sceneHasOcludees?t?f:g:null,polygonOffset:i||s?null:h(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e){return e?this._occludeePipelineState:this.pipeline}}E.shader=new a(y,(()=>import(\"./ImageMaterial.glsl.js\")));const w=S(1,771);class O extends n{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([l({count:8})],O.prototype,\"output\",void 0),e([l({count:3})],O.prototype,\"cullFace\",void 0),e([l()],O.prototype,\"slicePlaneEnabled\",void 0),e([l()],O.prototype,\"transparent\",void 0),e([l()],O.prototype,\"enableOffset\",void 0),e([l()],O.prototype,\"writeDepth\",void 0),e([l()],O.prototype,\"sceneHasOcludees\",void 0),e([l({count:4})],O.prototype,\"transparencyPassType\",void 0),e([l()],O.prototype,\"multipassTerrainEnabled\",void 0),e([l()],O.prototype,\"cullAboveGround\",void 0);export{E as ImageMaterialTechnique,O as ImageMaterialTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../lib/GLMaterialTexture.js\";import{Material as t,materialParametersDefaults as i}from\"../lib/Material.js\";import{OITPolygonOffsetLimit as s}from\"../lib/OrderIndependentTransparency.js\";import{DefaultBufferWriter as a,PositionUVLayout as r}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as n}from\"./internal/MaterialUtil.js\";import{ImageMaterialTechniqueConfiguration as u,ImageMaterialTechnique as h}from\"../shaders/ImageMaterialTechnique.js\";class c extends t{constructor(e){super(e,p),this.supportsEdges=!0,this.techniqueConfig=new u}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<s,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}intersect(e,t,i,s,a,r,u){n(e,t,s,a,r,void 0,u)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new l(e):void 0}createBufferWriter(){return new a(r)}}class l extends e{constructor(e){super({...e,...e.material.params}),this.updateParameters()}updateParameters(e){const t=this._material.params;this.updateTexture(t.textureId),this._technique=this._techniqueRep.releaseAndAcquire(h,this._material.getTechniqueConfig(this._output,e),this._technique)}beginSlot(e){if(4===this._output)return 3===e;return e===(this._technique.configuration.transparent?this._technique.configuration.writeDepth?5:8:3)}_updateOccludeeState(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&(this._material.setParameterValues({sceneHasOcludees:e.hasOccludees}),this.updateParameters(e))}ensureParameters(e){0!==this._output&&7!==this._output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e){this.bindTextures(this._technique.program),this.bindTextureScale(this._technique.program),this._technique.bindPass(this._material.params,e)}getPipelineState(e,t){return this._technique.getPipelineState(t)}}const p={transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,opacity:1,textureId:null,initTextureTransparent:!0,...i};export{c as ImageMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../PopupTemplate.js\";import\"../../renderers/ClassBreaksRenderer.js\";import\"../../renderers/DictionaryRenderer.js\";import\"../../renderers/DotDensityRenderer.js\";import\"../../renderers/HeatmapRenderer.js\";import\"../../renderers/Renderer.js\";import\"../../renderers/SimpleRenderer.js\";import\"../../renderers/UniqueValueRenderer.js\";import\"../../renderers/support/jsonUtils.js\";import{webSceneRendererTypes as t}from\"../../renderers/support/types.js\";import o from\"../../request.js\";import s from\"../../core/Error.js\";import{JSONMap as i}from\"../../core/jsonMap.js\";import a from\"../../core/Loadable.js\";import p from\"../../core/Logger.js\";import{isSome as n,isNone as l}from\"../../core/maybe.js\";import{EsriPromiseMixin as d}from\"../../core/Promise.js\";import{property as y}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{enumeration as u}from\"../../core/accessorSupport/decorators/enumeration.js\";import{reader as c}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as m}from\"../../core/accessorSupport/decorators/subclass.js\";import h from\"../../geometry/Extent.js\";import f from\"../../geometry/SpatialReference.js\";import g from\"../FeatureLayer.js\";import j from\"./BuildingSublayer.js\";import{zeroCapabilities as v}from\"../support/capabilities.js\";import{popupEnabled as b}from\"../support/commonProperties.js\";import{defineFieldProperties as L}from\"../support/fieldProperties.js\";import F from\"../support/FieldsIndex.js\";import{fetchIndexInfo as S}from\"../support/I3SIndexInfo.js\";import{I3SNodePageDefinition as I,I3SMaterialDefinition as O,I3STextureSetDefinition as w,I3SGeometryDefinition as x}from\"../support/I3SLayerDefinitions.js\";import T from\"../../rest/support/Query.js\";import{createPopupTemplate as q}from\"../../support/popupUtils.js\";import P from\"../../symbols/support/ElevationInfo.js\";const D=p.getLogger(\"esri.layers.buildingSublayers.BuildingComponentSublayer\"),Q=L();let R=class extends(a.LoadableMixin(d(j))){constructor(e){super(e),this.type=\"building-component\",this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.fields=null,this.associatedLayer=null,this.outFields=null,this.listMode=\"show\",this.renderer=null,this.definitionExpression=null,this.popupEnabled=!0,this.popupTemplate=null,this.layerType=\"3d-object\"}get parsedUrl(){return this.layer?{path:`${this.layer.parsedUrl.path}/sublayers/${this.id}`,query:this.layer.parsedUrl.query}:null}get fieldsIndex(){return new F(this.fields)}readAssociatedLayer(e,r){const t=this.layer.associatedFeatureServiceItem,o=r.associatedLayerID;return n(t)&&\"number\"==typeof o?new g({portalItem:t,layerId:o}):null}get objectIdField(){if(null!=this.fields)for(const e of this.fields)if(\"oid\"===e.type)return e.name;return null}get displayField(){return n(this.associatedLayer)?this.associatedLayer.displayField:null}get defaultPopupTemplate(){return this.createPopupTemplate()}load(e){const r=n(e)?e.signal:null,t=this._fetchService(r).then((()=>{this.indexInfo=S(this.parsedUrl.path,this.rootNode,this.nodePages,this.apiKey,D,r)}));return this.addResolvingPromise(t),Promise.resolve(this)}createPopupTemplate(e){return q(this,e)}async _fetchService(e){const r=(await o(this.parsedUrl.path,{query:{f:\"json\",token:this.apiKey},responseType:\"json\",signal:e})).data;this.read(r,{origin:\"service\",url:this.parsedUrl})}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,r){var t,o,s,i;const a=null==(t=this.getFeatureType(null==r?void 0:r.feature))||null==(o=t.domains)?void 0:o[e];return a&&\"inherited\"!==a.type?a:null!=(s=null==(i=this.getField(e))?void 0:i.domain)?s:null}getFeatureType(e){return e&&n(this.associatedLayer)?this.associatedLayer.getFeatureType(e):null}get types(){return n(this.associatedLayer)?this.associatedLayer.types:[]}get typeIdField(){return n(this.associatedLayer)?this.associatedLayer.typeIdField:null}get geometryType(){return\"3d-object\"===this.layerType?\"mesh\":\"point\"}get profile(){return\"3d-object\"===this.layerType?\"mesh-pyramids\":\"points\"}get capabilities(){const e=n(this.associatedLayer)&&this.associatedLayer.capabilities?this.associatedLayer.capabilities:v,{query:r,data:{supportsZ:t,supportsM:o,isVersioned:s}}=e;return{query:r,data:{supportsZ:t,supportsM:o,isVersioned:s}}}createQuery(){const e=new T;return\"mesh\"!==this.geometryType&&(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||\"1=1\",e.sqlFormat=\"standard\",e}queryExtent(e,r){return this._getAssociatedLayerForQuery().then((t=>t.queryExtent(e||this.createQuery(),r)))}queryFeatureCount(e,r){return this._getAssociatedLayerForQuery().then((t=>t.queryFeatureCount(e||this.createQuery(),r)))}queryFeatures(e,r){return this._getAssociatedLayerForQuery().then((t=>t.queryFeatures(e||this.createQuery(),r))).then((e=>{if(null!=e&&e.features)for(const r of e.features)r.layer=this.layer,r.sourceLayer=this;return e}))}queryObjectIds(e,r){return this._getAssociatedLayerForQuery().then((t=>t.queryObjectIds(e||this.createQuery(),r)))}getFieldUsageInfo(e){return this.fieldsIndex.has(e)?{supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1}:{supportsLabelingInfo:!1,supportsRenderer:!0,supportsPopupTemplate:!0,supportsLayerQuery:n(this.associatedLayer)}}_getAssociatedLayerForQuery(){const e=this.associatedLayer;return n(e)&&e.loaded?Promise.resolve(e):this._loadAssociatedLayerForQuery()}async _loadAssociatedLayerForQuery(){if(await this.load(),l(this.associatedLayer))throw new s(\"buildingscenelayer:query-not-available\",\"BuildingSceneLayer component layer queries are not available without an associated feature layer\",{layer:this});try{await this.associatedLayer.load()}catch(e){throw new s(\"buildingscenelayer:query-not-available\",\"BuildingSceneLayer associated feature layer could not be loaded\",{layer:this,error:e})}return this.associatedLayer}};e([y({readOnly:!0})],R.prototype,\"parsedUrl\",null),e([y({type:I,readOnly:!0})],R.prototype,\"nodePages\",void 0),e([y({type:[O],readOnly:!0})],R.prototype,\"materialDefinitions\",void 0),e([y({type:[w],readOnly:!0})],R.prototype,\"textureSetDefinitions\",void 0),e([y({type:[x],readOnly:!0})],R.prototype,\"geometryDefinitions\",void 0),e([y({readOnly:!0})],R.prototype,\"serviceUpdateTimeStamp\",void 0),e([y({readOnly:!0})],R.prototype,\"store\",void 0),e([y({type:String,readOnly:!0,json:{read:{source:\"store.rootNode\"}}})],R.prototype,\"rootNode\",void 0),e([y({readOnly:!0})],R.prototype,\"attributeStorageInfo\",void 0),e([y(Q.fields)],R.prototype,\"fields\",void 0),e([y({readOnly:!0})],R.prototype,\"fieldsIndex\",null),e([y({readOnly:!0,type:g})],R.prototype,\"associatedLayer\",void 0),e([c(\"service\",\"associatedLayer\",[\"associatedLayerID\"])],R.prototype,\"readAssociatedLayer\",null),e([y(Q.outFields)],R.prototype,\"outFields\",void 0),e([y({type:String,readOnly:!0})],R.prototype,\"objectIdField\",null),e([y({readOnly:!0,type:String,json:{read:!1}})],R.prototype,\"displayField\",null),e([y({readOnly:!0,type:String,aliasOf:\"layer.apiKey\"})],R.prototype,\"apiKey\",void 0),e([y({readOnly:!0,type:h,aliasOf:\"layer.fullExtent\"})],R.prototype,\"fullExtent\",void 0),e([y({readOnly:!0,type:f,aliasOf:\"layer.spatialReference\"})],R.prototype,\"spatialReference\",void 0),e([y({readOnly:!0,aliasOf:\"layer.version\"})],R.prototype,\"version\",void 0),e([y({readOnly:!0,type:P,aliasOf:\"layer.elevationInfo\"})],R.prototype,\"elevationInfo\",void 0),e([y({readOnly:!0,type:Number,aliasOf:\"layer.minScale\"})],R.prototype,\"minScale\",void 0),e([y({readOnly:!0,type:Number,aliasOf:\"layer.maxScale\"})],R.prototype,\"maxScale\",void 0),e([y({type:[\"hide\",\"show\"],json:{write:!0}})],R.prototype,\"listMode\",void 0),e([y({types:t,json:{origins:{service:{read:{source:\"drawingInfo.renderer\"}}},name:\"layerDefinition.drawingInfo.renderer\",write:!0},value:null})],R.prototype,\"renderer\",void 0),e([y({type:String,json:{origins:{service:{read:!1,write:!1}},name:\"layerDefinition.definitionExpression\",write:{enabled:!0,allowNull:!0}}})],R.prototype,\"definitionExpression\",void 0),e([y(b)],R.prototype,\"popupEnabled\",void 0),e([y({type:r,json:{read:{source:\"popupInfo\"},write:{target:\"popupInfo\"}}})],R.prototype,\"popupTemplate\",void 0),e([y({readOnly:!0,type:String,json:{origins:{service:{read:{source:\"store.normalReferenceFrame\"}}},read:!1}})],R.prototype,\"normalReferenceFrame\",void 0),e([y({readOnly:!0,json:{read:!1}})],R.prototype,\"defaultPopupTemplate\",null),e([y()],R.prototype,\"types\",null),e([y()],R.prototype,\"typeIdField\",null),e([y({json:{write:!1}}),u(new i({\"3DObject\":\"3d-object\",Point:\"point\"}))],R.prototype,\"layerType\",void 0),e([y()],R.prototype,\"geometryType\",null),e([y()],R.prototype,\"profile\",null),e([y({readOnly:!0,json:{read:!1}})],R.prototype,\"capabilities\",null),R=e([m(\"esri.layers.buildingSublayers.BuildingComponentSublayer\")],R);var E=R;export default E;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{IdentifiableMixin as r}from\"../../core/Identifiable.js\";import{MultiOriginJSONSupport as o}from\"../../core/MultiOriginJSONSupport.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import{Integer as i}from\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{reader as s}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{readOnlyService as a}from\"../support/commonProperties.js\";let l=class extends(r(o)){constructor(e){super(e),this.title=\"\",this.id=-1,this.modelName=null,this.isEmpty=null,this.visible=!0,this.opacity=1}readTitle(e,r){return\"string\"==typeof r.alias?r.alias:\"string\"==typeof r.name?r.name:\"\"}readIdOnlyOnce(e){return-1!==this.id?this.id:\"number\"==typeof e?e:void 0}};e([t({type:String,json:{origins:{\"web-scene\":{write:!0},\"portal-item\":{write:!0}}}})],l.prototype,\"title\",void 0),e([s(\"service\",\"title\",[\"alias\",\"name\"])],l.prototype,\"readTitle\",null),e([t()],l.prototype,\"layer\",void 0),e([t({type:i,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],l.prototype,\"id\",void 0),e([s(\"service\",\"id\")],l.prototype,\"readIdOnlyOnce\",null),e([t(a(String))],l.prototype,\"modelName\",void 0),e([t(a(Boolean))],l.prototype,\"isEmpty\",void 0),e([t({type:Boolean,json:{name:\"visibility\",write:!0}})],l.prototype,\"visible\",void 0),e([t({type:Number,json:{write:!0}})],l.prototype,\"opacity\",void 0),l=e([p(\"esri.layers.buildingSublayers.BuildingSublayer\")],l);var n=l;export default n;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nconst s={attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1},data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1},query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsStatistics:!1,tileMaxRecordCount:0}};export{s as zeroCapabilities};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nclass t{constructor(t){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this.view.watch(\"ready\",(t=>{this._resourcesCreated&&(t?this._createResources():this._destroyResources())}))}applyProps(t){let e=!1;for(const s in t)s in this?\"attached\"===s?e=t[s]:this[s]=t[s]:console.error(\"Cannot set unknown property\",s);this.attached=e}destroy(){this.attached=!1}get attached(){return this._attached}set attached(t){t!==this._attached&&this.view._stage&&(this._attached=t,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.attached&&this.updateVisibility(t))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}export{t as VisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../../core/maybe.js\";import{i as r,t as s}from\"../../../../chunks/mat4.js\";import{c as i}from\"../../../../chunks/mat4f64.js\";import{s as o}from\"../../../../chunks/vec3.js\";import{Z as n,c as l}from\"../../../../chunks/vec3f64.js\";import{g as h,c as a}from\"../../../../chunks/vec4.js\";import{f as p,c as d,a as f}from\"../../../../chunks/vec4f32.js\";import{Object3DVisualElement as _}from\"./Object3DVisualElement.js\";import{createGeometry as c}from\"../../layers/graphics/lineUtils.js\";import{RibbonLineMaterial as u}from\"../../webgl-engine/materials/RibbonLineMaterial.js\";class m extends _{constructor(e){super(e),this._renderOccluded=4,this._width=1,this._color=p(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stippleIntegerRepeats=!1,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this.applyProps(e)}setGeometryFromExtent(e){const t=this.view.spatialReference,r=l(),s=l(),i=100,n=[];o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),this.geometry=[n]}setGeometryFromFrustum(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],r=e.origin,s=e.basis1,i=e.basis2,o=.5,n=l(),h=l(),a=l(),p=l();n[0]=r[0]-s[0]*o-i[0]*o,n[1]=r[1]-s[1]*o-i[1]*o,n[2]=r[2]-s[2]*o-i[2]*o,h[0]=r[0]-s[0]*o+i[0]*o,h[1]=r[1]-s[1]*o+i[1]*o,h[2]=r[2]-s[2]*o+i[2]*o,a[0]=r[0]+s[0]*o+i[0]*o,a[1]=r[1]+s[1]*o+i[1]*o,a[2]=r[2]+s[2]*o+i[2]*o,p[0]=r[0]+s[0]*o-i[0]*o,p[1]=r[1]+s[1]*o-i[1]*o,p[2]=r[2]+s[2]*o-i[2]*o,t.push([n[0],n[1],n[2]]),t.push([h[0],h[1],h[2]]),t.push([a[0],a[1],a[2]]),t.push([p[0],p[1],p[2]]),t.push([n[0],n[1],n[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;r(g),s(g,g,t),this.transform=g;const{points:i}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[i]}setGeometryFromSegments(e,t=n){r(g),s(g,g,t),this.transform=g,this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){h(e,this._color)||(a(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(r){e(r)?!t(this._innerColor)&&h(r,this._innerColor)||(this._innerColor=a(d(),r),this._updateMaterial()):e(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(t){const r=e(t)!==e(this._stipplePattern);this._stipplePattern=t,r?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(r){(t(r)||t(this._stippleOffColor)||!h(r,this._stippleOffColor))&&(this._stippleOffColor=e(r)?f(r):null,this._updateMaterial())}get stippleIntegerRepeats(){return this._stippleIntegerRepeats}set stippleIntegerRepeats(e){this._stippleIntegerRepeats!==e&&(this._stippleIntegerRepeats=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}createExternalResources(){this._material=new u(this.materialParameters)}destroyExternalResources(){this._material=null}createGeometries(e){const t=this._createLineGeometries();if(0!==t.length)for(let r=0;r<t.length;++r){const s=c(t[r]);e.addGeometry(s,this._material)}}forEachExternalMaterial(e){e(this._material)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,stippleIntegerRepeats:this._stippleIntegerRepeats,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateMaterial(){this.attached&&this._material.setParameterValues(this.materialParameters)}_createLineGeometries(){const e=this.geometry;if(t(e)||0===e.length)return[];const r=[];return e.forEach((e=>{const t=e.length,s=new Float64Array(3*t);e.forEach(((e,t)=>{s[3*t+0]=e[0],s[3*t+1]=e[1],s[3*t+2]=e[2]}));const i={attributeData:{position:s},removeDuplicateStartEnd:0};r.push(i)})),r}}const g=i();export{m as LineVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../shaderModules/interfaces.js\";function i(i){i.vertex.uniforms.add(\"camPos\",\"vec3\").add(\"perScreenPixelRatio\",\"float\").add(\"screenSize\",\"float\"),i.vertex.code.add(e`float computeRenderPixelSizeAt( vec3 pWorld ){\nvec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\nfloat viewDirectionDistance = abs(dot(viewForward, pWorld - camPos));\nreturn viewDirectionDistance*perScreenPixelRatio;\n}\nvec3 screenSizeScaling(vec3 position, vec3 anchor){\nreturn position * screenSize * computeRenderPixelSizeAt(anchor) + anchor;\n}`)}function r(e,i,r){e.setUniform1f(\"perScreenPixelRatio\",r.camera.perScreenPixelRatio),e.setUniform1f(\"screenSize\",i.screenSize)}export{i as ScreenSizeScaling,r as bindScreenSizeScalingUniforms};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{ScreenSizeScaling as e}from\"../views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js\";import{Slice as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as o}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ReadLinearDepth as i}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{multipassTerrainTest as a}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{symbolAlphaCutoff as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{ColorConversion as l}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{glsl as n}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as s}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function t(t){const c=new s;return c.include(o,{linearDepth:!1}),c.include(e,{}),c.include(r,t),c.fragment.include(l),c.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),c.fragment.uniforms.add(\"color\",\"vec4\"),c.attributes.add(\"position\",\"vec3\"),c.varyings.add(\"vWorldPosition\",\"vec3\"),t.multipassTerrainEnabled&&c.varyings.add(\"depth\",\"float\"),t.screenSizeEnabled&&c.attributes.add(\"offset\",\"vec3\"),t.shadingEnabled&&(c.vertex.uniforms.add(\"viewNormal\",\"mat4\"),c.fragment.uniforms.add(\"shadedColor\",\"vec4\").add(\"shadingDirection\",\"vec3\"),c.attributes.add(\"normal\",\"vec3\"),c.varyings.add(\"vViewNormal\",\"vec3\")),c.vertex.code.add(n`\n    void main(void) {\n      vWorldPosition = ${t.screenSizeEnabled?\"screenSizeScaling(offset, position)\":\"position\"};\n  `),t.shadingEnabled&&c.vertex.code.add(n`vec3 worldNormal = normal;\nvViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),c.vertex.code.add(n`\n    ${t.multipassTerrainEnabled?\"depth = (view * vec4(vWorldPosition, 1.0)).z;\":\"\"}\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  `),t.multipassTerrainEnabled&&(c.fragment.include(i),c.include(a,t)),c.fragment.code.add(n`\n    void main() {\n      discardBySlice(vWorldPosition);\n      ${t.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n    `),t.shadingEnabled?c.fragment.code.add(n`vec3 viewNormalNorm = normalize(vViewNormal);\nfloat shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\nvec4 finalColor = mix(color, shadedColor, shadingFactor);`):c.fragment.code.add(n`vec4 finalColor = color;`),c.fragment.code.add(n`\n      if (finalColor.a < ${n.float(d)}) {\n        discard;\n      }\n      ${7===t.output?n`gl_FragColor = vec4(finalColor.a);`:\"\"}\n\n      ${0===t.output?n`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${t.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}`:\"\"}\n    }\n    `),c}var c=Object.freeze({__proto__:null,build:t});export{c as S,t as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{glsl as d}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as e}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function r(){const r=new e;return r.extensions.add(\"GL_OES_standard_derivatives\"),r.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),r.attributes.add(\"position\",\"vec3\"),r.attributes.add(\"uv0\",\"vec2\"),r.varyings.add(\"vUV\",\"vec2\"),r.vertex.code.add(d`void main(void) {\nvUV = uv0;\ngl_Position = proj * view * vec4(position, 1.0);\n}`),r.fragment.uniforms.add(\"backgroundColor\",\"vec4\").add(\"gridColor\",\"vec4\").add(\"ratio\",\"float\").add(\"gridWidth\",\"float\"),r.fragment.code.add(d`void main() {\nconst float LINE_WIDTH = 1.0;\nvec2 uvScaled = vUV * gridWidth;\nvec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));\nvec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);\ngrid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);\ngrid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);\nfloat gridFade = max(grid.x, grid.y);\nfloat gridAlpha = gridColor.a * gridFade;\ngl_FragColor =\nvec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +\nvec4(gridColor.rgb, 1.0) * gridAlpha;\n}`),r}var a=Object.freeze({__proto__:null,build:r});export{a as S,r as b};\n"],"sourceRoot":""}