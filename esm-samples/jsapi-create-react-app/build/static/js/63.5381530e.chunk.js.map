{"version":3,"sources":["../node_modules/@arcgis/core/views/layers/ImageryLayerView.js","../node_modules/@arcgis/core/views/3d/layers/ImageryLayerView3D.js","../node_modules/@arcgis/core/views/layers/support/popupUtils.js","../node_modules/@arcgis/core/views/3d/layers/support/projectExtentUtils.js","../node_modules/@arcgis/core/chunks/ImageMaterial.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ImageMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/ImageMaterial.js","../node_modules/@arcgis/core/views/3d/layers/support/overlayImageUtils.js","../node_modules/@arcgis/core/views/3d/layers/DynamicLayerView3D.js"],"names":["u","m","constructor","super","arguments","this","view","e","o","layer","s","r","popupEnabled","i","n","t","popupTemplate","getRequiredFields","c","a","timeExtent","geometry","outFields","outSpatialReference","spatialReference","l","resolution","y","type","p","returnTopmostRaster","h","showNoDataRecords","w","layerOptions","d","returnDomainValues","pixelSize","signal","queryVisibleRasters","then","canResume","isEmpty","prototype","redrawDebounced","async","redraw","_redrawImage","initialize","handles","add","basemapTerrain","initializeMaximumDataResolution","on","updatingHandles","addPromise","refreshDebounced","fullExtent","equals","maximumDataResolution","x","pixelSizeX","pixelSizeY","getFetchOptions","imageElement","image","document","createElement","pixelData","HTMLCanvasElement","Promise","reject","getContext","applyRenderer","applyFilter","pixelBlock","width","height","createImageData","data","set","getAsRGBA","putImageData","fieldsIndex","lastEditInfoEnabled","objectIdField","typeIdField","globalIdField","relationships","includes","f","push","has","indexOf","forEach","keyField","defaultPopupTemplateEnabled","defaultPopupTemplate","resolve","clone","state","isLocal","portalItem","destroyed","catch","include","linearDepth","vertex","uniforms","attributes","varyings","multipassTerrainEnabled","code","fragment","output","float","OITEnabled","Object","freeze","__proto__","build","E","initializeProgram","shader","get","configuration","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","transparencyPassType","cullAboveGround","rctx","bindPass","program","camera","projectionMatrix","setUniform1f","opacity","setUniform2fv","nearFar","inverseViewport","bindDraw","rebindTextures","setPipelineState","T","blending","transparent","culling","P","cullFace","depthTest","func","depthWrite","writeDepth","v","colorWrite","j","stencilWrite","sceneHasOcludees","b","stencilTest","g","polygonOffset","enableOffset","initializePipeline","_occludeePipelineState","getPipelineState","pipeline","S","O","count","supportsEdges","techniqueConfig","getTechniqueConfig","params","relativeElevation","intersect","getGLMaterial","createBufferWriter","material","updateParameters","_material","updateTexture","textureId","_technique","_techniqueRep","releaseAndAcquire","_output","beginSlot","_updateOccludeeState","hasOccludees","setParameterValues","ensureParameters","bind","bindTextures","bindTextureScale","initTextureTransparent","createSquareGeometry","H","getLogger","G","drapeSourceType","updatePolicy","fullExtentInLocalViewSpatialReference","_images","Array","_extents","_overlayExtents","updateWhenStationary","addResolvingPromise","L","_set","_suspendedChangeHandler","resourceController","scheduler","registerIdleStateCallbacks","_isScaleRangeActive","notifyChange","_isScaleRangeLayer","viewingMode","_updateImageExtent","destroy","clear","setDrapingExtent","index","extent","renderLocalOrigin","pixelRatio","_clippedExtent","Math","round","imageMaxWidth","imageMaxHeight","floor","_imageSizeDiffers","imageSize","suspended","_fetch","error","length","_clearImage","minScale","maxScale","scale","isUpdating","some","loadingPromise","HTMLImageElement","findExtentInfoAt","contains","_createStageObjects","A","TESTS_DISABLE_UPDATE_THRESHOLDS","_","abs","texture","renderGeometry","loadingAbortController","renderExtent","abort","_waitFetchReady","requestAsImageElement","timestamp","refreshTimestamp","fetchImage","warnOnce","processResult","R","overlayManager","renderer","removeGeometries","_stage","remove","D","preMultiplyAlpha","wrap","min","max","Float64Array","Float32Array","Uint32Array","M","size","exclusive","I","id","C","origin","addGeometries","ready","refresh","readOnly","V"],"mappings":"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","file":"static/js/63.5381530e.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{isSome as t}from\"../../core/maybe.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import p from\"../../geometry/Point.js\";import{combinedViewLayerTimeExtentProperty as i}from\"../../layers/support/commonProperties.js\";import a from\"../../rest/support/Query.js\";import{getFetchPopupTemplate as n}from\"./support/popupUtils.js\";const u=u=>{let m=class extends u{constructor(){super(...arguments),this.view=null}async fetchPopupFeatures(e,o){const{layer:s}=this;if(!e)throw new r(\"imagerylayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s});const{popupEnabled:i}=s,u=n(s,o);if(!i||!t(u))throw new r(\"imagerylayerview:fetchPopupFeatures\",\"Missing required popupTemplate or popupEnabled\",{popupEnabled:i,popupTemplate:u});const m=await u.getRequiredFields(),c=new a;c.timeExtent=this.timeExtent,c.geometry=e,c.outFields=m,c.outSpatialReference=e.spatialReference;const l=this.view.resolution,y=\"2d\"===this.view.type?new p(l,l,this.view.spatialReference):new p(.5*l,.5*l,this.view.spatialReference),{returnTopmostRaster:h,showNoDataRecords:w}=u.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},d={returnDomainValues:!0,returnTopmostRaster:h,pixelSize:y,showNoDataRecords:w,signal:t(o)?o.signal:null};return s.queryVisibleRasters(c,d).then((e=>e))}canResume(){var e;return!!super.canResume()&&(null==(e=this.timeExtent)||!e.isEmpty)}};return e([o()],m.prototype,\"layer\",void 0),e([o()],m.prototype,\"suspended\",void 0),e([o(i)],m.prototype,\"timeExtent\",void 0),e([o()],m.prototype,\"view\",void 0),m=e([s(\"esri.views.layers.ImageryLayerView\")],m),m};export default u;export{u as ImageryLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{debounce as t}from\"../../../core/promiseUtils.js\";import{whenOnce as a}from\"../../../core/watchUtils.js\";import\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./DynamicLayerView3D.js\";import{ImageryLayerView as s}from\"../../layers/ImageryLayerView.js\";let o=class extends(s(r)){constructor(){super(...arguments),this.type=\"imagery-3d\",this.redrawDebounced=t((async e=>{this.redraw(((e,t)=>this._redrawImage(e,t)),e)}),2e3)}initialize(){this.handles.add([a(this.view.basemapTerrain,\"ready\",(()=>this.initializeMaximumDataResolution())),this.layer.on(\"redraw\",(()=>this.redrawDebounced()))]),this.updatingHandles.add(this.layer,\"exportImageServiceParameters.version\",(()=>{this.updatingHandles.addPromise(this.refreshDebounced())})),this.updatingHandles.add(this,\"timeExtent\",(()=>this.updatingHandles.addPromise(this.refreshDebounced())))}initializeMaximumDataResolution(){const e=this.view.basemapTerrain.spatialReference,t=this.layer.fullExtent;t&&e.equals(t.spatialReference)&&(this.maximumDataResolution={x:this.layer.pixelSizeX,y:this.layer.pixelSizeY})}getFetchOptions(){return{timeExtent:this.timeExtent}}async processResult(e,t,a){t.imageElement?e.image=t.imageElement:(e.image=document.createElement(\"canvas\"),e.pixelData=t.pixelData,await this._redrawImage(e,a))}async _redrawImage(e,t){if(!(e.image instanceof HTMLCanvasElement&&e.pixelData))return Promise.reject();const a=e.image,i=a.getContext(\"2d\"),r=await this.layer.applyRenderer(e.pixelData,{signal:t}),s=this.layer.applyFilter(r),o=s.pixelBlock;a.width=o.width,a.height=o.height;const n=i.createImageData(o.width,o.height);n.data.set(s.pixelBlock.getAsRGBA()),i.putImageData(n,0,0)}};o=e([i(\"esri.views.3d.layers.ImageryLayerView3D\")],o);var n=o;export default n;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as l}from\"../../../layers/support/fieldUtils.js\";async function t(t,d=t.popupTemplate){if(!e(d))return[];const i=await d.getRequiredFields(t.fieldsIndex),{lastEditInfoEnabled:n}=d,{objectIdField:s,typeIdField:a,globalIdField:o,relationships:u}=t;if(i.includes(\"*\"))return[\"*\"];const f=n?await p(t):[],r=l(t.fieldsIndex,[...i,...f]);return a&&r.push(a),r&&s&&t.fieldsIndex.has(s)&&-1===r.indexOf(s)&&r.push(s),r&&o&&t.fieldsIndex.has(o)&&-1===r.indexOf(o)&&r.push(o),u&&u.forEach((e=>{const{keyField:p}=e;r&&p&&t.fieldsIndex.has(p)&&-1===r.indexOf(p)&&r.push(p)})),r}function d(p,l){return p.popupTemplate?p.popupTemplate:e(l)&&l.defaultPopupTemplateEnabled&&e(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}export{d as getFetchPopupTemplate,t as getRequiredFields};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{canProject as e,project as r}from\"../../../../geometry/support/webMercatorUtils.js\";import{projectGeometry as o}from\"../../../../portal/support/geometryServiceUtils.js\";function t(t){const l=t.view.spatialReference,s=t.layer.fullExtent,i=s&&s.spatialReference;return i?i.equals(l)?Promise.resolve(s.clone()):e(i,l)?Promise.resolve(r(s,l)):t.view.state.isLocal?o(s,l,t.layer.portalItem).then((e=>!t.destroyed&&e?e:void 0)).catch((()=>null)):Promise.resolve(null):Promise.resolve(null)}export{t as toViewIfLocal};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{Slice as e}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ReadLinearDepth as a}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{multipassTerrainTest as o}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{defaultMaskAlphaCutoff as i}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{ColorConversion as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{glsl as t}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as l}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function s(s){const n=new l;return n.include(r,{linearDepth:!1}),n.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),n.attributes.add(\"position\",\"vec3\"),n.attributes.add(\"uv0\",\"vec2\"),n.varyings.add(\"vpos\",\"vec3\"),s.multipassTerrainEnabled&&n.varyings.add(\"depth\",\"float\"),n.vertex.uniforms.add(\"textureCoordinateScaleFactor\",\"vec2\"),n.vertex.code.add(t`\n    void main(void) {\n      vpos = position;\n      ${s.multipassTerrainEnabled?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  `),n.include(e,s),s.multipassTerrainEnabled&&(n.fragment.include(a),n.include(o,s)),n.fragment.uniforms.add(\"tex\",\"sampler2D\"),n.fragment.uniforms.add(\"opacity\",\"float\"),n.varyings.add(\"vTexCoord\",\"vec2\"),7===s.output?n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    `):(n.fragment.include(d),n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ${s.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n    }\n    `)),n}var n=Object.freeze({__proto__:null,build:s});export{n as I,s as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{bindSliceUniformsWithOrigin as t}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindMultipassTerrainTexture as r}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindProjectionMatrix as i,bindView as s}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as a}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../core/shaderTechnique/ShaderTechnique.js\";import{ShaderTechniqueConfiguration as n,parameter as l}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{Default3D as p}from\"../lib/DefaultVertexAttributeLocations.js\";import{OITBlending as c,OITDepthTest as u,OITDepthWrite as d,getOITPolygonOffset as h}from\"../lib/OrderIndependentTransparency.js\";import{Program as m}from\"../lib/Program.js\";import{stencilWriteMaskOn as b,stencilToolMaskBaseParams as f,stencilBaseAllZerosParams as g}from\"../lib/StencilUtils.js\";import{I as y}from\"../../../../chunks/ImageMaterial.glsl.js\";import{makePipelineState as T,cullingParams as P,defaultDepthWriteParams as v,defaultColorWriteParams as j,simpleBlendingParams as S}from\"../../../webgl/renderState.js\";class E extends o{initializeProgram(e){const t=E.shader.get(),r=this.configuration,i=t.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new m(e.rctx,i,p)}bindPass(e,t){i(this.program,t.camera.projectionMatrix),this.program.setUniform1f(\"opacity\",e.opacity),t.multipassTerrainEnabled&&(this.program.setUniform2fv(\"cameraNearFar\",t.camera.nearFar),this.program.setUniform2fv(\"inverseViewport\",t.inverseViewport),r(this.program,t))}bindDraw(e){s(this.program,e),t(this.program,this.configuration,e),this.program.rebindTextures()}setPipelineState(e,t){const r=this.configuration,i=3===e,s=2===e;return T({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?w:c(e),culling:P(r.cullFace),depthTest:{func:u(e)},depthWrite:i?r.writeDepth&&v:d(e),colorWrite:j,stencilWrite:r.sceneHasOcludees?b:null,stencilTest:r.sceneHasOcludees?t?f:g:null,polygonOffset:i||s?null:h(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e){return e?this._occludeePipelineState:this.pipeline}}E.shader=new a(y,(()=>import(\"./ImageMaterial.glsl.js\")));const w=S(1,771);class O extends n{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([l({count:8})],O.prototype,\"output\",void 0),e([l({count:3})],O.prototype,\"cullFace\",void 0),e([l()],O.prototype,\"slicePlaneEnabled\",void 0),e([l()],O.prototype,\"transparent\",void 0),e([l()],O.prototype,\"enableOffset\",void 0),e([l()],O.prototype,\"writeDepth\",void 0),e([l()],O.prototype,\"sceneHasOcludees\",void 0),e([l({count:4})],O.prototype,\"transparencyPassType\",void 0),e([l()],O.prototype,\"multipassTerrainEnabled\",void 0),e([l()],O.prototype,\"cullAboveGround\",void 0);export{E as ImageMaterialTechnique,O as ImageMaterialTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../lib/GLMaterialTexture.js\";import{Material as t,materialParametersDefaults as i}from\"../lib/Material.js\";import{OITPolygonOffsetLimit as s}from\"../lib/OrderIndependentTransparency.js\";import{DefaultBufferWriter as a,PositionUVLayout as r}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as n}from\"./internal/MaterialUtil.js\";import{ImageMaterialTechniqueConfiguration as u,ImageMaterialTechnique as h}from\"../shaders/ImageMaterialTechnique.js\";class c extends t{constructor(e){super(e,p),this.supportsEdges=!0,this.techniqueConfig=new u}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<s,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}intersect(e,t,i,s,a,r,u){n(e,t,s,a,r,void 0,u)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new l(e):void 0}createBufferWriter(){return new a(r)}}class l extends e{constructor(e){super({...e,...e.material.params}),this.updateParameters()}updateParameters(e){const t=this._material.params;this.updateTexture(t.textureId),this._technique=this._techniqueRep.releaseAndAcquire(h,this._material.getTechniqueConfig(this._output,e),this._technique)}beginSlot(e){if(4===this._output)return 3===e;return e===(this._technique.configuration.transparent?this._technique.configuration.writeDepth?5:8:3)}_updateOccludeeState(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&(this._material.setParameterValues({sceneHasOcludees:e.hasOccludees}),this.updateParameters(e))}ensureParameters(e){0!==this._output&&7!==this._output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e){this.bindTextures(this._technique.program),this.bindTextureScale(this._technique.program),this._technique.bindPass(this._material.params,e)}getPipelineState(e,t){return this._technique.getPipelineState(t)}}const p={transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,opacity:1,textureId:null,initTextureTransparent:!0,...i};export{c as ImageMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{width as t,height as e,intersects as n}from\"../../../../geometry/support/aaBoundingRect.js\";import{Geometry as i}from\"../../webgl-engine/lib/Geometry.js\";import r from\"../../webgl-engine/lib/GeometryUtil.js\";function o(n,i,r){const o=t(n)/e(n),a={width:r,height:r};return o>1.0001?a.height=r/o:o<.9999&&(a.width=r*o),a.width=Math.round(a.width/(t(n)/t(i))),a.height=Math.round(a.height/(e(n)/e(i))),a}function a(t){return r.createSquareGeometry([[t[0],t[1],-1],[t[2],t[1],-1],[t[2],t[3],-1],[t[0],t[3],-1]])}function h(t,e){if(!n(t,e))return a(e);const r=[t[1]-e[1],Math.min(t[3],e[3])-Math.max(t[1],e[1]),e[3]-t[3],123456],o=[t[0]-e[0],Math.min(t[2],e[2])-Math.max(t[0],e[0]),e[2]-t[2],123456],h=e[2]-e[0],u=e[3]-e[1],l=o[0]>0&&o[2]>0?3:2,m=r[0]>0&&r[2]>0?3:2,c=(m+1)*(l+1),g=new Float64Array(3*c),w=new Float32Array(2*c),d=new Uint32Array(6*(m*l-1));let f=0,p=0,y=0,x=0,M=0;for(let n=0;n<4;n++){const t=r[n];if(t<=0)continue;let i=0;for(let r=0;r<4;r++){const t=o[r];t<=0||(g[p++]=e[0]+i,g[p++]=e[1]+f,g[p++]=-1,w[y++]=i/h,w[y++]=f/u,r<3&&n<3&&(1!==r||1!==n)&&(d[M++]=x,d[M++]=x+1,d[M++]=x+l+1,d[M++]=x+1,d[M++]=x+l+2,d[M++]=x+l+1),x++,i+=t)}f+=t}const v=new Uint32Array(d.length);return new i([[\"position\",{size:3,data:g,exclusive:!0}],[\"normal\",{size:3,data:s,exclusive:!0}],[\"uv0\",{size:2,data:w,exclusive:!0}]],[[\"position\",d],[\"normal\",v],[\"uv0\",d]])}const s=[0,0,1];export{o as computeImageExportSize,a as createGeometryForExtent,h as createOuterImageGeometry};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{forEach as t,result as i}from\"../../../core/asyncUtils.js\";import r from\"../../../core/Logger.js\";import{isSome as a,isNone as s}from\"../../../core/maybe.js\";import{isAbortError as n,eachAlways as o,createAbortController as l,onAbort as h,isAborted as m,createAbortError as d,always as c,throwIfAborted as g}from\"../../../core/promiseUtils.js\";import{whenOnce as u}from\"../../../core/watchUtils.js\";import{property as p}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as y}from\"../../../core/accessorSupport/decorators/subclass.js\";import f from\"../../../geometry/Extent.js\";import{create as x,equals as w,width as _,height as v,set as R,intersection as b}from\"../../../geometry/support/aaBoundingRect.js\";import{LayerView3D as S}from\"./LayerView3D.js\";import{computeImageExportSize as E,createGeometryForExtent as j,createOuterImageGeometry as I}from\"./support/overlayImageUtils.js\";import{toViewIfLocal as L}from\"./support/projectExtentUtils.js\";import A from\"../support/debugFlags.js\";import{RenderGeometry as C}from\"../webgl-engine/lib/RenderGeometry.js\";import{Texture as D}from\"../webgl-engine/lib/Texture.js\";import{ImageMaterial as M}from\"../webgl-engine/materials/ImageMaterial.js\";import G from\"../../layers/LayerView.js\";import{RefreshableLayerView as T}from\"../../layers/RefreshableLayerView.js\";const H=r.getLogger(\"esri.views.3d.layers.DynamicLayerView3D\");let O=class extends(T(S(G))){constructor(){super(...arguments),this.drapeSourceType=0,this.updatePolicy=1,this.fullExtentInLocalViewSpatialReference=null,this.maximumDataResolution=null,this._images=new Array,this._extents=new Array,this._overlayExtents=new Array,this.updateWhenStationary=!0}initialize(){this.addResolvingPromise(L(this).then((e=>this._set(\"fullExtentInLocalViewSpatialReference\",e)))),this.updatingHandles.add(this,\"suspended\",(()=>this._suspendedChangeHandler())),this.handles.add(this.view.resourceController.scheduler.registerIdleStateCallbacks((()=>{this._isScaleRangeActive()&&this.notifyChange(\"suspended\")}),(()=>{}))),this._isScaleRangeLayer()&&this.updatingHandles.add(this.layer,\"scaleRangeId\",(()=>this.notifyChange(\"suspended\"))),\"local\"===this.view.viewingMode&&this.updatingHandles.add(this.view.basemapTerrain,\"extent\",(()=>this._overlayExtents.forEach(((e,t)=>this._updateImageExtent(t)))))}destroy(){this.clear()}setDrapingExtent(e,t){this._overlayExtents[e.index]={extent:x(e.extent),spatialReference:t,resolution:e.resolution,renderLocalOrigin:e.renderLocalOrigin,pixelRatio:e.pixelRatio},this._updateImageExtent(e.index)}_updateImageExtent(e){const t=this._overlayExtents[e],i=this._clippedExtent(t.extent,P),r=E(t.extent,i,t.resolution);let a=t.pixelRatio*this.view.pixelRatio;if(\"imageMaxWidth\"in this.layer||\"imageMaxHeight\"in this.layer){const e=this.layer.imageMaxWidth,t=this.layer.imageMaxHeight;if(r.width>e){const t=e/r.width;r.height=Math.floor(r.height*t),r.width=e,a*=t}if(r.height>t){const e=t/r.height;r.width=Math.floor(r.width*e),r.height=t,a*=e}}const s=this._extents[e];s&&w(s.extent,i)&&!this._imageSizeDiffers(i,s.imageSize,r)||(this._extents[e]={extent:x(i),spatialReference:t.spatialReference,imageSize:r,pixelRatio:a},this.suspended||this._fetch(e).catch((e=>{n(e)||H.error(e)})))}clear(){for(let e=0;e<this._images.length;e++)this._clearImage(e)}async doRefresh(e){if(this.suspended)return;const t=[];for(let i=0;i<this._extents.length;i++)this._extents[i]&&t.push(this._fetch(i,e));await o(t)}canResume(){if(!super.canResume())return!1;if(this._isScaleRangeLayer()){const{minScale:e,maxScale:t}=this.layer;if(e>0||t>0){const i=this.view.scale;if(i<t||e>0&&i>e)return!1}}return!0}isUpdating(){return this._images.some((e=>!!e.loadingPromise))}async processResult(e,t,i){(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement)&&(e.image=t)}findExtentInfoAt(e){for(const t of this._extents){const i=t.extent;if(new f(i[0],i[1],i[2],i[3],t.spatialReference).contains(e))return t}return null}getFetchOptions(){}async redraw(e,i){await t(this._images,(async(t,r)=>{t&&(await e(t,i),await this._createStageObjects(r,t.image))}))}_imageSizeDiffers(e,t,i){if(!this.maximumDataResolution||A.TESTS_DISABLE_UPDATE_THRESHOLDS)return!0;const r=_(e)/this.maximumDataResolution.x,a=v(e)/this.maximumDataResolution.y,s=r/t.width,n=a/t.height,o=r/i.width,l=a/i.height,h=Math.abs(s-o),m=Math.abs(n-l);return h>1.5||m>1.5}async _fetch(e,t){if(this.suspended)return;const i=this._extents[e],r=i.extent;this._images[e]||(this._images[e]={texture:null,material:null,renderGeometry:null,loadingPromise:null,loadingAbortController:null,image:null,pixelData:null,renderExtent:x(r)});const a=this._images[e];a.loadingAbortController&&(a.loadingAbortController.abort(),a.loadingAbortController=null);const s=new f(r[0],r[1],r[2],r[3],i.spatialReference);if(0===s.width||0===s.height)return void this._clearImage(e);const o=l();a.loadingAbortController=o,h(t,(()=>o.abort()));const g=o.signal,u=this._waitFetchReady(g).then((()=>{const t={requestAsImageElement:!0,pixelRatio:this._overlayExtents[e].pixelRatio,...this.getFetchOptions(),signal:g},{height:r,width:a}=i.imageSize;return t.timestamp=this.refreshTimestamp,this.layer.fetchImage(s,a,r,t)})).then((e=>{if(m(g))throw H.warnOnce(\"A call to fetchImage resolved even though the request was aborted. fetchImage should not resolve if options.signal.aborted is true.\"),d();return this.processResult(a,e)})).then((()=>R(a.renderExtent,r)));a.loadingPromise=u,c(u,(()=>{u===a.loadingPromise&&(a.loadingPromise=null,a.loadingAbortController=null)}));const p=u.then((async()=>{await this._createStageObjects(e,a.image),this.notifyChange(\"updating\")})).catch((e=>{throw e&&!n(e)&&H.error(e),this.notifyChange(\"updating\"),e}));this.notifyChange(\"updating\"),await p}_clearImage(e){const t=this._images[e];if(t){a(t.renderGeometry)&&(this.view.basemapTerrain.overlayManager.renderer.removeGeometries([t.renderGeometry],this,2),t.renderGeometry=null);const e=this.view._stage;e.remove(t.texture),t.texture=null,e.remove(t.material),t.material=null,t.loadingAbortController&&(t.loadingAbortController.abort(),t.loadingAbortController=null),t.loadingPromise=null,t.image=null,t.pixelData=null}}async _createStageObjects(e,t){const r=this.view._stage,n=this._images[e],o=this.view.basemapTerrain.overlayManager.renderer,l=()=>{r.remove(n.texture),n.texture=null,a(n.renderGeometry)&&(o.removeGeometries([n.renderGeometry],this,2),n.renderGeometry=null)};if(t){const a=new D(t,{width:t.width,height:t.height,preMultiplyAlpha:!0,wrap:{s:33071,t:33071}});let h;if(await i(this._images[0===e?1:0].loadingPromise),0===e)h=j(n.renderExtent);else{const e=this._images[0].renderExtent;if(!e)return void l();h=I(e,n.renderExtent)}l(),r.add(a),n.texture=a,s(n.material)?(n.material=new M({transparent:!0,textureId:a.id}),r.add(n.material)):n.material.setParameterValues({textureId:a.id}),n.renderGeometry=new C(h,n.material),n.renderGeometry.origin=this._overlayExtents[e].renderLocalOrigin,o.addGeometries([n.renderGeometry],this,2)}else l(),r.remove(n.material),n.material=null}_isScaleRangeLayer(){return\"minScale\"in this.layer&&\"maxScale\"in this.layer}_isScaleRangeActive(){return!!this._isScaleRangeLayer()&&(this.layer.minScale>0||this.layer.maxScale>0)}_clippedExtent(e,t){if(\"local\"!==this.view.viewingMode)return R(t,e);const i=this.view.basemapTerrain,r=i.extent;return i.ready&&r?b(e,r,t):R(t,e)}_suspendedChangeHandler(){this.suspended?this.clear():this.refresh()}async _waitFetchReady(e){await u(this.view,\"stationary\",e),g(e)}};e([p()],O.prototype,\"layer\",void 0),e([p()],O.prototype,\"suspended\",void 0),e([p({readOnly:!0})],O.prototype,\"fullExtentInLocalViewSpatialReference\",void 0),e([p()],O.prototype,\"updating\",void 0),O=e([y(\"esri.views.3d.layers.DynamicLayerView3D\")],O);const P=x();var V=O;export default V;\n"],"sourceRoot":""}