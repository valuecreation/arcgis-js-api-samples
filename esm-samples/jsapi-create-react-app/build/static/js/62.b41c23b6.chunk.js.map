{"version":3,"sources":["../node_modules/@arcgis/core/views/layers/WMSLayerView.js","../node_modules/@arcgis/core/views/3d/layers/WMSLayerView3D.js","../node_modules/@arcgis/core/views/3d/layers/support/projectExtentUtils.js","../node_modules/@arcgis/core/chunks/ImageMaterial.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ImageMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/ImageMaterial.js","../node_modules/@arcgis/core/views/3d/layers/support/overlayImageUtils.js","../node_modules/@arcgis/core/views/3d/layers/DynamicLayerView3D.js","../node_modules/@arcgis/core/layers/support/ExportWMSImageParameters.js"],"names":["a","i","initialize","this","exportImageParameters","p","layer","destroy","e","commitProperty","_get","fetchPopupFeatures","t","Promise","reject","r","popupEnabled","o","s","createFetchPopupFeaturesQuery","resolve","extent","width","height","x","m","y","n","u","fetchFeatureInfo","prototype","readOnly","constructor","super","arguments","type","supportsSpatialReference","view","spatialReference","addResolvingPromise","updatingHandles","add","addPromise","refreshDebounced","findExtentInfoAt","imageSize","Math","round","xmin","ymax","getFetchOptions","timeExtent","l","fullExtent","equals","clone","state","isLocal","portalItem","then","destroyed","catch","include","linearDepth","vertex","uniforms","attributes","varyings","multipassTerrainEnabled","code","fragment","output","float","d","OITEnabled","Object","freeze","__proto__","build","E","initializeProgram","shader","get","configuration","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","transparencyPassType","cullAboveGround","rctx","bindPass","program","camera","projectionMatrix","setUniform1f","opacity","setUniform2fv","nearFar","inverseViewport","bindDraw","rebindTextures","setPipelineState","T","blending","transparent","w","c","culling","P","cullFace","depthTest","func","depthWrite","writeDepth","v","colorWrite","j","stencilWrite","sceneHasOcludees","b","stencilTest","f","g","polygonOffset","h","enableOffset","initializePipeline","_occludeePipelineState","getPipelineState","pipeline","S","O","count","supportsEdges","techniqueConfig","getTechniqueConfig","params","relativeElevation","intersect","getGLMaterial","createBufferWriter","material","updateParameters","_material","updateTexture","textureId","_technique","_techniqueRep","releaseAndAcquire","_output","beginSlot","_updateOccludeeState","hasOccludees","setParameterValues","ensureParameters","bind","bindTextures","bindTextureScale","initTextureTransparent","createSquareGeometry","H","getLogger","G","drapeSourceType","updatePolicy","fullExtentInLocalViewSpatialReference","maximumDataResolution","_images","Array","_extents","_overlayExtents","updateWhenStationary","L","_set","_suspendedChangeHandler","handles","resourceController","scheduler","registerIdleStateCallbacks","_isScaleRangeActive","notifyChange","_isScaleRangeLayer","viewingMode","basemapTerrain","forEach","_updateImageExtent","clear","setDrapingExtent","index","resolution","renderLocalOrigin","pixelRatio","_clippedExtent","imageMaxWidth","imageMaxHeight","floor","_imageSizeDiffers","suspended","_fetch","error","length","_clearImage","push","canResume","minScale","maxScale","scale","isUpdating","some","loadingPromise","HTMLImageElement","HTMLCanvasElement","image","contains","async","_createStageObjects","A","TESTS_DISABLE_UPDATE_THRESHOLDS","_","abs","texture","renderGeometry","loadingAbortController","pixelData","renderExtent","abort","signal","_waitFetchReady","requestAsImageElement","timestamp","refreshTimestamp","fetchImage","warnOnce","processResult","R","overlayManager","renderer","removeGeometries","_stage","remove","D","preMultiplyAlpha","wrap","min","max","Float64Array","Float32Array","Uint32Array","M","size","data","exclusive","I","id","C","origin","addGeometries","ready","refresh","V","visible","sublayers","on","propertyName","visibleSublayers","filter","name","map","join","unshift","toJSON","layers","imageFormat","imageTransparency","version","format","request","service","styles","Number"],"mappings":"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","file":"static/js/62.b41c23b6.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as s}from\"../../layers/support/commonProperties.js\";import{ExportWMSImageParameters as p}from\"../../layers/support/ExportWMSImageParameters.js\";const a=a=>{let i=class extends a{initialize(){this.exportImageParameters=new p({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get exportImageVersion(){var e;return null==(e=this.exportImageParameters)||e.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),(this._get(\"exportImageVersion\")||0)+1}fetchPopupFeatures(e){const{layer:t}=this;if(!e)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:t}));const{popupEnabled:o}=t;if(!o)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"popupEnabled should be true\",{popupEnabled:o}));const s=this.createFetchPopupFeaturesQuery(e);if(!s)return Promise.resolve([]);const{extent:p,width:a,height:i,x:m,y:n}=s;if(!(p&&a&&i))throw new r(\"wmslayerview:fetchPopupFeatures\",\"WMSLayer does not support fetching features.\",{extent:p,width:a,height:i});const u=t.fetchFeatureInfo(p,a,i,m,n);return Promise.resolve(u?[u]:[])}};return e([t()],i.prototype,\"exportImageParameters\",void 0),e([t({readOnly:!0})],i.prototype,\"exportImageVersion\",null),e([t()],i.prototype,\"layer\",void 0),e([t(s)],i.prototype,\"timeExtent\",void 0),i=e([o(\"esri.layers.mixins.WMSLayerView\")],i),i};export default a;export{a as WMSLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";import i from\"../../../geometry/Extent.js\";import o from\"./DynamicLayerView3D.js\";import{WMSLayerView as a}from\"../../layers/WMSLayerView.js\";let p=class extends(a(o)){constructor(){super(...arguments),this.type=\"wms-3d\"}initialize(){this.layer.supportsSpatialReference(this.view.spatialReference)||this.addResolvingPromise(Promise.reject(new t(\"layerview:spatial-reference-incompatible\",\"The spatial references supported by this WMS layer are incompatible with the spatial reference of the view\"))),this.updatingHandles.add(this.exportImageParameters,\"version\",(()=>{this.updatingHandles.addPromise(this.refreshDebounced())}))}createFetchPopupFeaturesQuery(e){const t=this.findExtentInfoAt(e),r=t.extent,s=new i(r[0],r[1],r[2],r[3],t.spatialReference),o=t.imageSize,a=o.width,p=o.height,n=s.width/a;return{extent:s,width:a,height:p,x:Math.round((e.x-s.xmin)/n),y:Math.round((s.ymax-e.y)/n)}}getFetchOptions(){return{timeExtent:this.timeExtent}}};e([r()],p.prototype,\"suspended\",void 0),p=e([s(\"esri.views.3d.layers.WMSLayerView3D\")],p);var n=p;export default n;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{canProject as e,project as r}from\"../../../../geometry/support/webMercatorUtils.js\";import{projectGeometry as o}from\"../../../../portal/support/geometryServiceUtils.js\";function t(t){const l=t.view.spatialReference,s=t.layer.fullExtent,i=s&&s.spatialReference;return i?i.equals(l)?Promise.resolve(s.clone()):e(i,l)?Promise.resolve(r(s,l)):t.view.state.isLocal?o(s,l,t.layer.portalItem).then((e=>!t.destroyed&&e?e:void 0)).catch((()=>null)):Promise.resolve(null):Promise.resolve(null)}export{t as toViewIfLocal};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{Slice as e}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ReadLinearDepth as a}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{multipassTerrainTest as o}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{defaultMaskAlphaCutoff as i}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{ColorConversion as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{glsl as t}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as l}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function s(s){const n=new l;return n.include(r,{linearDepth:!1}),n.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),n.attributes.add(\"position\",\"vec3\"),n.attributes.add(\"uv0\",\"vec2\"),n.varyings.add(\"vpos\",\"vec3\"),s.multipassTerrainEnabled&&n.varyings.add(\"depth\",\"float\"),n.vertex.uniforms.add(\"textureCoordinateScaleFactor\",\"vec2\"),n.vertex.code.add(t`\n    void main(void) {\n      vpos = position;\n      ${s.multipassTerrainEnabled?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  `),n.include(e,s),s.multipassTerrainEnabled&&(n.fragment.include(a),n.include(o,s)),n.fragment.uniforms.add(\"tex\",\"sampler2D\"),n.fragment.uniforms.add(\"opacity\",\"float\"),n.varyings.add(\"vTexCoord\",\"vec2\"),7===s.output?n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    `):(n.fragment.include(d),n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ${s.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n    }\n    `)),n}var n=Object.freeze({__proto__:null,build:s});export{n as I,s as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{bindSliceUniformsWithOrigin as t}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindMultipassTerrainTexture as r}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindProjectionMatrix as i,bindView as s}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as a}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../core/shaderTechnique/ShaderTechnique.js\";import{ShaderTechniqueConfiguration as n,parameter as l}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{Default3D as p}from\"../lib/DefaultVertexAttributeLocations.js\";import{OITBlending as c,OITDepthTest as u,OITDepthWrite as d,getOITPolygonOffset as h}from\"../lib/OrderIndependentTransparency.js\";import{Program as m}from\"../lib/Program.js\";import{stencilWriteMaskOn as b,stencilToolMaskBaseParams as f,stencilBaseAllZerosParams as g}from\"../lib/StencilUtils.js\";import{I as y}from\"../../../../chunks/ImageMaterial.glsl.js\";import{makePipelineState as T,cullingParams as P,defaultDepthWriteParams as v,defaultColorWriteParams as j,simpleBlendingParams as S}from\"../../../webgl/renderState.js\";class E extends o{initializeProgram(e){const t=E.shader.get(),r=this.configuration,i=t.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new m(e.rctx,i,p)}bindPass(e,t){i(this.program,t.camera.projectionMatrix),this.program.setUniform1f(\"opacity\",e.opacity),t.multipassTerrainEnabled&&(this.program.setUniform2fv(\"cameraNearFar\",t.camera.nearFar),this.program.setUniform2fv(\"inverseViewport\",t.inverseViewport),r(this.program,t))}bindDraw(e){s(this.program,e),t(this.program,this.configuration,e),this.program.rebindTextures()}setPipelineState(e,t){const r=this.configuration,i=3===e,s=2===e;return T({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?w:c(e),culling:P(r.cullFace),depthTest:{func:u(e)},depthWrite:i?r.writeDepth&&v:d(e),colorWrite:j,stencilWrite:r.sceneHasOcludees?b:null,stencilTest:r.sceneHasOcludees?t?f:g:null,polygonOffset:i||s?null:h(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e){return e?this._occludeePipelineState:this.pipeline}}E.shader=new a(y,(()=>import(\"./ImageMaterial.glsl.js\")));const w=S(1,771);class O extends n{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([l({count:8})],O.prototype,\"output\",void 0),e([l({count:3})],O.prototype,\"cullFace\",void 0),e([l()],O.prototype,\"slicePlaneEnabled\",void 0),e([l()],O.prototype,\"transparent\",void 0),e([l()],O.prototype,\"enableOffset\",void 0),e([l()],O.prototype,\"writeDepth\",void 0),e([l()],O.prototype,\"sceneHasOcludees\",void 0),e([l({count:4})],O.prototype,\"transparencyPassType\",void 0),e([l()],O.prototype,\"multipassTerrainEnabled\",void 0),e([l()],O.prototype,\"cullAboveGround\",void 0);export{E as ImageMaterialTechnique,O as ImageMaterialTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../lib/GLMaterialTexture.js\";import{Material as t,materialParametersDefaults as i}from\"../lib/Material.js\";import{OITPolygonOffsetLimit as s}from\"../lib/OrderIndependentTransparency.js\";import{DefaultBufferWriter as a,PositionUVLayout as r}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as n}from\"./internal/MaterialUtil.js\";import{ImageMaterialTechniqueConfiguration as u,ImageMaterialTechnique as h}from\"../shaders/ImageMaterialTechnique.js\";class c extends t{constructor(e){super(e,p),this.supportsEdges=!0,this.techniqueConfig=new u}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<s,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig}intersect(e,t,i,s,a,r,u){n(e,t,s,a,r,void 0,u)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new l(e):void 0}createBufferWriter(){return new a(r)}}class l extends e{constructor(e){super({...e,...e.material.params}),this.updateParameters()}updateParameters(e){const t=this._material.params;this.updateTexture(t.textureId),this._technique=this._techniqueRep.releaseAndAcquire(h,this._material.getTechniqueConfig(this._output,e),this._technique)}beginSlot(e){if(4===this._output)return 3===e;return e===(this._technique.configuration.transparent?this._technique.configuration.writeDepth?5:8:3)}_updateOccludeeState(e){e.hasOccludees!==this._material.params.sceneHasOcludees&&(this._material.setParameterValues({sceneHasOcludees:e.hasOccludees}),this.updateParameters(e))}ensureParameters(e){0!==this._output&&7!==this._output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e){this.bindTextures(this._technique.program),this.bindTextureScale(this._technique.program),this._technique.bindPass(this._material.params,e)}getPipelineState(e,t){return this._technique.getPipelineState(t)}}const p={transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,opacity:1,textureId:null,initTextureTransparent:!0,...i};export{c as ImageMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{width as t,height as e,intersects as n}from\"../../../../geometry/support/aaBoundingRect.js\";import{Geometry as i}from\"../../webgl-engine/lib/Geometry.js\";import r from\"../../webgl-engine/lib/GeometryUtil.js\";function o(n,i,r){const o=t(n)/e(n),a={width:r,height:r};return o>1.0001?a.height=r/o:o<.9999&&(a.width=r*o),a.width=Math.round(a.width/(t(n)/t(i))),a.height=Math.round(a.height/(e(n)/e(i))),a}function a(t){return r.createSquareGeometry([[t[0],t[1],-1],[t[2],t[1],-1],[t[2],t[3],-1],[t[0],t[3],-1]])}function h(t,e){if(!n(t,e))return a(e);const r=[t[1]-e[1],Math.min(t[3],e[3])-Math.max(t[1],e[1]),e[3]-t[3],123456],o=[t[0]-e[0],Math.min(t[2],e[2])-Math.max(t[0],e[0]),e[2]-t[2],123456],h=e[2]-e[0],u=e[3]-e[1],l=o[0]>0&&o[2]>0?3:2,m=r[0]>0&&r[2]>0?3:2,c=(m+1)*(l+1),g=new Float64Array(3*c),w=new Float32Array(2*c),d=new Uint32Array(6*(m*l-1));let f=0,p=0,y=0,x=0,M=0;for(let n=0;n<4;n++){const t=r[n];if(t<=0)continue;let i=0;for(let r=0;r<4;r++){const t=o[r];t<=0||(g[p++]=e[0]+i,g[p++]=e[1]+f,g[p++]=-1,w[y++]=i/h,w[y++]=f/u,r<3&&n<3&&(1!==r||1!==n)&&(d[M++]=x,d[M++]=x+1,d[M++]=x+l+1,d[M++]=x+1,d[M++]=x+l+2,d[M++]=x+l+1),x++,i+=t)}f+=t}const v=new Uint32Array(d.length);return new i([[\"position\",{size:3,data:g,exclusive:!0}],[\"normal\",{size:3,data:s,exclusive:!0}],[\"uv0\",{size:2,data:w,exclusive:!0}]],[[\"position\",d],[\"normal\",v],[\"uv0\",d]])}const s=[0,0,1];export{o as computeImageExportSize,a as createGeometryForExtent,h as createOuterImageGeometry};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{forEach as t,result as i}from\"../../../core/asyncUtils.js\";import r from\"../../../core/Logger.js\";import{isSome as a,isNone as s}from\"../../../core/maybe.js\";import{isAbortError as n,eachAlways as o,createAbortController as l,onAbort as h,isAborted as m,createAbortError as d,always as c,throwIfAborted as g}from\"../../../core/promiseUtils.js\";import{whenOnce as u}from\"../../../core/watchUtils.js\";import{property as p}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as y}from\"../../../core/accessorSupport/decorators/subclass.js\";import f from\"../../../geometry/Extent.js\";import{create as x,equals as w,width as _,height as v,set as R,intersection as b}from\"../../../geometry/support/aaBoundingRect.js\";import{LayerView3D as S}from\"./LayerView3D.js\";import{computeImageExportSize as E,createGeometryForExtent as j,createOuterImageGeometry as I}from\"./support/overlayImageUtils.js\";import{toViewIfLocal as L}from\"./support/projectExtentUtils.js\";import A from\"../support/debugFlags.js\";import{RenderGeometry as C}from\"../webgl-engine/lib/RenderGeometry.js\";import{Texture as D}from\"../webgl-engine/lib/Texture.js\";import{ImageMaterial as M}from\"../webgl-engine/materials/ImageMaterial.js\";import G from\"../../layers/LayerView.js\";import{RefreshableLayerView as T}from\"../../layers/RefreshableLayerView.js\";const H=r.getLogger(\"esri.views.3d.layers.DynamicLayerView3D\");let O=class extends(T(S(G))){constructor(){super(...arguments),this.drapeSourceType=0,this.updatePolicy=1,this.fullExtentInLocalViewSpatialReference=null,this.maximumDataResolution=null,this._images=new Array,this._extents=new Array,this._overlayExtents=new Array,this.updateWhenStationary=!0}initialize(){this.addResolvingPromise(L(this).then((e=>this._set(\"fullExtentInLocalViewSpatialReference\",e)))),this.updatingHandles.add(this,\"suspended\",(()=>this._suspendedChangeHandler())),this.handles.add(this.view.resourceController.scheduler.registerIdleStateCallbacks((()=>{this._isScaleRangeActive()&&this.notifyChange(\"suspended\")}),(()=>{}))),this._isScaleRangeLayer()&&this.updatingHandles.add(this.layer,\"scaleRangeId\",(()=>this.notifyChange(\"suspended\"))),\"local\"===this.view.viewingMode&&this.updatingHandles.add(this.view.basemapTerrain,\"extent\",(()=>this._overlayExtents.forEach(((e,t)=>this._updateImageExtent(t)))))}destroy(){this.clear()}setDrapingExtent(e,t){this._overlayExtents[e.index]={extent:x(e.extent),spatialReference:t,resolution:e.resolution,renderLocalOrigin:e.renderLocalOrigin,pixelRatio:e.pixelRatio},this._updateImageExtent(e.index)}_updateImageExtent(e){const t=this._overlayExtents[e],i=this._clippedExtent(t.extent,P),r=E(t.extent,i,t.resolution);let a=t.pixelRatio*this.view.pixelRatio;if(\"imageMaxWidth\"in this.layer||\"imageMaxHeight\"in this.layer){const e=this.layer.imageMaxWidth,t=this.layer.imageMaxHeight;if(r.width>e){const t=e/r.width;r.height=Math.floor(r.height*t),r.width=e,a*=t}if(r.height>t){const e=t/r.height;r.width=Math.floor(r.width*e),r.height=t,a*=e}}const s=this._extents[e];s&&w(s.extent,i)&&!this._imageSizeDiffers(i,s.imageSize,r)||(this._extents[e]={extent:x(i),spatialReference:t.spatialReference,imageSize:r,pixelRatio:a},this.suspended||this._fetch(e).catch((e=>{n(e)||H.error(e)})))}clear(){for(let e=0;e<this._images.length;e++)this._clearImage(e)}async doRefresh(e){if(this.suspended)return;const t=[];for(let i=0;i<this._extents.length;i++)this._extents[i]&&t.push(this._fetch(i,e));await o(t)}canResume(){if(!super.canResume())return!1;if(this._isScaleRangeLayer()){const{minScale:e,maxScale:t}=this.layer;if(e>0||t>0){const i=this.view.scale;if(i<t||e>0&&i>e)return!1}}return!0}isUpdating(){return this._images.some((e=>!!e.loadingPromise))}async processResult(e,t,i){(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement)&&(e.image=t)}findExtentInfoAt(e){for(const t of this._extents){const i=t.extent;if(new f(i[0],i[1],i[2],i[3],t.spatialReference).contains(e))return t}return null}getFetchOptions(){}async redraw(e,i){await t(this._images,(async(t,r)=>{t&&(await e(t,i),await this._createStageObjects(r,t.image))}))}_imageSizeDiffers(e,t,i){if(!this.maximumDataResolution||A.TESTS_DISABLE_UPDATE_THRESHOLDS)return!0;const r=_(e)/this.maximumDataResolution.x,a=v(e)/this.maximumDataResolution.y,s=r/t.width,n=a/t.height,o=r/i.width,l=a/i.height,h=Math.abs(s-o),m=Math.abs(n-l);return h>1.5||m>1.5}async _fetch(e,t){if(this.suspended)return;const i=this._extents[e],r=i.extent;this._images[e]||(this._images[e]={texture:null,material:null,renderGeometry:null,loadingPromise:null,loadingAbortController:null,image:null,pixelData:null,renderExtent:x(r)});const a=this._images[e];a.loadingAbortController&&(a.loadingAbortController.abort(),a.loadingAbortController=null);const s=new f(r[0],r[1],r[2],r[3],i.spatialReference);if(0===s.width||0===s.height)return void this._clearImage(e);const o=l();a.loadingAbortController=o,h(t,(()=>o.abort()));const g=o.signal,u=this._waitFetchReady(g).then((()=>{const t={requestAsImageElement:!0,pixelRatio:this._overlayExtents[e].pixelRatio,...this.getFetchOptions(),signal:g},{height:r,width:a}=i.imageSize;return t.timestamp=this.refreshTimestamp,this.layer.fetchImage(s,a,r,t)})).then((e=>{if(m(g))throw H.warnOnce(\"A call to fetchImage resolved even though the request was aborted. fetchImage should not resolve if options.signal.aborted is true.\"),d();return this.processResult(a,e)})).then((()=>R(a.renderExtent,r)));a.loadingPromise=u,c(u,(()=>{u===a.loadingPromise&&(a.loadingPromise=null,a.loadingAbortController=null)}));const p=u.then((async()=>{await this._createStageObjects(e,a.image),this.notifyChange(\"updating\")})).catch((e=>{throw e&&!n(e)&&H.error(e),this.notifyChange(\"updating\"),e}));this.notifyChange(\"updating\"),await p}_clearImage(e){const t=this._images[e];if(t){a(t.renderGeometry)&&(this.view.basemapTerrain.overlayManager.renderer.removeGeometries([t.renderGeometry],this,2),t.renderGeometry=null);const e=this.view._stage;e.remove(t.texture),t.texture=null,e.remove(t.material),t.material=null,t.loadingAbortController&&(t.loadingAbortController.abort(),t.loadingAbortController=null),t.loadingPromise=null,t.image=null,t.pixelData=null}}async _createStageObjects(e,t){const r=this.view._stage,n=this._images[e],o=this.view.basemapTerrain.overlayManager.renderer,l=()=>{r.remove(n.texture),n.texture=null,a(n.renderGeometry)&&(o.removeGeometries([n.renderGeometry],this,2),n.renderGeometry=null)};if(t){const a=new D(t,{width:t.width,height:t.height,preMultiplyAlpha:!0,wrap:{s:33071,t:33071}});let h;if(await i(this._images[0===e?1:0].loadingPromise),0===e)h=j(n.renderExtent);else{const e=this._images[0].renderExtent;if(!e)return void l();h=I(e,n.renderExtent)}l(),r.add(a),n.texture=a,s(n.material)?(n.material=new M({transparent:!0,textureId:a.id}),r.add(n.material)):n.material.setParameterValues({textureId:a.id}),n.renderGeometry=new C(h,n.material),n.renderGeometry.origin=this._overlayExtents[e].renderLocalOrigin,o.addGeometries([n.renderGeometry],this,2)}else l(),r.remove(n.material),n.material=null}_isScaleRangeLayer(){return\"minScale\"in this.layer&&\"maxScale\"in this.layer}_isScaleRangeActive(){return!!this._isScaleRangeLayer()&&(this.layer.minScale>0||this.layer.maxScale>0)}_clippedExtent(e,t){if(\"local\"!==this.view.viewingMode)return R(t,e);const i=this.view.basemapTerrain,r=i.extent;return i.ready&&r?b(e,r,t):R(t,e)}_suspendedChangeHandler(){this.suspended?this.clear():this.refresh()}async _waitFetchReady(e){await u(this.view,\"stationary\",e),g(e)}};e([p()],O.prototype,\"layer\",void 0),e([p()],O.prototype,\"suspended\",void 0),e([p({readOnly:!0})],O.prototype,\"fullExtentInLocalViewSpatialReference\",void 0),e([p()],O.prototype,\"updating\",void 0),O=e([y(\"esri.views.3d.layers.DynamicLayerView3D\")],O);const P=x();var V=O;export default V;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{HandleOwnerMixin as s}from\"../../core/HandleOwner.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";const a={visible:\"visibleSublayers\"};let l=class extends(s(r)){constructor(e){super(e),this.scale=0}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.handles.remove(\"layer\"),e&&this.handles.add([e.sublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"wms-sublayer-update\",(e=>this.notifyChange(a[e.propertyName])))],\"layer\"))}get layers(){const{visibleSublayers:e}=this;return e.filter((e=>e.name)).map((e=>e.name)).join(\",\")}get version(){this.commitProperty(\"layers\");const e=this.layer;return e&&e.commitProperty(\"imageTransparency\"),(this._get(\"version\")||0)+1}get visibleSublayers(){const{layer:e,scale:r}=this,s=null==e?void 0:e.sublayers,t=[],o=e=>{const{minScale:s,maxScale:a,sublayers:l,visible:i}=e;i&&(0===r||(0===s||r<=s)&&(0===a||r>=a))&&(l?l.forEach(o):t.unshift(e))};return null==s||s.forEach(o),t}toJSON(){const{layer:e,layers:r}=this,{imageFormat:s,imageTransparency:t,version:o}=e;return{format:s,request:\"GetMap\",service:\"WMS\",styles:\"\",transparent:t,version:o,layers:r}}};e([t()],l.prototype,\"layer\",null),e([t({readOnly:!0})],l.prototype,\"layers\",null),e([t({type:Number})],l.prototype,\"scale\",void 0),e([t({readOnly:!0})],l.prototype,\"version\",null),e([t({readOnly:!0})],l.prototype,\"visibleSublayers\",null),l=e([o(\"esri.layers.support.ExportWMSImageParameters\")],l);export{l as ExportWMSImageParameters};\n"],"sourceRoot":""}